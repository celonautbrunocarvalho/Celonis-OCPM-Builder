[
    {
        "change_date": 1770400811709.0,
        "changed_by": {
            "id": "cccccccc-cccc-cccc-cccc-cccccccccccc",
            "name": "Celonis",
            "type_": "APPLICATION"
        },
        "created_by": {
            "id": "cccccccc-cccc-cccc-cccc-cccccccccccc",
            "name": "Celonis",
            "type_": "APPLICATION"
        },
        "creation_date": 1770400811709.0,
        "data_connection_id": "b3c59e17-798d-49ea-b0b3-99d0bae2e011",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderScheduleLine",
        "draft": null,
        "factory_id": "5e00ac18-4f4a-43ad-a812-95d216536880_b3c59e17-798d-49ea-b0b3-99d0bae2e011",
        "factory_validation_status": "NOT_VALIDATED",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "''"
            }
        ],
        "namespace": "celonis",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLine",
                "namespace": "celonis"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "CDPOS",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT <%=sourceSystem%>  || 'SalesOrderScheduleLine_' || \"CDPOS\".\"TABKEY\"                      AS \"ObjectID\",\n\t<%=sourceSystem%>  || \"CDPOS\".\"TABKEY\" || \"CDPOS\".\"TABNAME\" || \"CDPOS\".\"FNAME\"\n       || \"CDPOS\".\"CHANGENR\" || \"CDPOS\".\"CHNGIND\"                                               AS \"ID\",\n       CAST(\"CDHDR\".\"UDATE\" AS DATE) + COALESCE(CAST(\"CDHDR\".\"UTIME\" AS TIME), TIME '23:59:59') AS \"Time\",\n       CASE\n           WHEN \"CDPOS\".\"CHNGIND\" = 'I' THEN 'CreationTime'\n           WHEN \"CDPOS\".\"CHNGIND\" = 'D' THEN 'DeletionTime'\n           END                                                                                  AS \"Attribute\",\n       NULL                                                                                     AS \"OldValue\",\n       NULL                                                                                     AS \"NewValue\",\n        'User_' || \"CDHDR\".\"MANDANT\" || \"CDHDR\".\"USERNAME\"                                      AS \"ChangedBy\",\n       \"CDHDR\".\"TCODE\"                                                                          AS \"OperationType\",\n       \"CDHDR\".\"CHANGENR\"                                                                       AS \"OperationID\",\n       CASE\n           WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n           ELSE 'Manual' END                                                                    AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                       AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\nWHERE \"CDPOS\".\"MANDANT\" IS NOT NULL\n  AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n  AND \"CDPOS\".\"FNAME\" = 'KEY'\n  AND \"CDHDR\".\"MANDANT\" IS NOT NULL\n"
                    },
                    {
                        "id": "VBEP (1)",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Sorted_Changes\" AS (SELECT \"CDPOS\".\"MANDANT\",\n                                     \"CDPOS\".\"TABNAME\",\n                                     \"CDPOS\".\"TABKEY\",\n                                     CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(\"CDHDR\".\"UTIME\" AS TIME) AS \"CHANGEDATE\",\n                                     LTRIM(\"CDPOS\".\"VALUE_OLD\")                                    AS \"VALUE_OLD\",\n                                     LTRIM(\"CDPOS\".\"VALUE_NEW\")                                    AS \"VALUE_NEW\",\n                                     ROW_NUMBER()\n                                     OVER (PARTITION BY \"CDPOS\".\"MANDANT\", \"CDPOS\".\"TABNAME\", \"CDPOS\".\"TABKEY\"\n                                         ORDER BY \"CDHDR\".\"UDATE\", \"CDHDR\".\"UTIME\")                AS \"rn\"\n                              FROM \"CDPOS\" AS \"CDPOS\"\n                                       LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                                                 ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                                                     AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                                                     AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                                                     AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                              WHERE \"CDPOS\".\"MANDANT\" IS NOT NULL\n                                AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n                                AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n                                AND \"CDPOS\".\"FNAME\" = 'BMENG'),\n     \"CTE_SalesOrderScheduleLine_LookUp\" AS (SELECT \"Current\".\"MANDANT\",\n                                                    \"Current\".\"TABNAME\",\n                                                    \"Current\".\"TABKEY\",\n                                                    \"Current\".\"CHANGEDATE\" AS \"StartDate\",\n                                                    CASE\n                                                        WHEN \"Next\".\"rn\" IS NULL\n                                                            THEN CAST('9999-01-01 09:09:09' AS TIMESTAMP)\n                                                        ELSE \"Next\".\"CHANGEDATE\"\n                                                        END                AS \"EndDate\",\n                                                    \"Current\".\"VALUE_NEW\"  AS \"Value\"\n                                             FROM \"CTE_Sorted_Changes\" AS \"Current\"\n                                                      LEFT JOIN \"CTE_Sorted_Changes\" AS \"Next\"\n                                                                ON \"Current\".\"MANDANT\" = \"Next\".\"MANDANT\"\n                                                                    AND \"Current\".\"TABNAME\" = \"Next\".\"TABNAME\"\n                                                                    AND \"Current\".\"TABKEY\" = \"Next\".\"TABKEY\"\n                                                                    AND \"Current\".\"rn\" + 1 = \"Next\".\"rn\"\n                                             UNION ALL\n                                             SELECT \"Current\".\"MANDANT\",\n                                                    \"Current\".\"TABNAME\",\n                                                    \"Current\".\"TABKEY\",\n                                                    CAST('1970-01-01 00:00:00' AS TIMESTAMP) AS \"StartDate\",\n                                                    \"Current\".\"CHANGEDATE\"                   AS \"EndDate\",\n                                                    \"Current\".\"VALUE_OLD\"                    AS \"Value\"\n                                             FROM \"CTE_Sorted_Changes\" AS \"Current\"\n                                             WHERE \"Current\".\"rn\" = 1)\nSELECT <%=sourceSystem%>  || 'SalesOrderScheduleLine_' || \"CDPOS\".\"TABKEY\" AS \"ObjectID\",\n\t<%=sourceSystem%>  || \"CDPOS\".\"TABKEY\" || \"CDPOS\".\"TABNAME\" || \"CDPOS\".\"FNAME\"\n       || \"CDPOS\".\"CHANGENR\" || \"CDPOS\".\"CHNGIND\"                          AS \"ID\",\n       CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(\"CDHDR\".\"UTIME\" AS TIME)       AS \"Time\",\n       CASE\n           WHEN \"CDPOS\".\"FNAME\" = 'BMENG' AND CAST(\"SalesOrderScheduleLine_LookUp\".\"Value\" AS FLOAT) > 0\n               THEN 'ConfirmedQuantity'\n           WHEN \"CDPOS\".\"FNAME\" = 'EDATU' AND CAST(\"SalesOrderScheduleLine_LookUp\".\"Value\" AS FLOAT) > 0\n               THEN 'ConfirmedDeliveryDate'\n           WHEN \"CDPOS\".\"FNAME\" = 'MBDAT' THEN 'MaterialAvailabilityDate'\n           END                                                             AS \"Attribute\",\n       LTRIM(\"CDPOS\".\"VALUE_OLD\")                                          AS \"OldValue\",\n       LTRIM(\"CDPOS\".\"VALUE_NEW\")                                          AS \"NewValue\",\n       'User_' || \"CDHDR\".\"MANDANT\" || \"CDHDR\".\"USERNAME\"                  AS \"ChangedBy\",\n       \"CDHDR\".\"TCODE\"                                                     AS \"OperationType\",\n       \"CDHDR\".\"CHANGENR\"                                                  AS \"OperationID\",\n       CASE\n           WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n           ELSE 'Manual' END                                               AS \"ExecutionType\"\nFROM \"VBEP\" AS \"VBEP\"\n         LEFT JOIN \"CDPOS\" AS \"CDPOS\"\n                   ON \"VBEP\".\"MANDT\" = \"CDPOS\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n                       AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n                       AND \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\" = \"CDPOS\".\"TABKEY\"\n                       AND \"CDPOS\".\"FNAME\" IN ('BMENG', 'EDATU', 'MBDAT')\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n         LEFT JOIN \"CTE_SalesOrderScheduleLine_LookUp\" AS \"SalesOrderScheduleLine_LookUp\"\n                   ON \"VBEP\".\"MANDT\" = \"SalesOrderScheduleLine_LookUp\".\"MANDANT\"\n                       AND \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\"\n                           = \"SalesOrderScheduleLine_LookUp\".\"TABKEY\"\n                       AND CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(\"CDHDR\".\"UTIME\" AS TIME)\n                           > \"SalesOrderScheduleLine_LookUp\".\"StartDate\"\n                       AND CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(\"CDHDR\".\"UTIME\" AS TIME)\n                           <= \"SalesOrderScheduleLine_LookUp\".\"EndDate\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                       AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\nWHERE \"VBEP\".\"MANDT\" IS NOT NULL\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL\n"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "SalesOrderItem"
                ],
                "namespace": "celonis",
                "property_names": [
                    "ConfirmedDeliveryDate",
                    "ConfirmedQuantity",
                    "CreationExecutionType",
                    "CreationTime",
                    "DatabaseSalesOrderItemNumber",
                    "DatabaseSalesOrderNumber",
                    "DatabaseSalesOrderScheduleLineNumber",
                    "GoodsIssueDate",
                    "ID",
                    "MaterialAvailabilityDate",
                    "QuantityUnit",
                    "SourceSystemInstance",
                    "SourceSystemType",
                    "SystemSalesOrderItemNumber",
                    "SystemSalesOrderNumber",
                    "SystemSalesOrderScheduleLineNumber"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VBEP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT <%=sourceSystem%>  || 'SalesOrderScheduleLine_' || \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\" AS \"ID\",\n    NULL                                                                                                                       AS \"CreationTime\",\n\t<%=sourceSystem%>  || NULL                                                                                                    AS \"CreatedBy\",\n    NULL                                                                                                                       AS \"CreationExecutionType\",\n\t<%=sourceSystem%>  || 'SalesOrderItem_' || \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\"                                 AS \"SalesOrderItem\",\n    'SAP'                                                                                                                      AS \"SourceSystemType\",\n    \"VBEP\".\"MANDT\"                                                                                                             AS \"SourceSystemInstance\",\n    \"VBEP\".\"VBELN\"                                                                                                             AS \"SystemSalesOrderNumber\",\n    \"VBEP\".\"POSNR\"                                                                                                             AS \"SystemSalesOrderItemNumber\",\n    \"VBEP\".\"ETENR\"                                                                                                             AS \"SystemSalesOrderScheduleLineNumber\",\n    \"VBEP\".\"VBELN\"                                                                                                             AS \"DatabaseSalesOrderNumber\",\n    \"VBEP\".\"POSNR\"                                                                                                             AS \"DatabaseSalesOrderItemNumber\",\n    \"VBEP\".\"ETENR\"                                                                                                             AS \"DatabaseSalesOrderScheduleLineNumber\",\n    \"VBEP\".\"BMENG\"                                                                                                             AS \"ConfirmedQuantity\",\n    \"VBEP\".\"MEINS\"                                                                                                             AS \"QuantityUnit\",\n    CASE\n        WHEN \"VBEP\".\"BMENG\" > 0\n            THEN CAST(\"VBEP\".\"EDATU\" AS TIMESTAMP) END                                                                         AS \"ConfirmedDeliveryDate\",\n    CAST(\"VBEP\".\"MBDAT\" AS TIMESTAMP)                                                                                          AS \"MaterialAvailabilityDate\",\n    CAST(\"VBEP\".\"WADAT\" AS TIMESTAMP)                                                                                          AS \"GoodsIssueDate\"\nFROM \"VBEP\" AS \"VBEP\"\n         LEFT JOIN \"VBAK\" AS \"VBAK\"\n                   ON \"VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n                       AND \"VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nWHERE \"VBEP\".\"MANDT\" IS NOT NULL\n  AND \"VBAK\".\"VBTYP\" IN ('C', 'I')\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]