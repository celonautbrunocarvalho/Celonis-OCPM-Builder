[
    {
        "change_date": 1760355081114.0,
        "changed_by": {
            "id": "83864e97-dd17-42f7-92e4-2c1d1b9c029d",
            "name": "Hema priya Sudhakar",
            "type_": "USER"
        },
        "created_by": {
            "id": "8b0fa45b-28fe-4314-bf39-c9e18042a5f4",
            "name": "Johannes Muhr",
            "type_": "USER"
        },
        "creation_date": 1753884418079.0,
        "description": "",
        "draft": null,
        "id": "c049aca3-bb5e-4c44-a2b1-9af0fad34060",
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_ECC'"
            }
        ],
        "name": "VendorInvoice - SAP ECC - 1",
        "sql_factory_transports": [
            {
                "change_date": 1760355081114.0,
                "changed_by": {
                    "id": "83864e97-dd17-42f7-92e4-2c1d1b9c029d",
                    "name": "Hema priya Sudhakar",
                    "type_": "USER"
                },
                "created_by": {
                    "id": "2202cbc9-7251-4630-bfb2-36812e688613",
                    "name": "l.pigozzi",
                    "type_": "USER"
                },
                "creation_date": 1749635327439.0,
                "data_connection_id": "b9f449da-3a15-43d8-89e3-0e87e54fb5af",
                "description": null,
                "disabled": null,
                "display_name": "VendorInvoice - SAP ECC",
                "draft": null,
                "factory_id": "e7eb467f-e1b5-40cc-a306-05ca04b53486",
                "factory_validation_status": "VALID",
                "has_user_template": true,
                "local_parameters": [
                    {
                        "name": "sourceSystem",
                        "value": "'SAP_ECC'"
                    }
                ],
                "namespace": "custom",
                "target": {
                    "entity_ref": {
                        "name": "VendorInvoice",
                        "namespace": "custom"
                    },
                    "kind": "OBJECT"
                },
                "transformations": [
                    {
                        "change_sql_factory_datasets": [
                            {
                                "id": "Cancellation",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    'Cancellation' || \n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                               AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                               AS \"ObjectID\",\n    CAST(\"RBKP_Reversal\".\"CPUDT\" AS DATE) + \n    CAST(TIMESTAMPDIFF(SECOND, CAST(\"RBKP_Reversal\".\"CPUTM\" AS DATE), \n            \"RBKP_Reversal\".\"CPUTM\") AS INTERVAL SECOND)                        AS \"Time\",\n    'Cancellation'                                                              AS \"Attribute\",\n    NULL                                                                        AS \"OldValue\",\n    NULL                                                                        AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"RBKP_Reversal\".\"MANDT\" || '::' ||\n         \"RBKP_Reversal\".\"USNAM\"                                                AS \"ChangedBy\",\n    NULL                                                                        AS \"OperationType\",\n    NULL                                                                        AS \"OperationID\",\n    NULL                                                                        AS \"ExecutionType\"\nFROM \"RBKP\" AS \"RBKP\"\n    JOIN \"RBKP\" AS \"RBKP_Reversal\" \n        ON \"RBKP\".\"MANDT\" = \"RBKP_Reversal\".\"MANDT\"\n            AND \"RBKP\".\"BELNR\" = \"RBKP_Reversal\".\"STBLG\"\n            AND \"RBKP\".\"GJAHR\" = \"RBKP_Reversal\".\"STJAH\"\nWHERE \"RBKP\".\"VGART\" = 'RD' \n    AND \"RBKP_Reversal\".\"VGART\" = 'RS'\n    AND \"RBKP_Reversal\".\"CPUDT\" IS NOT NULL\n"
                            },
                            {
                                "id": "Changes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" \n        ||  '::' || \"CDPOS\".\"FNAME\" || '::' || \"CDPOS\".\"CHANGENR\"\n        ||  '::' || \"CDPOS\".\"CHNGIND\"                                           AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"MANDANT\" || '::' || \n        SUBSTRING(\"CDPOS\".\"OBJECTID\", 1, 10) || '::' || \n        SUBSTRING(\"CDPOS\".\"OBJECTID\", 11, 4)                                    AS \"ObjectID\",\n\tCAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                AS \"Time\",\n\tCASE\n        WHEN \"CDPOS\".\"FNAME\" = 'MWSKZ1' THEN 'TaxCode'\n        WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n        WHEN \"CDPOS\".\"FNAME\" = 'XBLNR' THEN 'Reference'\n        WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaselineDate'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" END                                            AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\" END                                            AS \"NewValue\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"MANDANT\" \n        ||  '::' || \"CDHDR\".\"USERNAME\"                                          AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"CHANGENR\"                             AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') \n            THEN 'Automatic'\n        ELSE 'Manual' END                                                       AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'INCOMINGINVOICE'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n         LEFT JOIN \"RBKP\" AS \"RBKP\"\n                   ON \"CDPOS\".\"TABKEY\" = \"RBKP\".\"MANDT\" || \"RBKP\".\"BELNR\" || \"RBKP\".\"GJAHR\"\nWHERE \"CDPOS\".\"TABNAME\" = 'RBKP'\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND NULLIF(\"CDPOS\".\"MANDANT\", '') IS NOT NULL\n  AND NULLIF(\"CDHDR\".\"MANDANT\", '') IS NOT NULL\n  AND \"CDPOS\".\"FNAME\" IN ('MWSKZ1', 'ZTERM', 'XBLNR', 'ZFBDT')\n"
                            }
                        ],
                        "foreign_key_names": [
                            "User",
                            "Vendor"
                        ],
                        "namespace": "custom",
                        "property_names": [
                            "Amount",
                            "BaselineDate",
                            "BusinessUnit",
                            "CashDiscountMaximumEligibleAmount",
                            "CreationExecutionType",
                            "CreationTime",
                            "Currency",
                            "Description",
                            "ID",
                            "InvoiceCategory",
                            "InvoiceDate",
                            "PaymentMethodCode",
                            "PaymentTerms",
                            "ReceiptDate",
                            "Reference",
                            "SourceSystemInstance"
                        ],
                        "property_sql_factory_datasets": [
                            {
                                "id": "VendorInvoiceAttributes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                                   AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"USNAM\"           AS \"User\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"LIFNR\"           AS \"Vendor\",\n\tCASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 'Invoice' \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN 'InvoiceCancellation'\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN 'CreditMemo'\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 'CreditMemoCancellation' \n        ELSE 'Other' \n     END                                                                            AS \"InvoiceCategory\",\n\tCAST(\"RBKP\".\"REINDAT\" AS TIMESTAMP)                                             AS \"ReceiptDate\",\n\t\"RBKP\".\"WSKTO\" *\n    CASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 1.0\n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 1.0\n     END                                                                            AS \"CashDiscountMaximumEligibleAmount\",\n\t\"RBKP\".\"ZLSCH\"                                                                  AS \"PaymentMethodCode\",\n\t\"RBKP\".\"BKTXT\"                                                                  AS \"Description\",\n\t\"RBKP\".\"WAERS\"                                                                  AS \"Currency\",\n\t\"RBKP\".\"RMWWR\" *\n    CASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 1.0\n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 1.0\n     END                                                                            AS \"Amount\",\n\t\"RBKP\".\"XBLNR\"                                                                  AS \"Reference\",\n\t\"RBKP\".\"ZTERM\"                                                                  AS \"PaymentTerms\",\n\tCAST(\"RBKP\".\"ZFBDT\" AS TIMESTAMP)                                               AS \"BaselineDate\",\n\tCAST(\"RBKP\".\"BLDAT\" AS TIMESTAMP)                                               AS \"InvoiceDate\",\n    CASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END      AS \"CreationExecutionType\",\n\tCAST(\"RBKP\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"RBKP\".\"CPUTM\" AS DATE), \n            \"RBKP\".\"CPUTM\") AS INTERVAL SECOND)                                     AS \"CreationTime\",\n    \"RBKP\".\"BUKRS\" || ' - ' || \"T001\".\"BUTXT\"                                       AS \"BusinessUnit\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\"                                     AS \"SourceSystemInstance\"\nFROM \"RBKP\" AS \"RBKP\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"RBKP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"RBKP\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"RBKP\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"RBKP\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE NULLIF(\"RBKP\".\"MANDT\", '') IS NOT NULL \n    AND \"RBKP\".\"VGART\" IN ('RD','RS') "
                            }
                        ],
                        "relationship_transformations": []
                    }
                ]
            },
            {
                "change_date": 1760355081114.0,
                "changed_by": {
                    "id": "83864e97-dd17-42f7-92e4-2c1d1b9c029d",
                    "name": "Hema priya Sudhakar",
                    "type_": "USER"
                },
                "created_by": {
                    "id": "8b0fa45b-28fe-4314-bf39-c9e18042a5f4",
                    "name": "Johannes Muhr",
                    "type_": "USER"
                },
                "creation_date": 1753884473645.0,
                "data_connection_id": "8939ad05-4472-435c-a065-ed31be1b9fea",
                "description": null,
                "disabled": null,
                "display_name": "VendorInvoice - SAP S/4",
                "draft": null,
                "factory_id": "ba4489ea-d792-4078-a8c9-5a3153b89ca2",
                "factory_validation_status": "VALID",
                "has_user_template": true,
                "local_parameters": [
                    {
                        "name": "sourceSystem",
                        "value": "'SAP_S4_HANA'"
                    }
                ],
                "namespace": "custom",
                "target": {
                    "entity_ref": {
                        "name": "VendorInvoice",
                        "namespace": "custom"
                    },
                    "kind": "OBJECT"
                },
                "transformations": [
                    {
                        "change_sql_factory_datasets": [
                            {
                                "id": "Cancellation",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    'Cancellation' || \n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                               AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                               AS \"ObjectID\",\n    CAST(\"RBKP_Reversal\".\"CPUDT\" AS DATE) + \n    CAST(TIMESTAMPDIFF(SECOND, CAST(\"RBKP_Reversal\".\"CPUTM\" AS DATE), \n            \"RBKP_Reversal\".\"CPUTM\") AS INTERVAL SECOND)                        AS \"Time\",\n    'Cancellation'                                                              AS \"Attribute\",\n    NULL                                                                        AS \"OldValue\",\n    NULL                                                                        AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"RBKP_Reversal\".\"MANDT\" || '::' ||\n         \"RBKP_Reversal\".\"USNAM\"                                                AS \"ChangedBy\",\n    NULL                                                                        AS \"OperationType\",\n    NULL                                                                        AS \"OperationID\",\n    NULL                                                                        AS \"ExecutionType\"\nFROM \"RBKP\" AS \"RBKP\"\n    JOIN \"RBKP\" AS \"RBKP_Reversal\" \n        ON \"RBKP\".\"MANDT\" = \"RBKP_Reversal\".\"MANDT\"\n            AND \"RBKP\".\"BELNR\" = \"RBKP_Reversal\".\"STBLG\"\n            AND \"RBKP\".\"GJAHR\" = \"RBKP_Reversal\".\"STJAH\"\nWHERE \"RBKP\".\"VGART\" = 'RD' \n    AND \"RBKP_Reversal\".\"VGART\" = 'RS'\n    AND \"RBKP_Reversal\".\"CPUDT\" IS NOT NULL\n"
                            },
                            {
                                "id": "Changes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" \n        ||  '::' || \"CDPOS\".\"FNAME\" || '::' || \"CDPOS\".\"CHANGENR\"\n        ||  '::' || \"CDPOS\".\"CHNGIND\"                                           AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"MANDANT\" || '::' || \n        SUBSTRING(\"CDPOS\".\"OBJECTID\", 1, 10) || '::' || \n        SUBSTRING(\"CDPOS\".\"OBJECTID\", 11, 4)                                    AS \"ObjectID\",\n\tCAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                AS \"Time\",\n\tCASE\n        WHEN \"CDPOS\".\"FNAME\" = 'MWSKZ1' THEN 'TaxCode'\n        WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n        WHEN \"CDPOS\".\"FNAME\" = 'XBLNR' THEN 'Reference'\n        WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaselineDate'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" END                                            AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\" END                                            AS \"NewValue\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"MANDANT\" \n        ||  '::' || \"CDHDR\".\"USERNAME\"                                          AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"CHANGENR\"                             AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') \n            THEN 'Automatic'\n        ELSE 'Manual' END                                                       AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'INCOMINGINVOICE'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n         LEFT JOIN \"RBKP\" AS \"RBKP\"\n                   ON \"CDPOS\".\"TABKEY\" = \"RBKP\".\"MANDT\" || \"RBKP\".\"BELNR\" || \"RBKP\".\"GJAHR\"\nWHERE \"CDPOS\".\"TABNAME\" = 'RBKP'\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND NULLIF(\"CDPOS\".\"MANDANT\", '') IS NOT NULL\n  AND NULLIF(\"CDHDR\".\"MANDANT\", '') IS NOT NULL\n  AND \"CDPOS\".\"FNAME\" IN ('MWSKZ1', 'ZTERM', 'XBLNR', 'ZFBDT')\n"
                            }
                        ],
                        "foreign_key_names": [
                            "User",
                            "Vendor"
                        ],
                        "namespace": "custom",
                        "property_names": [
                            "Amount",
                            "BaselineDate",
                            "BusinessUnit",
                            "CashDiscountMaximumEligibleAmount",
                            "CreationExecutionType",
                            "CreationTime",
                            "Currency",
                            "Description",
                            "ID",
                            "InvoiceCategory",
                            "InvoiceDate",
                            "PaymentMethodCode",
                            "PaymentTerms",
                            "ReceiptDate",
                            "Reference",
                            "SourceSystemInstance"
                        ],
                        "property_sql_factory_datasets": [
                            {
                                "id": "VendorInvoiceAttributes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                                   AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"USNAM\"           AS \"User\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"LIFNR\"           AS \"Vendor\",\n\tCASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 'Invoice' \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN 'InvoiceCancellation'\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN 'CreditMemo'\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 'CreditMemoCancellation' \n        ELSE 'Other' \n     END                                                                            AS \"InvoiceCategory\",\n\tCAST(\"RBKP\".\"REINDAT\" AS TIMESTAMP)                                             AS \"ReceiptDate\",\n\t\"RBKP\".\"WSKTO\" *\n    CASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 1.0\n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 1.0\n     END                                                                            AS \"CashDiscountMaximumEligibleAmount\",\n\t\"RBKP\".\"ZLSCH\"                                                                  AS \"PaymentMethodCode\",\n\t\"RBKP\".\"BKTXT\"                                                                  AS \"Description\",\n\t\"RBKP\".\"WAERS\"                                                                  AS \"Currency\",\n\t\"RBKP\".\"RMWWR\" *\n    CASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 1.0\n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 1.0\n     END                                                                            AS \"Amount\",\n\t\"RBKP\".\"XBLNR\"                                                                  AS \"Reference\",\n\t\"RBKP\".\"ZTERM\"                                                                  AS \"PaymentTerms\",\n\tCAST(\"RBKP\".\"ZFBDT\" AS TIMESTAMP)                                               AS \"BaselineDate\",\n\tCAST(\"RBKP\".\"BLDAT\" AS TIMESTAMP)                                               AS \"InvoiceDate\",\n    CASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END      AS \"CreationExecutionType\",\n\tCAST(\"RBKP\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"RBKP\".\"CPUTM\" AS DATE), \n            \"RBKP\".\"CPUTM\") AS INTERVAL SECOND)                                     AS \"CreationTime\",\n    \"RBKP\".\"BUKRS\" || ' - ' || \"T001\".\"BUTXT\"                                       AS \"BusinessUnit\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\"                                     AS \"SourceSystemInstance\"\nFROM \"RBKP\" AS \"RBKP\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"RBKP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"RBKP\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"RBKP\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"RBKP\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE NULLIF(\"RBKP\".\"MANDT\", '') IS NOT NULL \n    AND \"RBKP\".\"VGART\" IN ('RD','RS') "
                            }
                        ],
                        "relationship_transformations": []
                    }
                ]
            }
        ],
        "target": {
            "entity_ref": {
                "name": "VendorInvoice",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Cancellation",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    'Cancellation' || \n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                               AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                               AS \"ObjectID\",\n    CAST(\"RBKP_Reversal\".\"CPUDT\" AS DATE) + \n    CAST(TIMESTAMPDIFF(SECOND, CAST(\"RBKP_Reversal\".\"CPUTM\" AS DATE), \n            \"RBKP_Reversal\".\"CPUTM\") AS INTERVAL SECOND)                        AS \"Time\",\n    'Cancellation'                                                              AS \"Attribute\",\n    NULL                                                                        AS \"OldValue\",\n    NULL                                                                        AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"RBKP_Reversal\".\"MANDT\" || '::' ||\n         \"RBKP_Reversal\".\"USNAM\"                                                AS \"ChangedBy\",\n    NULL                                                                        AS \"OperationType\",\n    NULL                                                                        AS \"OperationID\",\n    NULL                                                                        AS \"ExecutionType\"\nFROM \"RBKP\" AS \"RBKP\"\n    JOIN \"RBKP\" AS \"RBKP_Reversal\" \n        ON \"RBKP\".\"MANDT\" = \"RBKP_Reversal\".\"MANDT\"\n            AND \"RBKP\".\"BELNR\" = \"RBKP_Reversal\".\"STBLG\"\n            AND \"RBKP\".\"GJAHR\" = \"RBKP_Reversal\".\"STJAH\"\nWHERE \"RBKP\".\"VGART\" = 'RD' \n    AND \"RBKP_Reversal\".\"VGART\" = 'RS'\n    AND \"RBKP_Reversal\".\"CPUDT\" IS NOT NULL\n"
                    },
                    {
                        "id": "Changes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" \n        ||  '::' || \"CDPOS\".\"FNAME\" || '::' || \"CDPOS\".\"CHANGENR\"\n        ||  '::' || \"CDPOS\".\"CHNGIND\"                                           AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"MANDANT\" || '::' || \n        SUBSTRING(\"CDPOS\".\"OBJECTID\", 1, 10) || '::' || \n        SUBSTRING(\"CDPOS\".\"OBJECTID\", 11, 4)                                    AS \"ObjectID\",\n\tCAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                AS \"Time\",\n\tCASE\n        WHEN \"CDPOS\".\"FNAME\" = 'MWSKZ1' THEN 'TaxCode'\n        WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n        WHEN \"CDPOS\".\"FNAME\" = 'XBLNR' THEN 'Reference'\n        WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaselineDate'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" END                                            AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\" END                                            AS \"NewValue\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"MANDANT\" \n        ||  '::' || \"CDHDR\".\"USERNAME\"                                          AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"CHANGENR\"                             AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') \n            THEN 'Automatic'\n        ELSE 'Manual' END                                                       AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'INCOMINGINVOICE'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n         LEFT JOIN \"RBKP\" AS \"RBKP\"\n                   ON \"CDPOS\".\"TABKEY\" = \"RBKP\".\"MANDT\" || \"RBKP\".\"BELNR\" || \"RBKP\".\"GJAHR\"\nWHERE \"CDPOS\".\"TABNAME\" = 'RBKP'\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND NULLIF(\"CDPOS\".\"MANDANT\", '') IS NOT NULL\n  AND NULLIF(\"CDHDR\".\"MANDANT\", '') IS NOT NULL\n  AND \"CDPOS\".\"FNAME\" IN ('MWSKZ1', 'ZTERM', 'XBLNR', 'ZFBDT')\n"
                    }
                ],
                "foreign_key_names": [
                    "User",
                    "Vendor"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "BaselineDate",
                    "BusinessUnit",
                    "CashDiscountMaximumEligibleAmount",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "Description",
                    "ID",
                    "InvoiceCategory",
                    "InvoiceDate",
                    "PaymentMethodCode",
                    "PaymentTerms",
                    "ReceiptDate",
                    "Reference",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"BELNR\" \n        || '::' || \"RBKP\".\"GJAHR\"                                                   AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"USNAM\"           AS \"User\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' || \"RBKP\".\"LIFNR\"           AS \"Vendor\",\n\tCASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 'Invoice' \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN 'InvoiceCancellation'\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN 'CreditMemo'\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 'CreditMemoCancellation' \n        ELSE 'Other' \n     END                                                                            AS \"InvoiceCategory\",\n\tCAST(\"RBKP\".\"REINDAT\" AS TIMESTAMP)                                             AS \"ReceiptDate\",\n\t\"RBKP\".\"WSKTO\" *\n    CASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 1.0\n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 1.0\n     END                                                                            AS \"CashDiscountMaximumEligibleAmount\",\n\t\"RBKP\".\"ZLSCH\"                                                                  AS \"PaymentMethodCode\",\n\t\"RBKP\".\"BKTXT\"                                                                  AS \"Description\",\n\t\"RBKP\".\"WAERS\"                                                                  AS \"Currency\",\n\t\"RBKP\".\"RMWWR\" *\n    CASE \n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RD' THEN 1.0\n        WHEN \"RBKP\".\"XRECH\" = 'X' AND \"RBKP\".\"VGART\" = 'RS' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RD' THEN -1.0\n        WHEN (\"RBKP\".\"XRECH\" <> 'X' OR NULLIF(\"RBKP\".\"XRECH\", '') IS NULL) AND \"RBKP\".\"VGART\" = 'RS' THEN 1.0\n     END                                                                            AS \"Amount\",\n\t\"RBKP\".\"XBLNR\"                                                                  AS \"Reference\",\n\t\"RBKP\".\"ZTERM\"                                                                  AS \"PaymentTerms\",\n\tCAST(\"RBKP\".\"ZFBDT\" AS TIMESTAMP)                                               AS \"BaselineDate\",\n\tCAST(\"RBKP\".\"BLDAT\" AS TIMESTAMP)                                               AS \"InvoiceDate\",\n    CASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END      AS \"CreationExecutionType\",\n\tCAST(\"RBKP\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"RBKP\".\"CPUTM\" AS DATE), \n            \"RBKP\".\"CPUTM\") AS INTERVAL SECOND)                                     AS \"CreationTime\",\n    \"RBKP\".\"BUKRS\" || ' - ' || \"T001\".\"BUTXT\"                                       AS \"BusinessUnit\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\"                                     AS \"SourceSystemInstance\"\nFROM \"RBKP\" AS \"RBKP\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"RBKP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"RBKP\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"RBKP\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"RBKP\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE NULLIF(\"RBKP\".\"MANDT\", '') IS NOT NULL \n    AND \"RBKP\".\"VGART\" IN ('RD','RS') "
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]