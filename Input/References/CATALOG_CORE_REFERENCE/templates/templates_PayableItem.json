[
    {
        "change_date": 1764069002669.0,
        "changed_by": {
            "id": "af10323b-7030-4dbe-af1b-cbf71f532c06",
            "name": "l.lutz",
            "type_": "USER"
        },
        "created_by": {
            "id": "8b0fa45b-28fe-4314-bf39-c9e18042a5f4",
            "name": "Johannes Muhr",
            "type_": "USER"
        },
        "creation_date": 1753883377264.0,
        "description": "",
        "draft": null,
        "id": "e7701ba4-df30-4f2f-914f-48cc9ccf9dfa",
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_ECC'"
            }
        ],
        "name": "PayableItem - SAP ECC - 1",
        "sql_factory_transports": [
            {
                "change_date": 1764069002669.0,
                "changed_by": {
                    "id": "af10323b-7030-4dbe-af1b-cbf71f532c06",
                    "name": "l.lutz",
                    "type_": "USER"
                },
                "created_by": {
                    "id": "2202cbc9-7251-4630-bfb2-36812e688613",
                    "name": "l.pigozzi",
                    "type_": "USER"
                },
                "creation_date": 1749633725549.0,
                "data_connection_id": "b9f449da-3a15-43d8-89e3-0e87e54fb5af",
                "description": null,
                "disabled": null,
                "display_name": "PayableItem - SAP ECC",
                "draft": null,
                "factory_id": "dba7c1a0-28d2-4cfb-b1ab-b69df91da25a",
                "factory_validation_status": "VALID",
                "has_user_template": true,
                "local_parameters": [
                    {
                        "name": "sourceSystem",
                        "value": "'SAP_ECC'"
                    }
                ],
                "namespace": "custom",
                "target": {
                    "entity_ref": {
                        "name": "PayableItem",
                        "namespace": "custom"
                    },
                    "kind": "OBJECT"
                },
                "transformations": [
                    {
                        "change_sql_factory_datasets": [
                            {
                                "id": "Changes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::'|| \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" \n        || '::' || \"CDPOS\".\"FNAME\" || '::' || \"CDPOS\".\"CHANGENR\" \n        || '::' || \"CDPOS\".\"CHNGIND\"                                            AS \"ID\",\n    <%=sourceSystem%> || '::' || \n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 4)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 8, 10) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 18, 4) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 22, 3)                                      AS \"ObjectID\", \n    CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, \n        CAST(\"CDHDR\".\"UTIME\" AS DATE), \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)     AS \"Time\",\n\tCASE\n           WHEN \"CDPOS\".\"FNAME\" = 'SGTXT' THEN 'ItemText'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaseLineDate'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD1T' THEN 'PaymentDays1'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD2T' THEN 'PaymentDays2'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD3T' THEN 'PaymentDays3'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD1P' THEN 'DiscountPercentage1'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD2P' THEN 'DiscountPercentage2'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSCH' THEN 'PaymentMethod'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_NEW\", '') IS NULL  THEN 'ReleasePaymentBlock'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_OLD\", '') IS NULL  THEN 'SetPaymentBlock'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_OLD\", '') IS NOT NULL \n                AND NULLIF(\"CDPOS\".\"VALUE_NEW\", '') IS NOT NULL  THEN 'PaymentBlock'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-',REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" \n     END                                                                        AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n     END                                                                        AS \"NewValue\",\n\t<%=sourceSystem%>  || '::' || \"CDHDR\".\"MANDANT\" \n        || '::' || \"CDHDR\".\"USERNAME\"                                           AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%>  || '::' || \"CDHDR\".\"CHANGENR\"                            AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                        AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"ObjectID\" = \"CDHDR\".\"ObjectID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'BELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS\".\"TABNAME\" IN ('BSEG')\n  AND \"CDPOS\".\"FNAME\" IN ('SGTXT', 'ZFBDT', 'ZTERM', 'ZLSCH', 'ZLSPR', 'ZBD1T', 'ZBD2T', 'ZBD3T', 'ZBD1P', 'ZBD2P')\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND NULLIF(\"CDPOS\".\"MANDANT\", '') IS NOT NULL\n  AND NULLIF(\"CDHDR\".\"MANDANT\", '') IS NOT NULL\n"
                            },
                            {
                                "id": "Clearing",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    'Clearing' || \n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"BUKRS\" \n            ||  '::'  ||\"BKPF\".\"BELNR\"|| '::' ||  \"BKPF\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" || '::' ||  \"BSEG\".\"BUKRS\" \n            ||'::' ||  \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END \n      -- concatenating with object ID to make it unique\n     || '::' || \n    <%=sourceSystem%>  || '::'|| \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                           AS \"ID\",\n    <%=sourceSystem%>  || '::'|| \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                           AS \"ObjectID\",\n    CASE\n\t    WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN CAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND) \n        ELSE CAST(\"BSEG\".\"AUGDT\" AS DATE) + INTERVAL '86399' SECOND\n     END                                                                                                        AS \"Time\",\n    'Clearing'                                                                                                  AS \"Attribute\",\n    NULL                                                                                                        AS \"OldValue\", \n    NULL                                                                                                        AS \"NewValue\",\n    CASE\n\t    WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"\n        ELSE NULL \n     END                                                                                                        AS \"ChangedBy\",\n    NULL                                                                                                        AS \"OperationType\",\n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"BUKRS\" \n            || '::' || \"BKPF\".\"BELNR\"|| '::' || \"BKPF\".\"GJAHR\" \n        WHEN \"BSEG\".\"AUGGJ\" <> '0000'\n            THEN <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" ||'::' ||  \"BSEG\".\"BUKRS\" \n            || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n        ELSE <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" ||'::' ||  \"BSEG\".\"BUKRS\" \n            || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n            || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\"|| '::' || \"BSEG\".\"BUZEI\"  -- workaround to avoid duplicates\n     END                                                                                                        AS  \"OperationID\",\n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL AND \"USR02\".\"USTYP\" IN ('B', 'C')\n\t        THEN 'Automatic'\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL AND \"USR02\".\"USTYP\" NOT IN ('B', 'C')\n            THEN 'Manual' \n        ELSE NULL\n     END                                                                                                        AS \"ExecutionType\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"AUGBL\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"AUGGJ\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"KOART\" = 'K'\n    AND NULLIF(\"BSEG\".\"AUGBL\", '') IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('21','31')\n"
                            },
                            {
                                "id": "Payment",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT DISTINCT \n    'Payment' || \n    <%=sourceSystem%> || '::'|| \"BSEG_PAYMENT\".\"MANDT\" || '::' || \"BSEG_PAYMENT\".\"BUKRS\" \n        || '::' || \"BSEG_PAYMENT\".\"BELNR\" || '::' || \"BSEG_PAYMENT\".\"GJAHR\" \n        || '::' || \"BSEG_PAYMENT\".\"BUZEI\"  \n        -- concatenating with object ID to make it unique\n        || '::'  \n        || <%=sourceSystem%> || '::' || \"BSEG_PAYABLE_ITEM\".\"MANDT\" \n        || '::' ||  \"BSEG_PAYABLE_ITEM\".\"BUKRS\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BELNR\" || '::' || \"BSEG_PAYABLE_ITEM\".\"GJAHR\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BUZEI\"                                              AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAYABLE_ITEM\".\"MANDT\" || '::' || \"BSEG_PAYABLE_ITEM\".\"BUKRS\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BELNR\" || '::' || \"BSEG_PAYABLE_ITEM\".\"GJAHR\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BUZEI\"                                              AS \"ObjectID\",\n    CAST(\n        CAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND) AS TIMESTAMP)                       AS \"Time\",\n    'Payment'                                                                               AS \"Attribute\",\n\tNULL                                                                                    AS \"OldValue\",\n\tNULL                                                                                    AS \"NewValue\", \n    <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\"  || '::' || \"BKPF\".\"USNAM\"                  AS \"ChangedBy\",\n    NULL                                                                                    AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAYMENT\".\"MANDT\" || '::' || \"BSEG_PAYMENT\".\"BUKRS\" \n        || '::' || \"BSEG_PAYMENT\".\"BELNR\" || '::' || \"BSEG_PAYMENT\".\"GJAHR\" \n        || '::' || \"BSEG_PAYMENT\".\"BUZEI\"                                                   AS \"OperationID\", \n    CASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                    AS \"ExecutionType\"\nFROM \"BKPF\" AS \"BKPF\"\n    INNER JOIN \"BSEG\" AS \"BSEG_PAYMENT\" \n        ON \"BKPF\".\"MANDT\" = \"BSEG_PAYMENT\".\"MANDT\"\n            AND \"BKPF\".\"BUKRS\" = \"BSEG_PAYMENT\".\"BUKRS\"\n            AND \"BKPF\".\"BELNR\" = \"BSEG_PAYMENT\".\"BELNR\"\n            AND \"BKPF\".\"GJAHR\" = \"BSEG_PAYMENT\".\"GJAHR\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAYABLE_ITEM\"\n        ON  \"BSEG_PAYABLE_ITEM\".\"MANDT\" = \"BKPF\".\"MANDT\"\n            AND \"BSEG_PAYABLE_ITEM\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n            AND \"BSEG_PAYABLE_ITEM\".\"AUGBL\" = \"BKPF\".\"BELNR\"\n            AND \"BSEG_PAYABLE_ITEM\".\"AUGGJ\" = \"BKPF\".\"GJAHR\"\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n            AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE NULLIF(\"BSEG_PAYMENT\".\"MANDT\", '') IS NOT NULL\n    AND \"BSEG_PAYMENT\".\"BSCHL\" IN ('25','26')\n    AND \"BSEG_PAYABLE_ITEM\".\"BSCHL\" IN ('31')"
                            }
                        ],
                        "foreign_key_names": [
                            "CreatedBy",
                            "Vendor",
                            "VendorInvoice"
                        ],
                        "namespace": "custom",
                        "property_names": [
                            "Amount",
                            "BaselineDate",
                            "BusinessUnit",
                            "CashDiscountDueDate1",
                            "CashDiscountDueDate2",
                            "CashDiscountEligibleAmount1",
                            "CashDiscountEligibleAmount2",
                            "CashDiscountTakenAmount",
                            "ClearingDate",
                            "CreationExecutionType",
                            "CreationTime",
                            "Currency",
                            "DebitCreditIndicator",
                            "DocumentCategory",
                            "DocumentDate",
                            "FiscalYear",
                            "ID",
                            "IsBlockedForPayment",
                            "IsPurchaseDocumentRelated",
                            "IsReversed",
                            "ItemNumber",
                            "NetDueDate",
                            "PaymentMethodCode",
                            "PaymentTerms",
                            "ReceiptDate",
                            "Reference",
                            "SourceSystemInstance"
                        ],
                        "property_sql_factory_datasets": [
                            {
                                "id": "PayableItemAttributes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\t\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' ||\"BSEG\".\"BELNR\" || '::' ||\"BSEG\".\"GJAHR\" \n        || '::' || \"BSEG\".\"BUZEI\"                                               AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"       AS \"CreatedBy\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' ||\"RBKP\".\"BELNR\" \n        || '::' ||\"RBKP\".\"GJAHR\"                                                AS \"VendorInvoice\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"LIFNR\"       AS \"Vendor\",\n\tCAST(\"BKPF\".\"GJAHR\" AS BIGINT)                                              AS \"FiscalYear\",\n\tCAST(\"BSEG\".\"BUZEI\" AS VARCHAR(255))                                        AS \"ItemNumber\",\n    CAST(\"BKPF\".\"CPUDT\" AS DATE) \n        + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND)                         AS \"CreationTime\",\n\tCAST(\"BKPF\".\"REINDAT\" AS TIMESTAMP)                                         AS \"ReceiptDate\",\n\tCASE\n        WHEN \"BKPF\".\"AWTYP\" = 'RMRP' THEN TRUE\n           ELSE FALSE \n     END                                                                        AS \"IsPurchaseDocumentRelated\",\n\tCASE\n        WHEN NULLIF(\"BKPF\".\"XREVERSAL\", '') IS NOT NULL \n            THEN TRUE\n        WHEN \"BSEG\".\"BSCHL\" IN ('21','31') AND \"BKPF\".\"TCODE\" = 'MR8M'\n            THEN TRUE\n        WHEN NULLIF(\"RBKP\".\"STBLG\", '') IS NOT NULL \n            THEN TRUE \n        ELSE FALSE\n     END                                                                        AS \"IsReversed\",\n\tCASE WHEN NULLIF(\"BSEG\".\"ZLSPR\", '') IS NOT NULL THEN TRUE ELSE FALSE END   AS \"IsBlockedForPayment\",\n\tCASE\n       WHEN \"BSEG\".\"SHKZG\" = 'H' THEN 'Credit' \n       WHEN \"BSEG\".\"SHKZG\" = 'S' THEN 'Debit' \n       ELSE 'Other'\n     END                                                                        AS \"DebitCreditIndicator\",\n\tCASE\n       WHEN \"BSEG\".\"BSCHL\" = '21' AND \"BKPF\".\"TCODE\" = 'MR8M'\n           THEN 'CreditMemoItem - ReversalDocument' \n       WHEN \"BSEG\".\"BSCHL\" = '21' \n         THEN 'CreditMemoItem'\n       WHEN \"BSEG\".\"BSCHL\" = '31' AND \"BKPF\".\"TCODE\" = 'MR8M'\n           THEN 'InvoiceItem - ReversalDocument' \n       WHEN \"BSEG\".\"BSCHL\" = '31' \n           THEN 'InvoiceItem' \n       ELSE 'Other'\n     END                                                                        AS \"DocumentCategory\",\n\t\"BKPF\".\"XBLNR\"                                                              AS \"Reference\",\n\tCAST(\"BKPF\".\"BLDAT\" AS TIMESTAMP)                                           AS \"DocumentDate\",\n\tCAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP)                                           AS \"BaselineDate\",\n\tCASE\n       WHEN \"BSEG\".\"ZBD3T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD3T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" = 0\n            AND \"BSEG\".\"ZBD1T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       ELSE CAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP) + INTERVAL '86399' SECOND\n       END                                                                      AS \"NetDueDate\",\n\tCASE\n       WHEN  \"BSEG\".\"ZBD2P\" > 0 AND \"BSEG\".\"ZBD2T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       END                                                                      AS \"CashDiscountDueDate2\",\n\tCASE\n       WHEN  \"BSEG\".\"ZBD1P\" > 0 AND \"BSEG\".\"ZBD1T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       END                                                                      AS \"CashDiscountDueDate1\",\n\t\"BSEG\".\"ZLSCH\"                                                              AS \"PaymentMethodCode\",\n\tCAST(\"BSEG\".\"AUGDT\" AS TIMESTAMP)                                           AS \"ClearingDate\",\n    \"BSEG\".\"ZTERM\"                                                              AS \"PaymentTerms\",\n\t\"BSEG\".\"WRBTR\" *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"Amount\",\n    \"BSEG\".\"WSKTO\"   *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountTakenAmount\",\n\t\"BSEG\".\"SKFBT\" * \"BSEG\".\"ZBD2P\" / 100  *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountEligibleAmount2\",\n\t\"BSEG\".\"SKFBT\" * \"BSEG\".\"ZBD1P\" / 100 *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountEligibleAmount1\",\n\t\"BKPF\".\"WAERS\"                                                              AS \"Currency\",\n    \"BSEG\".\"BUKRS\" || ' - ' || \"T001\".\"BUTXT\"                                   AS \"BusinessUnit\",\n    CASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END  AS \"CreationExecutionType\",\n\t<%=sourceSystem%>  || '::' || \"BSEG\".\"MANDT\"                                AS \"SourceSystemInstance\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"BELNR\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"GJAHR\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"RBKP\" AS \"RBKP\"\n                   ON \"BKPF\".\"MANDT\" = \"RBKP\".\"MANDT\"\n                       AND \"BKPF\".\"BUKRS\" = \"RBKP\".\"BUKRS\"\n                       AND \"BKPF\".\"AWKEY\" = \"RBKP\".\"BELNR\" || \"RBKP\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"BSEG\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE NULLIF(\"BSEG\".\"MANDT\", '') IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('21','31')  "
                            }
                        ],
                        "relationship_transformations": []
                    }
                ]
            },
            {
                "change_date": 1764069002669.0,
                "changed_by": {
                    "id": "af10323b-7030-4dbe-af1b-cbf71f532c06",
                    "name": "l.lutz",
                    "type_": "USER"
                },
                "created_by": {
                    "id": "8b0fa45b-28fe-4314-bf39-c9e18042a5f4",
                    "name": "Johannes Muhr",
                    "type_": "USER"
                },
                "creation_date": 1753883436644.0,
                "data_connection_id": "8939ad05-4472-435c-a065-ed31be1b9fea",
                "description": null,
                "disabled": null,
                "display_name": "PayableItem - SAP S/4 HANA",
                "draft": null,
                "factory_id": "ed649941-bc47-4ca2-9cc0-ce80b2bb96ba",
                "factory_validation_status": "VALID",
                "has_user_template": true,
                "local_parameters": [
                    {
                        "name": "sourceSystem",
                        "value": "'SAP_S4_HANA'"
                    }
                ],
                "namespace": "custom",
                "target": {
                    "entity_ref": {
                        "name": "PayableItem",
                        "namespace": "custom"
                    },
                    "kind": "OBJECT"
                },
                "transformations": [
                    {
                        "change_sql_factory_datasets": [
                            {
                                "id": "Changes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::'|| \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" \n        || '::' || \"CDPOS\".\"FNAME\" || '::' || \"CDPOS\".\"CHANGENR\" \n        || '::' || \"CDPOS\".\"CHNGIND\"                                            AS \"ID\",\n    <%=sourceSystem%> || '::' || \n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 4)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 8, 10) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 18, 4) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 22, 3)                                      AS \"ObjectID\", \n    CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, \n        CAST(\"CDHDR\".\"UTIME\" AS DATE), \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)     AS \"Time\",\n\tCASE\n           WHEN \"CDPOS\".\"FNAME\" = 'SGTXT' THEN 'ItemText'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaseLineDate'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD1T' THEN 'PaymentDays1'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD2T' THEN 'PaymentDays2'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD3T' THEN 'PaymentDays3'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD1P' THEN 'DiscountPercentage1'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD2P' THEN 'DiscountPercentage2'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSCH' THEN 'PaymentMethod'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_NEW\", '') IS NULL  THEN 'ReleasePaymentBlock'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_OLD\", '') IS NULL  THEN 'SetPaymentBlock'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_OLD\", '') IS NOT NULL \n                AND NULLIF(\"CDPOS\".\"VALUE_NEW\", '') IS NOT NULL  THEN 'PaymentBlock'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-',REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" \n     END                                                                        AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n     END                                                                        AS \"NewValue\",\n\t<%=sourceSystem%>  || '::' || \"CDHDR\".\"MANDANT\" \n        || '::' || \"CDHDR\".\"USERNAME\"                                           AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%>  || '::' || \"CDHDR\".\"CHANGENR\"                            AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                        AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"ObjectID\" = \"CDHDR\".\"ObjectID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'BELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS\".\"TABNAME\" IN ('BSEG')\n  AND \"CDPOS\".\"FNAME\" IN ('SGTXT', 'ZFBDT', 'ZTERM', 'ZLSCH', 'ZLSPR', 'ZBD1T', 'ZBD2T', 'ZBD3T', 'ZBD1P', 'ZBD2P')\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND NULLIF(\"CDPOS\".\"MANDANT\", '') IS NOT NULL\n  AND NULLIF(\"CDHDR\".\"MANDANT\", '') IS NOT NULL\n"
                            },
                            {
                                "id": "Clearing",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    'Clearing' || \n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"BUKRS\" \n            ||  '::'  ||\"BKPF\".\"BELNR\"|| '::' ||  \"BKPF\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" || '::' ||  \"BSEG\".\"BUKRS\" \n            ||'::' ||  \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END \n      -- concatenating with object ID to make it unique\n     || '::' || \n    <%=sourceSystem%>  || '::'|| \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                           AS \"ID\",\n    <%=sourceSystem%>  || '::'|| \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                           AS \"ObjectID\",\n    CASE\n\t    WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN CAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND) \n        ELSE CAST(\"BSEG\".\"AUGDT\" AS DATE) + INTERVAL '86399' SECOND\n     END                                                                                                        AS \"Time\",\n    'Clearing'                                                                                                  AS \"Attribute\",\n    NULL                                                                                                        AS \"OldValue\", \n    NULL                                                                                                        AS \"NewValue\",\n    CASE\n\t    WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"\n        ELSE NULL \n     END                                                                                                        AS \"ChangedBy\",\n    NULL                                                                                                        AS \"OperationType\",\n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"BUKRS\" \n            || '::' || \"BKPF\".\"BELNR\"|| '::' || \"BKPF\".\"GJAHR\" \n        WHEN \"BSEG\".\"AUGGJ\" <> '0000'\n            THEN <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" ||'::' ||  \"BSEG\".\"BUKRS\" \n            || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n        ELSE <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" ||'::' ||  \"BSEG\".\"BUKRS\" \n            || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n            || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\"|| '::' || \"BSEG\".\"BUZEI\"  -- workaround to avoid duplicates\n     END                                                                                                        AS  \"OperationID\",\n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL AND \"USR02\".\"USTYP\" IN ('B', 'C')\n\t        THEN 'Automatic'\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL AND \"USR02\".\"USTYP\" NOT IN ('B', 'C')\n            THEN 'Manual' \n        ELSE NULL\n     END                                                                                                        AS \"ExecutionType\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"AUGBL\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"AUGGJ\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"KOART\" = 'K'\n    AND NULLIF(\"BSEG\".\"AUGBL\", '') IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('21','31')\n"
                            },
                            {
                                "id": "Payment",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT DISTINCT \n    'Payment' || \n    <%=sourceSystem%> || '::'|| \"BSEG_PAYMENT\".\"MANDT\" || '::' || \"BSEG_PAYMENT\".\"BUKRS\" \n        || '::' || \"BSEG_PAYMENT\".\"BELNR\" || '::' || \"BSEG_PAYMENT\".\"GJAHR\" \n        || '::' || \"BSEG_PAYMENT\".\"BUZEI\"  \n        -- concatenating with object ID to make it unique\n        || '::'  \n        || <%=sourceSystem%> || '::' || \"BSEG_PAYABLE_ITEM\".\"MANDT\" \n        || '::' ||  \"BSEG_PAYABLE_ITEM\".\"BUKRS\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BELNR\" || '::' || \"BSEG_PAYABLE_ITEM\".\"GJAHR\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BUZEI\"                                              AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAYABLE_ITEM\".\"MANDT\" || '::' || \"BSEG_PAYABLE_ITEM\".\"BUKRS\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BELNR\" || '::' || \"BSEG_PAYABLE_ITEM\".\"GJAHR\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BUZEI\"                                              AS \"ObjectID\",\n    CAST(\n        CAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND) AS TIMESTAMP)                       AS \"Time\",\n    'Payment'                                                                               AS \"Attribute\",\n\tNULL                                                                                    AS \"OldValue\",\n\tNULL                                                                                    AS \"NewValue\", \n    <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\"  || '::' || \"BKPF\".\"USNAM\"                  AS \"ChangedBy\",\n    NULL                                                                                    AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAYMENT\".\"MANDT\" || '::' || \"BSEG_PAYMENT\".\"BUKRS\" \n        || '::' || \"BSEG_PAYMENT\".\"BELNR\" || '::' || \"BSEG_PAYMENT\".\"GJAHR\" \n        || '::' || \"BSEG_PAYMENT\".\"BUZEI\"                                                   AS \"OperationID\", \n    CASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                    AS \"ExecutionType\"\nFROM \"BKPF\" AS \"BKPF\"\n    INNER JOIN \"BSEG\" AS \"BSEG_PAYMENT\" \n        ON \"BKPF\".\"MANDT\" = \"BSEG_PAYMENT\".\"MANDT\"\n            AND \"BKPF\".\"BUKRS\" = \"BSEG_PAYMENT\".\"BUKRS\"\n            AND \"BKPF\".\"BELNR\" = \"BSEG_PAYMENT\".\"BELNR\"\n            AND \"BKPF\".\"GJAHR\" = \"BSEG_PAYMENT\".\"GJAHR\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAYABLE_ITEM\"\n        ON  \"BSEG_PAYABLE_ITEM\".\"MANDT\" = \"BKPF\".\"MANDT\"\n            AND \"BSEG_PAYABLE_ITEM\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n            AND \"BSEG_PAYABLE_ITEM\".\"AUGBL\" = \"BKPF\".\"BELNR\"\n            AND \"BSEG_PAYABLE_ITEM\".\"AUGGJ\" = \"BKPF\".\"GJAHR\"\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n            AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE NULLIF(\"BSEG_PAYMENT\".\"MANDT\", '') IS NOT NULL\n    AND \"BSEG_PAYMENT\".\"BSCHL\" IN ('25','26')\n    AND \"BSEG_PAYABLE_ITEM\".\"BSCHL\" IN ('31')"
                            }
                        ],
                        "foreign_key_names": [
                            "CreatedBy",
                            "Vendor",
                            "VendorInvoice"
                        ],
                        "namespace": "custom",
                        "property_names": [
                            "Amount",
                            "BaselineDate",
                            "BusinessUnit",
                            "CashDiscountDueDate1",
                            "CashDiscountDueDate2",
                            "CashDiscountEligibleAmount1",
                            "CashDiscountEligibleAmount2",
                            "CashDiscountTakenAmount",
                            "ClearingDate",
                            "CreationExecutionType",
                            "CreationTime",
                            "Currency",
                            "DebitCreditIndicator",
                            "DocumentCategory",
                            "DocumentDate",
                            "FiscalYear",
                            "ID",
                            "IsBlockedForPayment",
                            "IsPurchaseDocumentRelated",
                            "IsReversed",
                            "ItemNumber",
                            "NetDueDate",
                            "PaymentMethodCode",
                            "PaymentTerms",
                            "ReceiptDate",
                            "Reference",
                            "SourceSystemInstance"
                        ],
                        "property_sql_factory_datasets": [
                            {
                                "id": "PayableItemAttributes",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\t\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' ||\"BSEG\".\"BELNR\" || '::' ||\"BSEG\".\"GJAHR\" \n        || '::' || \"BSEG\".\"BUZEI\"                                               AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"       AS \"CreatedBy\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' ||\"RBKP\".\"BELNR\" \n        || '::' ||\"RBKP\".\"GJAHR\"                                                AS \"VendorInvoice\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"LIFNR\"       AS \"Vendor\",\n\tCAST(\"BKPF\".\"GJAHR\" AS BIGINT)                                              AS \"FiscalYear\",\n\tCAST(\"BSEG\".\"BUZEI\" AS VARCHAR(255))                                        AS \"ItemNumber\",\n    CAST(\"BKPF\".\"CPUDT\" AS DATE) \n        + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND)                         AS \"CreationTime\",\n\tCAST(\"BKPF\".\"REINDAT\" AS TIMESTAMP)                                         AS \"ReceiptDate\",\n\tCASE\n        WHEN \"BKPF\".\"AWTYP\" = 'RMRP' THEN TRUE\n           ELSE FALSE \n     END                                                                        AS \"IsPurchaseDocumentRelated\",\n\tCASE\n        WHEN NULLIF(\"BKPF\".\"XREVERSAL\", '') IS NOT NULL \n            THEN TRUE\n        WHEN \"BSEG\".\"BSCHL\" IN ('21','31') AND \"BKPF\".\"TCODE\" = 'MR8M'\n            THEN TRUE\n        WHEN NULLIF(\"RBKP\".\"STBLG\", '') IS NOT NULL \n            THEN TRUE \n        ELSE FALSE\n     END                                                                        AS \"IsReversed\",\n\tCASE WHEN NULLIF(\"BSEG\".\"ZLSPR\", '') IS NOT NULL THEN TRUE ELSE FALSE END   AS \"IsBlockedForPayment\",\n\tCASE\n       WHEN \"BSEG\".\"SHKZG\" = 'H' THEN 'Credit' \n       WHEN \"BSEG\".\"SHKZG\" = 'S' THEN 'Debit' \n       ELSE 'Other'\n     END                                                                        AS \"DebitCreditIndicator\",\n\tCASE\n       WHEN \"BSEG\".\"BSCHL\" = '21' AND \"BKPF\".\"TCODE\" = 'MR8M'\n           THEN 'CreditMemoItem - ReversalDocument' \n       WHEN \"BSEG\".\"BSCHL\" = '21' \n         THEN 'CreditMemoItem'\n       WHEN \"BSEG\".\"BSCHL\" = '31' AND \"BKPF\".\"TCODE\" = 'MR8M'\n           THEN 'InvoiceItem - ReversalDocument' \n       WHEN \"BSEG\".\"BSCHL\" = '31' \n           THEN 'InvoiceItem' \n       ELSE 'Other'\n     END                                                                        AS \"DocumentCategory\",\n\t\"BKPF\".\"XBLNR\"                                                              AS \"Reference\",\n\tCAST(\"BKPF\".\"BLDAT\" AS TIMESTAMP)                                           AS \"DocumentDate\",\n\tCAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP)                                           AS \"BaselineDate\",\n\tCASE\n       WHEN \"BSEG\".\"ZBD3T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD3T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" = 0\n            AND \"BSEG\".\"ZBD1T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       ELSE CAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP) + INTERVAL '86399' SECOND\n       END                                                                      AS \"NetDueDate\",\n\tCASE\n       WHEN  \"BSEG\".\"ZBD2P\" > 0 AND \"BSEG\".\"ZBD2T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       END                                                                      AS \"CashDiscountDueDate2\",\n\tCASE\n       WHEN  \"BSEG\".\"ZBD1P\" > 0 AND \"BSEG\".\"ZBD1T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       END                                                                      AS \"CashDiscountDueDate1\",\n\t\"BSEG\".\"ZLSCH\"                                                              AS \"PaymentMethodCode\",\n\tCAST(\"BSEG\".\"AUGDT\" AS TIMESTAMP)                                           AS \"ClearingDate\",\n    \"BSEG\".\"ZTERM\"                                                              AS \"PaymentTerms\",\n\t\"BSEG\".\"WRBTR\" *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"Amount\",\n    \"BSEG\".\"WSKTO\"   *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountTakenAmount\",\n\t\"BSEG\".\"SKFBT\" * \"BSEG\".\"ZBD2P\" / 100  *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountEligibleAmount2\",\n\t\"BSEG\".\"SKFBT\" * \"BSEG\".\"ZBD1P\" / 100 *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountEligibleAmount1\",\n\t\"BKPF\".\"WAERS\"                                                              AS \"Currency\",\n    \"BSEG\".\"BUKRS\" || ' - ' || \"T001\".\"BUTXT\"                                   AS \"BusinessUnit\",\n    CASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END  AS \"CreationExecutionType\",\n\t<%=sourceSystem%>  || '::' || \"BSEG\".\"MANDT\"                                AS \"SourceSystemInstance\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"BELNR\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"GJAHR\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"RBKP\" AS \"RBKP\"\n                   ON \"BKPF\".\"MANDT\" = \"RBKP\".\"MANDT\"\n                       AND \"BKPF\".\"BUKRS\" = \"RBKP\".\"BUKRS\"\n                       AND \"BKPF\".\"AWKEY\" = \"RBKP\".\"BELNR\" || \"RBKP\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"BSEG\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE NULLIF(\"BSEG\".\"MANDT\", '') IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('21','31')  "
                            }
                        ],
                        "relationship_transformations": []
                    }
                ]
            }
        ],
        "target": {
            "entity_ref": {
                "name": "PayableItem",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Changes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n\t<%=sourceSystem%> || '::'|| \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" \n        || '::' || \"CDPOS\".\"FNAME\" || '::' || \"CDPOS\".\"CHANGENR\" \n        || '::' || \"CDPOS\".\"CHNGIND\"                                            AS \"ID\",\n    <%=sourceSystem%> || '::' || \n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 4)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 8, 10) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 18, 4) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 22, 3)                                      AS \"ObjectID\", \n    CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, \n        CAST(\"CDHDR\".\"UTIME\" AS DATE), \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)     AS \"Time\",\n\tCASE\n           WHEN \"CDPOS\".\"FNAME\" = 'SGTXT' THEN 'ItemText'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaseLineDate'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD1T' THEN 'PaymentDays1'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD2T' THEN 'PaymentDays2'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD3T' THEN 'PaymentDays3'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD1P' THEN 'DiscountPercentage1'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZBD2P' THEN 'DiscountPercentage2'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSCH' THEN 'PaymentMethod'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_NEW\", '') IS NULL  THEN 'ReleasePaymentBlock'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_OLD\", '') IS NULL  THEN 'SetPaymentBlock'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZLSPR' \n                AND NULLIF(\"CDPOS\".\"VALUE_OLD\", '') IS NOT NULL \n                AND NULLIF(\"CDPOS\".\"VALUE_NEW\", '') IS NOT NULL  THEN 'PaymentBlock'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-',REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" \n     END                                                                        AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n     END                                                                        AS \"NewValue\",\n\t<%=sourceSystem%>  || '::' || \"CDHDR\".\"MANDANT\" \n        || '::' || \"CDHDR\".\"USERNAME\"                                           AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%>  || '::' || \"CDHDR\".\"CHANGENR\"                            AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                        AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"ObjectID\" = \"CDHDR\".\"ObjectID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'BELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS\".\"TABNAME\" IN ('BSEG')\n  AND \"CDPOS\".\"FNAME\" IN ('SGTXT', 'ZFBDT', 'ZTERM', 'ZLSCH', 'ZLSPR', 'ZBD1T', 'ZBD2T', 'ZBD3T', 'ZBD1P', 'ZBD2P')\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND NULLIF(\"CDPOS\".\"MANDANT\", '') IS NOT NULL\n  AND NULLIF(\"CDHDR\".\"MANDANT\", '') IS NOT NULL\n"
                    },
                    {
                        "id": "Clearing",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    'Clearing' || \n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"BUKRS\" \n            ||  '::'  ||\"BKPF\".\"BELNR\"|| '::' ||  \"BKPF\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" || '::' ||  \"BSEG\".\"BUKRS\" \n            ||'::' ||  \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END \n      -- concatenating with object ID to make it unique\n     || '::' || \n    <%=sourceSystem%>  || '::'|| \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                           AS \"ID\",\n    <%=sourceSystem%>  || '::'|| \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                           AS \"ObjectID\",\n    CASE\n\t    WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN CAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND) \n        ELSE CAST(\"BSEG\".\"AUGDT\" AS DATE) + INTERVAL '86399' SECOND\n     END                                                                                                        AS \"Time\",\n    'Clearing'                                                                                                  AS \"Attribute\",\n    NULL                                                                                                        AS \"OldValue\", \n    NULL                                                                                                        AS \"NewValue\",\n    CASE\n\t    WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"\n        ELSE NULL \n     END                                                                                                        AS \"ChangedBy\",\n    NULL                                                                                                        AS \"OperationType\",\n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL\n            THEN <%=sourceSystem%> || '::'|| \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"BUKRS\" \n            || '::' || \"BKPF\".\"BELNR\"|| '::' || \"BKPF\".\"GJAHR\" \n        WHEN \"BSEG\".\"AUGGJ\" <> '0000'\n            THEN <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" ||'::' ||  \"BSEG\".\"BUKRS\" \n            || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n        ELSE <%=sourceSystem%> || '::'|| \"BSEG\".\"MANDT\" ||'::' ||  \"BSEG\".\"BUKRS\" \n            || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n            || '::' || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\"|| '::' || \"BSEG\".\"BUZEI\"  -- workaround to avoid duplicates\n     END                                                                                                        AS  \"OperationID\",\n    CASE\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL AND \"USR02\".\"USTYP\" IN ('B', 'C')\n\t        THEN 'Automatic'\n        WHEN NULLIF(\"BKPF\".\"MANDT\", '') IS NOT NULL AND \"USR02\".\"USTYP\" NOT IN ('B', 'C')\n            THEN 'Manual' \n        ELSE NULL\n     END                                                                                                        AS \"ExecutionType\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"AUGBL\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"AUGGJ\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"KOART\" = 'K'\n    AND NULLIF(\"BSEG\".\"AUGBL\", '') IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('21','31')\n"
                    },
                    {
                        "id": "Payment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT DISTINCT \n    'Payment' || \n    <%=sourceSystem%> || '::'|| \"BSEG_PAYMENT\".\"MANDT\" || '::' || \"BSEG_PAYMENT\".\"BUKRS\" \n        || '::' || \"BSEG_PAYMENT\".\"BELNR\" || '::' || \"BSEG_PAYMENT\".\"GJAHR\" \n        || '::' || \"BSEG_PAYMENT\".\"BUZEI\"  \n        -- concatenating with object ID to make it unique\n        || '::'  \n        || <%=sourceSystem%> || '::' || \"BSEG_PAYABLE_ITEM\".\"MANDT\" \n        || '::' ||  \"BSEG_PAYABLE_ITEM\".\"BUKRS\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BELNR\" || '::' || \"BSEG_PAYABLE_ITEM\".\"GJAHR\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BUZEI\"                                              AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAYABLE_ITEM\".\"MANDT\" || '::' || \"BSEG_PAYABLE_ITEM\".\"BUKRS\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BELNR\" || '::' || \"BSEG_PAYABLE_ITEM\".\"GJAHR\" \n        || '::' || \"BSEG_PAYABLE_ITEM\".\"BUZEI\"                                              AS \"ObjectID\",\n    CAST(\n        CAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND) AS TIMESTAMP)                       AS \"Time\",\n    'Payment'                                                                               AS \"Attribute\",\n\tNULL                                                                                    AS \"OldValue\",\n\tNULL                                                                                    AS \"NewValue\", \n    <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\"  || '::' || \"BKPF\".\"USNAM\"                  AS \"ChangedBy\",\n    NULL                                                                                    AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAYMENT\".\"MANDT\" || '::' || \"BSEG_PAYMENT\".\"BUKRS\" \n        || '::' || \"BSEG_PAYMENT\".\"BELNR\" || '::' || \"BSEG_PAYMENT\".\"GJAHR\" \n        || '::' || \"BSEG_PAYMENT\".\"BUZEI\"                                                   AS \"OperationID\", \n    CASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                    AS \"ExecutionType\"\nFROM \"BKPF\" AS \"BKPF\"\n    INNER JOIN \"BSEG\" AS \"BSEG_PAYMENT\" \n        ON \"BKPF\".\"MANDT\" = \"BSEG_PAYMENT\".\"MANDT\"\n            AND \"BKPF\".\"BUKRS\" = \"BSEG_PAYMENT\".\"BUKRS\"\n            AND \"BKPF\".\"BELNR\" = \"BSEG_PAYMENT\".\"BELNR\"\n            AND \"BKPF\".\"GJAHR\" = \"BSEG_PAYMENT\".\"GJAHR\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAYABLE_ITEM\"\n        ON  \"BSEG_PAYABLE_ITEM\".\"MANDT\" = \"BKPF\".\"MANDT\"\n            AND \"BSEG_PAYABLE_ITEM\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n            AND \"BSEG_PAYABLE_ITEM\".\"AUGBL\" = \"BKPF\".\"BELNR\"\n            AND \"BSEG_PAYABLE_ITEM\".\"AUGGJ\" = \"BKPF\".\"GJAHR\"\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n            AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE NULLIF(\"BSEG_PAYMENT\".\"MANDT\", '') IS NOT NULL\n    AND \"BSEG_PAYMENT\".\"BSCHL\" IN ('25','26')\n    AND \"BSEG_PAYABLE_ITEM\".\"BSCHL\" IN ('31')"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Vendor",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "BaselineDate",
                    "BusinessUnit",
                    "CashDiscountDueDate1",
                    "CashDiscountDueDate2",
                    "CashDiscountEligibleAmount1",
                    "CashDiscountEligibleAmount2",
                    "CashDiscountTakenAmount",
                    "ClearingDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "DebitCreditIndicator",
                    "DocumentCategory",
                    "DocumentDate",
                    "FiscalYear",
                    "ID",
                    "IsBlockedForPayment",
                    "IsPurchaseDocumentRelated",
                    "IsReversed",
                    "ItemNumber",
                    "NetDueDate",
                    "PaymentMethodCode",
                    "PaymentTerms",
                    "ReceiptDate",
                    "Reference",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "PayableItemAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\t\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" \n        || '::' ||\"BSEG\".\"BELNR\" || '::' ||\"BSEG\".\"GJAHR\" \n        || '::' || \"BSEG\".\"BUZEI\"                                               AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"       AS \"CreatedBy\",\n    <%=sourceSystem%> || '::' || \"RBKP\".\"MANDT\" || '::' ||\"RBKP\".\"BELNR\" \n        || '::' ||\"RBKP\".\"GJAHR\"                                                AS \"VendorInvoice\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"LIFNR\"       AS \"Vendor\",\n\tCAST(\"BKPF\".\"GJAHR\" AS BIGINT)                                              AS \"FiscalYear\",\n\tCAST(\"BSEG\".\"BUZEI\" AS VARCHAR(255))                                        AS \"ItemNumber\",\n    CAST(\"BKPF\".\"CPUDT\" AS DATE) \n        + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n                    \"BKPF\".\"CPUTM\") AS INTERVAL SECOND)                         AS \"CreationTime\",\n\tCAST(\"BKPF\".\"REINDAT\" AS TIMESTAMP)                                         AS \"ReceiptDate\",\n\tCASE\n        WHEN \"BKPF\".\"AWTYP\" = 'RMRP' THEN TRUE\n           ELSE FALSE \n     END                                                                        AS \"IsPurchaseDocumentRelated\",\n\tCASE\n        WHEN NULLIF(\"BKPF\".\"XREVERSAL\", '') IS NOT NULL \n            THEN TRUE\n        WHEN \"BSEG\".\"BSCHL\" IN ('21','31') AND \"BKPF\".\"TCODE\" = 'MR8M'\n            THEN TRUE\n        WHEN NULLIF(\"RBKP\".\"STBLG\", '') IS NOT NULL \n            THEN TRUE \n        ELSE FALSE\n     END                                                                        AS \"IsReversed\",\n\tCASE WHEN NULLIF(\"BSEG\".\"ZLSPR\", '') IS NOT NULL THEN TRUE ELSE FALSE END   AS \"IsBlockedForPayment\",\n\tCASE\n       WHEN \"BSEG\".\"SHKZG\" = 'H' THEN 'Credit' \n       WHEN \"BSEG\".\"SHKZG\" = 'S' THEN 'Debit' \n       ELSE 'Other'\n     END                                                                        AS \"DebitCreditIndicator\",\n\tCASE\n       WHEN \"BSEG\".\"BSCHL\" = '21' AND \"BKPF\".\"TCODE\" = 'MR8M'\n           THEN 'CreditMemoItem - ReversalDocument' \n       WHEN \"BSEG\".\"BSCHL\" = '21' \n         THEN 'CreditMemoItem'\n       WHEN \"BSEG\".\"BSCHL\" = '31' AND \"BKPF\".\"TCODE\" = 'MR8M'\n           THEN 'InvoiceItem - ReversalDocument' \n       WHEN \"BSEG\".\"BSCHL\" = '31' \n           THEN 'InvoiceItem' \n       ELSE 'Other'\n     END                                                                        AS \"DocumentCategory\",\n\t\"BKPF\".\"XBLNR\"                                                              AS \"Reference\",\n\tCAST(\"BKPF\".\"BLDAT\" AS TIMESTAMP)                                           AS \"DocumentDate\",\n\tCAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP)                                           AS \"BaselineDate\",\n\tCASE\n       WHEN \"BSEG\".\"ZBD3T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD3T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" = 0\n            AND \"BSEG\".\"ZBD1T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       ELSE CAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP) + INTERVAL '86399' SECOND\n       END                                                                      AS \"NetDueDate\",\n\tCASE\n       WHEN  \"BSEG\".\"ZBD2P\" > 0 AND \"BSEG\".\"ZBD2T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       END                                                                      AS \"CashDiscountDueDate2\",\n\tCASE\n       WHEN  \"BSEG\".\"ZBD1P\" > 0 AND \"BSEG\".\"ZBD1T\" > 0\n           THEN\n               CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                     + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n       END                                                                      AS \"CashDiscountDueDate1\",\n\t\"BSEG\".\"ZLSCH\"                                                              AS \"PaymentMethodCode\",\n\tCAST(\"BSEG\".\"AUGDT\" AS TIMESTAMP)                                           AS \"ClearingDate\",\n    \"BSEG\".\"ZTERM\"                                                              AS \"PaymentTerms\",\n\t\"BSEG\".\"WRBTR\" *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"Amount\",\n    \"BSEG\".\"WSKTO\"   *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountTakenAmount\",\n\t\"BSEG\".\"SKFBT\" * \"BSEG\".\"ZBD2P\" / 100  *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountEligibleAmount2\",\n\t\"BSEG\".\"SKFBT\" * \"BSEG\".\"ZBD1P\" / 100 *\n        CASE\n            WHEN \"BSEG\".\"SHKZG\" = 'S' THEN -1.0\n            ELSE 1.0\n        END                                                                     AS \"CashDiscountEligibleAmount1\",\n\t\"BKPF\".\"WAERS\"                                                              AS \"Currency\",\n    \"BSEG\".\"BUKRS\" || ' - ' || \"T001\".\"BUTXT\"                                   AS \"BusinessUnit\",\n    CASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END  AS \"CreationExecutionType\",\n\t<%=sourceSystem%>  || '::' || \"BSEG\".\"MANDT\"                                AS \"SourceSystemInstance\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"BELNR\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"GJAHR\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"RBKP\" AS \"RBKP\"\n                   ON \"BKPF\".\"MANDT\" = \"RBKP\".\"MANDT\"\n                       AND \"BKPF\".\"BUKRS\" = \"RBKP\".\"BUKRS\"\n                       AND \"BKPF\".\"AWKEY\" = \"RBKP\".\"BELNR\" || \"RBKP\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"BSEG\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE NULLIF(\"BSEG\".\"MANDT\", '') IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('21','31')  "
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]