[
    {
        "change_date": 1761783803418.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749737113394.0,
        "data_connection_id": "b9f449da-3a15-43d8-89e3-0e87e54fb5af",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderScheduleLine - 00. Central Extraction Pool_TS1",
        "draft": null,
        "factory_id": "46ee5c4f-0d4e-4a80-bc4c-232f8167f247",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "LanguageKey",
                "value": "'E'"
            },
            {
                "name": "sourceSystem",
                "value": "'SAP_ECC'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Cancellation",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_CDPOS_CDHDR\" AS (\n SELECT\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3) AS \"MANDT\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10) AS \"VBELN\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 16) AS \"POSNR\",\n   \"CDPOS\".\"TABKEY\",\n   \"CDPOS\".\"TABNAME\",\n   \"CDPOS\".\"FNAME\",\n   \"CDPOS\".\"CHANGENR\",\n   \"CDPOS\".\"CHNGIND\",\n   \"CDPOS\".\"VALUE_OLD\",\n   \"CDPOS\".\"VALUE_NEW\",\n   \"CDHDR\".\"MANDANT\",\n   \"CDHDR\".\"USERNAME\",\n   \"CDHDR\".\"UTIME\",\n   \"CDHDR\".\"UDATE\",\n   \"CDHDR\".\"OBJECTCLAS\",\n   \"CDHDR\".\"OBJECTID\",\n   \"CDHDR\".\"TCODE\"\n FROM \"CDPOS\" AS \"CDPOS\"\n   LEFT JOIN \"CDHDR\" AS \"CDHDR\" ON \n    \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\" \n    AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n    AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\" \n    AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\" \n    AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n ORDER BY 1,2,3\n)\nSELECT\n    <%=sourceSystem%>\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6)\n        || COALESCE('::' || \"VBEP\".\"ETENR\", '')                                  AS \"ObjectID\",\n    <%=sourceSystem%>\n        || '::' || \"CDPOS_CDHDR\".\"TABKEY\"\n        || COALESCE('::' || \"VBEP\".\"ETENR\", '')\n        || '::' || \"CDPOS_CDHDR\".\"TABNAME\"\n        || '::' || \"CDPOS_CDHDR\".\"FNAME\"\n        || '::' || \"CDPOS_CDHDR\".\"CHANGENR\"\n        || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"                                                   AS \"ID\",\n    CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n        \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                           AS \"Time\",\n    'IsCanceled'                                                                       AS \"Attribute\",\n    CAST(FALSE AS VARCHAR(255))                                                        AS \"OldValue\",\n    CAST(TRUE AS VARCHAR(255))                                                         AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"       AS \"ChangedBy\",\n    \"CDPOS_CDHDR\".\"TCODE\"                                                                    AS \"OperationType\",\n    \"CDPOS_CDHDR\".\"CHANGENR\"                                                                 AS \"OperationID\",\n    CASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                                AS \"ExecutionType\"\nFROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\nLEFT JOIN \"VBEP\" AS \"VBEP\"\n    ON SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3) = \"VBEP\".\"MANDT\"\n       AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10) = \"VBEP\".\"VBELN\"\n       AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) = \"VBEP\".\"POSNR\"\n       AND \"VBEP\".\"BMENG\" > 0\nLEFT JOIN \"USR02\" AS \"USR02\"\n    ON \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n        AND \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBAP'\n AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'U'\n AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n AND \"CDPOS_CDHDR\".\"FNAME\" = 'ABGRU' AND NULLIF(\"CDPOS_CDHDR\".\"VALUE_OLD\", '') IS NULL\n AND \"CDPOS_CDHDR\".\"FNAME\" = 'ABGRU' AND NULLIF(\"CDPOS_CDHDR\".\"VALUE_NEW\", '') IS NOT NULL\n\n"
                    },
                    {
                        "id": "ChangesVBAP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_CDPOS_CDHDR\" AS (\n SELECT\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3) AS \"MANDT\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10) AS \"VBELN\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 16) AS \"POSNR\",\n   \"CDPOS\".\"TABKEY\",\n   \"CDPOS\".\"TABNAME\",\n   \"CDPOS\".\"FNAME\",\n   \"CDPOS\".\"CHANGENR\",\n   \"CDPOS\".\"CHNGIND\",\n   \"CDPOS\".\"VALUE_OLD\",\n   \"CDPOS\".\"VALUE_NEW\",\n   \"CDHDR\".\"MANDANT\",\n   \"CDHDR\".\"USERNAME\",\n   \"CDHDR\".\"UTIME\",\n   \"CDHDR\".\"UDATE\",\n   \"CDHDR\".\"OBJECTCLAS\",\n   \"CDHDR\".\"OBJECTID\",\n   \"CDHDR\".\"TCODE\"\n FROM \"CDPOS\" AS \"CDPOS\"\n   LEFT JOIN \"CDHDR\" AS \"CDHDR\" ON \n        \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\" \n        AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\" \n        AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\" \n        AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\" \n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n ORDER BY 1,2,3\n),\n\"CTE_ChangesAll\" AS (\n    SELECT\n        <%=sourceSystem%>\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6)\n            || COALESCE('::' || \"VBEP\".\"ETENR\", '')                                       AS \"ObjectID\",\n        <%=sourceSystem%>\n            || '::' || \"CDPOS_CDHDR\".\"TABKEY\"\n            || COALESCE('::' || \"VBEP\".\"ETENR\", '')\n            || '::' || \"CDPOS_CDHDR\".\"TABNAME\"\n            || '::' || \"CDPOS_CDHDR\".\"FNAME\"\n            || '::' || \"CDPOS_CDHDR\".\"CHANGENR\"\n            || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"                                                   AS \"ID\",\n        CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n            \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                           AS \"Time\",\n        CASE\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'NETPR' THEN 'NetUnitPrice'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'MATNR' THEN 'MaterialNumber'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'ABGRU' AND NULLIF(\"CDPOS_CDHDR\".\"VALUE_OLD\", '') IS NOT NULL\n                THEN 'CancellationReason'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'WERKS' THEN 'Plant'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'KWMENG' THEN 'Quantity'\n        END                                                                                AS \"Attribute\",\n        CASE\n            WHEN \"CDPOS_CDHDR\".\"VALUE_OLD\" LIKE '%-'\n                THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS_CDHDR\".\"VALUE_OLD\"), '-', ''))\n            ELSE \"CDPOS_CDHDR\".\"VALUE_OLD\" END                                                   AS \"OldValue\",\n        CASE\n            WHEN \"CDPOS_CDHDR\".\"VALUE_NEW\" LIKE '%-'\n                THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS_CDHDR\".\"VALUE_NEW\"), '-', ''))\n            ELSE \"CDPOS_CDHDR\".\"VALUE_NEW\" END                                                   AS \"NewValue\",\n        <%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"       AS \"ChangedBy\",\n        \"CDPOS_CDHDR\".\"TCODE\"                                                                    AS \"OperationType\",\n        \"CDPOS_CDHDR\".\"CHANGENR\"                                                                 AS \"OperationID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                                AS \"ExecutionType\"\n    FROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\n    LEFT JOIN \"VBEP\" AS \"VBEP\"\n        ON SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3) = \"VBEP\".\"MANDT\"\n            AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10) = \"VBEP\".\"VBELN\"\n            AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) = \"VBEP\".\"POSNR\"\n            AND \"VBEP\".\"BMENG\" > 0\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n            AND \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n    WHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBAP'\n    AND \"CDPOS_CDHDR\".\"FNAME\" IN ('NETPR', 'MATNR', 'ABGRU', 'WERKS', 'KWMENG')\n    AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'U'\n    AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n    AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n)\nSELECT \n    \"ChangesAll\".\"ObjectID\"         AS \"ObjectID\",\n    \"ChangesAll\".\"ID\"               AS \"ID\",\n    \"ChangesAll\".\"Time\"             AS \"Time\",\n    \"ChangesAll\".\"Attribute\"        AS \"Attribute\",\n    \"ChangesAll\".\"OldValue\"         AS \"OldValue\",\n    \"ChangesAll\".\"NewValue\"         AS \"NewValue\",\n    \"ChangesAll\".\"ChangedBy\"        AS \"ChangedBy\",\n    \"ChangesAll\".\"OperationType\"    AS \"OperationType\",\n    \"ChangesAll\".\"OperationID\"      AS \"OperationID\",\n    \"ChangesAll\".\"ExecutionType\"    AS \"ExecutionType\"\nFROM \"CTE_ChangesAll\" AS \"ChangesAll\" \nWHERE \"ChangesAll\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "ChangesVBEP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Sorted_Changes\" AS (\n    SELECT\n        \"CDPOS\".\"MANDANT\"                                                                                  AS \"MANDANT\",\n        \"CDPOS\".\"TABNAME\"                                                                                  AS \"TABNAME\",\n        \"CDPOS\".\"TABKEY\"                                                                                   AS \"TABKEY\",\n        CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \"CDHDR\".\"UTIME\")\n            AS INTERVAL SECOND)                                                                            AS \"CHANGEDATE\",\n        LTRIM(\"CDPOS\".\"VALUE_OLD\")                                                                         AS \"VALUE_OLD\",\n        LTRIM(\"CDPOS\".\"VALUE_NEW\")                                                                         AS \"VALUE_NEW\",\n        ROW_NUMBER()\n        OVER (PARTITION BY \"CDPOS\".\"MANDANT\", \"CDPOS\".\"TABNAME\", \"CDPOS\".\"TABKEY\"\n            ORDER BY \"CDHDR\".\"UDATE\", \"CDHDR\".\"UTIME\")                                                     AS \"rn\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n    LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n        ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n    WHERE \"CDPOS\".\"MANDANT\" IS NOT NULL\n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS\".\"FNAME\" = 'BMENG'\n    ),\n\"CTE_SalesOrderScheduleLine_LookUp\" AS (\n    SELECT\n        \"Current\".\"MANDANT\",\n        \"Current\".\"TABNAME\",\n        \"Current\".\"TABKEY\",\n        \"Current\".\"CHANGEDATE\" AS \"StartDate\",\n        CASE\n            WHEN \"Next\".\"rn\" IS NULL\n                THEN CAST('9999-01-01 09:09:09' AS TIMESTAMP)\n            ELSE \"Next\".\"CHANGEDATE\"\n            END                AS \"EndDate\",\n        \"Current\".\"VALUE_NEW\"  AS \"Value\"\n    FROM \"CTE_Sorted_Changes\" AS \"Current\"\n    LEFT JOIN \"CTE_Sorted_Changes\" AS \"Next\"\n        ON \"Current\".\"MANDANT\" = \"Next\".\"MANDANT\"\n            AND \"Current\".\"TABNAME\" = \"Next\".\"TABNAME\"\n            AND \"Current\".\"TABKEY\" = \"Next\".\"TABKEY\"\n            AND \"Current\".\"rn\" + 1 = \"Next\".\"rn\"\n    UNION ALL\n    SELECT \"Current\".\"MANDANT\",\n        \"Current\".\"TABNAME\",\n        \"Current\".\"TABKEY\",\n        CAST('1970-01-01 00:00:00' AS TIMESTAMP) AS \"StartDate\",\n        \"Current\".\"CHANGEDATE\"                   AS \"EndDate\",\n        \"Current\".\"VALUE_OLD\"                    AS \"Value\"\n    FROM \"CTE_Sorted_Changes\" AS \"Current\"\n    WHERE \"Current\".\"rn\" = 1\n)\nSELECT \n    <%=sourceSystem%> \n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 6) \n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 20, 4)                                           AS \"ObjectID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" \n        || '::' || \"CDPOS\".\"TABNAME\" || '::' || \"CDPOS\".\"FNAME\"\n        || '::' || \"CDPOS\".\"CHANGENR\" || '::' || \"CDPOS\".\"CHNGIND\"                                  AS \"ID\",\n    CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE),\n        \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                                        AS \"Time\",\n    CASE\n        WHEN \"CDPOS\".\"FNAME\" = 'BMENG' THEN 'Quantity'\n        WHEN \"CDPOS\".\"FNAME\" = 'EDATU' AND COALESCE(CAST(\"SalesOrderScheduleLine_LookUp\".\"Value\" AS FLOAT), \"VBEP\".\"BMENG\") > 0 -- use \"VBEP\".\"BMENG\" as fall back if it has never been changed.\n            THEN 'ConfirmedDeliveryDate'\n        WHEN \"CDPOS\".\"FNAME\" = 'EDATU' THEN 'RequestedDeliveryDate'\n        WHEN \"CDPOS\".\"FNAME\" = 'MBDAT' THEN 'MaterialAvailabilityDate'\n        WHEN \"CDPOS\".\"FNAME\" = 'WADAT' THEN 'GoodsIssueDate'\n        ELSE \"CDPOS\".\"FNAME\"\n    END                                                                     AS \"Attribute\",\n    CASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-'\n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\"\n    END                                                                     AS \"OldValue\",\n    CASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-'\n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n    END                                                                     AS \"NewValue\",\n    <%=sourceSystem%> || \"CDHDR\".\"MANDANT\" || '::' || \"CDHDR\".\"USERNAME\"    AS \"ChangedBy\",\n    \"CDHDR\".\"TCODE\"                                                         AS \"OperationType\",\n    \"CDHDR\".\"CHANGENR\"                                                      AS \"OperationID\",\n    CASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                     AS \"ExecutionType\"\nFROM \"VBEP\" AS \"VBEP\"\nLEFT JOIN \"CDPOS\" AS \"CDPOS\"\n    ON \"VBEP\".\"MANDT\" = \"CDPOS\".\"MANDANT\"\n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n        AND \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\" = \"CDPOS\".\"TABKEY\"\n        AND \"CDPOS\".\"FNAME\" IN ('BMENG', 'EDATU', 'MBDAT', 'WADAT')\nLEFT JOIN \"CDHDR\" AS \"CDHDR\"\n    ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n        AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n        AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n        AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\nLEFT JOIN \"CTE_SalesOrderScheduleLine_LookUp\" AS \"SalesOrderScheduleLine_LookUp\"\n    ON \"VBEP\".\"MANDT\" = \"SalesOrderScheduleLine_LookUp\".\"MANDANT\"\n        AND \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\"\n            = \"SalesOrderScheduleLine_LookUp\".\"TABKEY\"\n        AND CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR), SUBSTRING(\n            CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19)) AS TIMESTAMP)\n            > \"SalesOrderScheduleLine_LookUp\".\"StartDate\"\n        AND CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR), SUBSTRING(\n            CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19)) AS TIMESTAMP)\n            <= \"SalesOrderScheduleLine_LookUp\".\"EndDate\"\nLEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n            AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\nWHERE \"VBEP\".\"MANDT\" IS NOT NULL\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL"
                    },
                    {
                        "id": "DeletionRecreationVBEP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_CDPOS_CDHDR\" AS (\n    SELECT\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3) AS \"MANDT\",\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10) AS \"VBELN\",\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 16) AS \"POSNR\",\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 20, 4) AS \"TABKEY_4\",\n        \"CDPOS\".\"TABKEY\",\n        \"CDPOS\".\"TABNAME\",\n        \"CDPOS\".\"FNAME\",\n        \"CDPOS\".\"CHANGENR\",\n        \"CDPOS\".\"CHNGIND\",\n        \"CDPOS\".\"VALUE_OLD\",\n        \"CDPOS\".\"VALUE_NEW\",\n        \"CDHDR\".\"MANDANT\",\n        \"CDHDR\".\"USERNAME\",\n        \"CDHDR\".\"UTIME\",\n        \"CDHDR\".\"UDATE\",\n        \"CDHDR\".\"OBJECTCLAS\",\n        \"CDHDR\".\"OBJECTID\",\n        \"CDHDR\".\"TCODE\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n        LEFT JOIN \"CDHDR\" AS \"CDHDR\" ON \n            \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n    WHERE \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n    AND \"CDPOS\".\"TABNAME\" = 'VBEP' \n    AND \"CDPOS\".\"FNAME\" = 'KEY'\n    AND \"CDPOS\".\"CHNGIND\" IN ('I', 'D')\n),\n\"CTE_VBEP_CREATION\" AS (\n    SELECT \n        <%=sourceSystem%> \n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) \n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 20, 4)                                         AS \"ObjectID\",\n\t    <%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"TABKEY\" || '::' || \"CDPOS_CDHDR\".\"TABNAME\" || '::' || \n            \"CDPOS_CDHDR\".\"FNAME\" || '::' || \"CDPOS_CDHDR\".\"CHANGENR\" || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"            AS \"ID\",\n        CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n        \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                                      AS \"Time\",\n        <%=sourceSystem%> || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"                      AS \"ChangedBy\",\n        \"CDPOS_CDHDR\".\"TCODE\"                                                                           AS \"OperationType\",\n        \"CDPOS_CDHDR\".\"CHANGENR\"                                                                        AS \"OperationID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                                   AS \"ExecutionType\",\n        -- A schedule line can be deleted and recreated with the same line number. Here we assign a row number\n        -- to each insertion of a line with the same line number, the most recent insertion has row number 1.\n        ROW_NUMBER() OVER (\n            PARTITION BY \"CDPOS_CDHDR\".\"TABKEY\", \"CDPOS_CDHDR\".\"CHNGIND\"\n            ORDER BY\n                CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, COALESCE(CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE), CAST('1900-01-01 23:59:59' AS DATE)),\n                COALESCE(\"CDPOS_CDHDR\".\"UTIME\", CAST('1900-01-01 23:59:59' AS TIMESTAMP))) AS INTERVAL SECOND) DESC\n        )                                                                               AS \"rn_desc\"\n    FROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                AND \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n    WHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS_CDHDR\".\"FNAME\" = 'KEY'\n        AND \"CDPOS_CDHDR\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'I'\n)\n-- Deletions\nSELECT \n    <%=sourceSystem%> \n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) \n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 20, 4)                                         AS \"ObjectID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"TABKEY\" || '::' || \"CDPOS_CDHDR\".\"TABNAME\" || '::' || \n        \"CDPOS_CDHDR\".\"FNAME\" || '::' || \"CDPOS_CDHDR\".\"CHANGENR\" || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"            AS \"ID\",\n        CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n        \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                                  AS \"Time\",\n        'Deleted'                                                                             AS \"Attribute\",\n        LTRIM(\"CDPOS_CDHDR\".\"VALUE_OLD\")                                                            AS \"OldValue\",\n        LTRIM(\"CDPOS_CDHDR\".\"VALUE_NEW\")                                                            AS \"NewValue\",\n        <%=sourceSystem%> || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"                  AS \"ChangedBy\",\n        \"CDPOS_CDHDR\".\"TCODE\"                                                                       AS \"OperationType\",\n        \"CDPOS_CDHDR\".\"CHANGENR\"                                                                    AS \"OperationID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                                   AS \"ExecutionType\"\nFROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                AND \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\nWHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS_CDHDR\".\"FNAME\" = 'KEY'\n        AND \"CDPOS_CDHDR\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'D'    \nUNION ALL\n-- Creations (all but the latest creation)\nSELECT \n    \"VBEP_CREATION\".\"ObjectID\"                                                          AS \"ObjectID\",\n\t\"VBEP_CREATION\".\"ID\"                                                                AS \"ID\",\n    \"VBEP_CREATION\".\"Time\"                                                              AS \"Time\",\n    'Created'                                                                           AS \"Attribute\",\n    NULL                                                                                AS \"OldValue\",\n    NULL                                                                                AS \"NewValue\",\n    \"VBEP_CREATION\".\"ChangedBy\"                                                         AS \"ChangedBy\",\n    \"VBEP_CREATION\".\"OperationType\"                                                     AS \"OperationType\",\n    \"VBEP_CREATION\".\"OperationID\"                                                       AS \"OperationID\",\n    \"VBEP_CREATION\".\"ExecutionType\"                                                     AS \"ExecutionType\"\nFROM \"CTE_VBEP_CREATION\" AS \"VBEP_CREATION\"\n-- capture all creations but the latest which is stored on the line from which the standard creation is derived\nWHERE \"VBEP_CREATION\".\"rn_desc\" > 1 "
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Material",
                    "MaterialMasterPlant",
                    "Plant",
                    "SalesOrder"
                ],
                "namespace": "custom",
                "property_names": [
                    "CancellationReason",
                    "ConfirmedDeliveryDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "ExternalMaterialNumber",
                    "ID",
                    "IsCanceled",
                    "LineNumber",
                    "MaterialAvailabilityDate",
                    "NetAmount",
                    "NetLineWeight",
                    "NetUnitPrice",
                    "PlannedGoodsIssueDate",
                    "Quantity",
                    "QuantityUnit",
                    "RequestedDeliveryDate",
                    "SalesOrderNumber",
                    "SourceSystemInstance",
                    "WeightUnit"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH CTE_VBEP_CREATION AS (\n    SELECT\n        \"CDPOS\".\"TABKEY\"                                                                AS \"ID\",\n        CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                        AS \"Time\",\n        \"CDHDR\".\"MANDANT\" || '::' || \"CDHDR\".\"USERNAME\"                                 AS \"User\",\n        \"CDPOS\".\"CHNGIND\"                                                               AS \"ChangeType\",\n        CASE        \n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'     \n            ELSE 'Manual'\n        END                                                                             AS \"ExecutionType\",\n        -- A schedule line can be deleted and recreated with the same line number. Here we assign a row number\n        -- to each insertion of a line with the same line number, the most recent insertion has row number 1.\n        ROW_NUMBER() OVER (\n            PARTITION BY \"CDPOS\".\"TABKEY\", \"CDPOS\".\"CHNGIND\"\n            ORDER BY\n                CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, COALESCE(CAST(\"CDHDR\".\"UTIME\" AS DATE), CAST('1900-01-01 23:59:59' AS DATE)),\n                COALESCE(\"CDHDR\".\"UTIME\", CAST('1900-01-01 23:59:59' AS TIMESTAMP))) AS INTERVAL SECOND) DESC\n        )                                                                               AS \"rn_desc\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n        LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n            ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n    WHERE \"CDPOS\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS\".\"FNAME\" = 'KEY'\n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS\".\"CHNGIND\" = 'I'\n    ORDER BY \"ID\", \"rn_desc\"\n), \nCTE_REQUESTED_DATE AS (\n    SELECT\n        \"VBEP\".\"MANDT\",\n        \"VBEP\".\"VBELN\",\n        \"VBEP\".\"POSNR\",\n        \"VBEP\".\"ETENR\",\n        -- To get the actual requested date for each line we check for each line if the date is a requested date by\n        -- checking for requested quantity > 0. If the requested quantity for a schedule line date is 0, it is not \n        -- a requested date and we set it to NULL. LAST_VALUE with IGNORE NULLS then gets the date from the latest\n        -- row where the requested quantity > 0 as the requested date. \n        -- Note: This logic does not cover the case where schedule lines cannot be confirmed between the requested dates\n        -- of the indivudal schedule lines. This requires a matching within the schedule line table. \n        LAST_VALUE(\n            CASE\n                WHEN \"VBEP\".\"WMENG\" > 0 THEN \"VBEP\".\"EDATU\"                                   \n            END) IGNORE NULLS OVER \"w\" AS \"RequestedDeliveryDate\"\n    FROM \"VBEP\" AS \"VBEP\"\n    WINDOW \"w\" AS (PARTITION BY \"VBEP\".\"MANDT\", \"VBEP\".\"VBELN\", \"VBEP\".\"POSNR\" ORDER BY \"VBEP\".\"EDATU\", \"VBEP\".\"ETENR\" ASC)\n),\n\"CTE_VBAP_VBEP\" AS (\n        SELECT\n                \"VBAP\".\"MANDT\",\n                \"VBAP\".\"VBELN\",\n                \"VBAP\".\"POSNR\",\n                \"VBAP\".\"ERDAT\",\n                \"VBAP\".\"ERZET\",\n                \"VBAP\".\"NETWR\",\n                \"VBAP\".\"KWMENG\",\n                \"VBAP\".\"WAERK\",\n                \"VBAP\".\"NETPR\",\n                \"VBAP\".\"KPEIN\",\n                \"VBAP\".\"GEWEI\",\n                \"VBAP\".\"NTGEW\",\n                \"VBAP\".\"VRKME\",\n                \"VBAP\".\"KDMAT\",\n                \"VBAP\".\"ABGRU\",\n                \"VBAP\".\"ERNAM\",\n                \"VBAP\".\"MATNR\",\n                \"VBAP\".\"WERKS\",\n                \"VBAP\".\"PSTYV\",\n                \"VBEP\".\"ETENR\",\n                \"VBEP\".\"BMENG\",\n                \"VBEP\".\"WMENG\",\n                \"VBEP\".\"EDATU\",\n                \"VBEP\".\"MBDAT\",\n                \"VBEP\".\"WADAT\",\n                \"VBAP\".\"ROUTE\"\n    FROM \"VBAP\" AS \"VBAP\"\n        LEFT JOIN \"VBEP\" AS \"VBEP\" ON \n            \"VBAP\".\"MANDT\" = \"VBEP\".\"MANDT\"\n            AND \"VBAP\".\"VBELN\" = \"VBEP\".\"VBELN\" \n            AND \"VBAP\".\"POSNR\" = \"VBEP\".\"POSNR\" \n            AND \"VBEP\".\"BMENG\" > 0\n    ORDER BY 1,2\n)\nSELECT\n    <%=sourceSystem%>  || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"VBELN\" || '::' || \"VBAP_VBEP\".\"POSNR\" || COALESCE('::' || \"VBAP_VBEP\".\"ETENR\", '')      AS \"ID\",\n    COALESCE(\n        \"CTE_VBEP_CREATION\".\"Time\",\n        CAST(\"VBAP_VBEP\".\"ERDAT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"VBAP_VBEP\".\"ERZET\" AS DATE), \"VBAP_VBEP\".\"ERZET\")AS INTERVAL SECOND)\n    )                                                                                                                                             AS \"CreationTime\",\n    COALESCE(\n        \"CTE_VBEP_CREATION\".\"ExecutionType\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END\n    )                                                                                                                                             AS \"CreationExecutionType\",\n    \"VBAP_VBEP\".\"NETWR\" * COALESCE(\"VBAP_VBEP\".\"BMENG\", \"VBAP_VBEP\".\"KWMENG\") / \"VBAP_VBEP\".\"KWMENG\"                                                                  AS \"NetAmount\",\n    \"VBAP_VBEP\".\"WAERK\"                                                                                                                                AS \"Currency\",\n    \"VBAP_VBEP\".\"NETPR\" / COALESCE(\"VBAP_VBEP\".\"KPEIN\", 1)                                                                                                  AS \"NetUnitPrice\",\n    <%=sourceSystem%>  || '::' || \"VBAP_VBEP\".\"MANDT\"                                                                                                  AS \"SourceSystemInstance\",\n    \"VBAP_VBEP\".\"VBELN\"                                                                                                                                AS \"SalesOrderNumber\",\n    \"VBAP_VBEP\".\"POSNR\" || COALESCE('/' || \"VBAP_VBEP\".\"ETENR\", '')                                                                                         AS \"LineNumber\",\n    \"VBAP_VBEP\".\"GEWEI\"                                                                                                                                AS \"WeightUnit\",\n    \"VBAP_VBEP\".\"NTGEW\" * COALESCE(\"VBAP_VBEP\".\"BMENG\", \"VBAP_VBEP\".\"KWMENG\") / \"VBAP_VBEP\".\"KWMENG\"                                                                  AS \"NetLineWeight\",\n    COALESCE(\"VBAP_VBEP\".\"BMENG\", \"VBAP_VBEP\".\"KWMENG\")                                                                                                     AS \"Quantity\",\n    \"VBAP_VBEP\".\"VRKME\"                                                                                                                                AS \"QuantityUnit\",\n    COALESCE(\n        CAST(\"CTE_REQUESTED_DATE\".\"RequestedDeliveryDate\" AS TIMESTAMP),\n        CAST(\"VBAK\".\"VDATU\" AS TIMESTAMP)\n    )                                                                                                                                             AS \"RequestedDeliveryDate\",\n    CAST(\"VBAP_VBEP\".\"EDATU\" AS TIMESTAMP)                                                                                                             AS \"ConfirmedDeliveryDate\",\n    CAST(\"VBAP_VBEP\".\"MBDAT\" AS TIMESTAMP)                                                                                                             AS \"MaterialAvailabilityDate\",\n    CAST(\"VBAP_VBEP\".\"WADAT\" AS TIMESTAMP)                                                                                                             AS \"PlannedGoodsIssueDate\",\n    \"VBAP_VBEP\".\"KDMAT\"                                                                                                                                AS \"ExternalMaterialNumber\",\n    \"VBAP_VBEP\".\"ABGRU\" || ' - ' || \"TVAGT\".\"BEZEI\"                                                                                                    AS \"CancellationReason\",\n    CASE WHEN NULLIF(\"VBAP_VBEP\".\"ABGRU\", '') IS NOT NULL THEN TRUE ELSE FALSE END                                                                     AS \"IsCanceled\",\n    -- Relationships\n    COALESCE(\"CTE_VBEP_CREATION\".\"User\", <%=sourceSystem%>  || '::' ||  \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"ERNAM\" )                                AS \"CreatedBy\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"VBELN\"                                                                         AS \"SalesOrder\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"MATNR\"                                                                         AS \"Material\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"WERKS\"                                                                         AS \"Plant\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"MATNR\" || '::' || \"VBAP_VBEP\".\"WERKS\"                                               AS \"MaterialMasterPlant\"\nFROM \"CTE_VBAP_VBEP\" AS \"VBAP_VBEP\"\nLEFT JOIN \"CTE_VBEP_CREATION\" AS \"CTE_VBEP_CREATION\"\n    ON \"CTE_VBEP_CREATION\".\"ID\" = \"VBAP_VBEP\".\"MANDT\"||\"VBAP_VBEP\".\"VBELN\"||\"VBAP_VBEP\".\"POSNR\"||\"VBAP_VBEP\".\"ETENR\"\n        AND \"CTE_VBEP_CREATION\".\"rn_desc\" = 1 -- we select the most recent schedule line if there are multiple with the same ETENR\nLEFT JOIN \"CTE_REQUESTED_DATE\" AS \"CTE_REQUESTED_DATE\" \n    ON \"VBAP_VBEP\".\"MANDT\" = \"CTE_REQUESTED_DATE\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"VBELN\" = \"CTE_REQUESTED_DATE\".\"VBELN\"\n       AND \"VBAP_VBEP\".\"POSNR\" = \"CTE_REQUESTED_DATE\".\"POSNR\"\n       AND \"VBAP_VBEP\".\"ETENR\" = \"CTE_REQUESTED_DATE\".\"ETENR\"\nLEFT JOIN \"VBAK\" AS \"VBAK\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nLEFT JOIN \"USR02\" AS \"USR02\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"USR02\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"ERNAM\" = \"USR02\".\"BNAME\"\nLEFT JOIN \"TVAPT\" AS \"TVAPT\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"TVAPT\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"PSTYV\" = \"TVAPT\".\"PSTYV\"\n       AND \"TVAPT\".\"SPRAS\" = <%=LanguageKey%>\nLEFT JOIN \"TVAGT\" AS \"TVAGT\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"TVAGT\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"ABGRU\" = \"TVAGT\".\"ABGRU\"\n       AND \"TVAGT\".\"SPRAS\" = <%=LanguageKey%>\nLEFT JOIN \"TVRO\" AS \"TVRO\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"TVRO\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"ROUTE\" = \"TVRO\".\"ROUTE\"\nWHERE \"VBAP_VBEP\".\"MANDT\" IS NOT NULL\n AND \"VBAK\".\"VBTYP\" IN ('C', 'I')"
                    }
                ],
                "relationship_transformations": [
                    {
                        "relationship_name": "GoodsIssue",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipGoodsIssue",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"   AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"MSEG\".\"MANDT\" || '::' || \"MSEG\".\"MBLNR\" || '::' || \"MSEG\".\"MJAHR\" || '::' || \"MSEG\".\"ZEILE\"   AS \"GoodsIssue\"\nFROM \"VBEP\" AS \"VBEP\"\nINNER JOIN \"MSEG\" AS \"MSEG\"\n    ON \"MSEG\".\"MANDT\" = \"VBEP\".\"MANDT\"\n        AND \"MSEG\".\"KDAUF\" = \"VBEP\".\"VBELN\"\n        AND \"MSEG\".\"KDPOS\" = \"VBEP\".\"POSNR\"\nLEFT JOIN \"VBAK\" AS \"VBAK\"\n    ON \"VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n        AND \"VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nWHERE \"VBAK\".\"VBTYP\" IN ('C', 'I')\nAND \"MSEG\".\"BWART\" IN (\n    '601',\n    '641',\n    '643',\n    '647',\n    '645',\n    '603',\n    '633',\n    '623',\n    '231'\n)"
                            }
                        ]
                    },
                    {
                        "relationship_name": "MaterialMovement",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipMaterialMovement",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"   AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"MSEG\".\"MANDT\" || '::' || \"MSEG\".\"MBLNR\" || '::' || \"MSEG\".\"MJAHR\" || '::' || \"MSEG\".\"ZEILE\"   AS \"MaterialMovement\"\nFROM \"VBEP\" AS \"VBEP\"\nINNER JOIN \"MSEG\" AS \"MSEG\"\n    ON \"MSEG\".\"MANDT\" = \"VBEP\".\"MANDT\"\n        AND \"MSEG\".\"KDAUF\" = \"VBEP\".\"VBELN\"\n        AND \"MSEG\".\"KDPOS\" = \"VBEP\".\"POSNR\"\nLEFT JOIN \"VBAK\" AS \"VBAK\"\n    ON \"VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n        AND \"VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nWHERE \"VBAK\".\"VBTYP\" IN ('C', 'I')"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "change_date": 1762188095402.0,
        "changed_by": {
            "id": "4d82ae0d-2047-4c83-ac8c-e2da04a3b5a0",
            "name": "Brave Gujral",
            "type_": "USER"
        },
        "created_by": {
            "id": "4d82ae0d-2047-4c83-ac8c-e2da04a3b5a0",
            "name": "Brave Gujral",
            "type_": "USER"
        },
        "creation_date": 1752249180512.0,
        "data_connection_id": "03736e95-3931-4eda-8dfe-fc16e11388bc",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderScheduleLine - OracleFusion",
        "draft": null,
        "factory_id": "85cef9bd-b933-4322-a9b0-d967623c7cae",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "languageKey",
                "value": "'US'"
            },
            {
                "name": "sourceSystem",
                "value": "'Oracle_Fusion'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "ConfirmedQtyConfirmedDelDate",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT  \n    <%=sourceSystem%> || '::' ||\"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\"                     AS \"ObjectID\",\n    <%=sourceSystem%> || '::' ||\"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\" || '_1_' \n        || \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" \n        || \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                 AS \"ID\",\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                        AS \"Time\",\n    CASE\n        WHEN \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'FulfillLineShippedQty' \n            THEN 'ConfirmedQuantity'\n        WHEN \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'FulfillLinePromiseArrivalDate'\n            THEN 'ConfirmedDeliveryDate'\n    END                                                                                     AS \"Attribute\",\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\"                                   AS \"OldValue\",\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\"                                   AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"USER\"           AS \"ChangedBy\",\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"TYPE\"                                        AS \"OperationType\",\n    NULL                                                                                    AS \"OperationID\",\n    CASE\n        WHEN \"DOO_FULFILL_LINES_ALL\".\"FulfillLineSourceOrderId\" IS NOT NULL\n            AND \"DOO_FULFILL_LINES_ALL\".\"FulfillLineSourceOrderId\" != '0'\n                THEN 'Automatic'\n        ELSE 'Manual'\n   END                                                                                      AS \"ExecutionType\"\nFROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_FulfillLineExtractPVO_CELONIS_CHANGELOG\" AS \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\"\n    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_FulfillLineExtractPVO\" AS \"DOO_FULFILL_LINES_ALL\"\n        ON \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"ID\" = \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\"\nWHERE \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\" IS NOT NULL\n    AND \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" IN ('FulfillLineShippedQty', 'FulfillLinePromiseArrivalDate')\n    AND \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"TYPE\" = 'update'"
                    },
                    {
                        "id": "MaterialAvailabilityDate",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT  \n    <%=sourceSystem%> || '::' || \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\"                                         AS \"ObjectID\",\n    <%=sourceSystem%> || '::' || \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\" || '_2_' || \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" ||\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                                             AS \"ID\",\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                                             AS \"Time\",\n    CASE\n        WHEN \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'FulfillLinePromiseArrivalDate'\n            THEN 'MaterialAvailabilityDate'\n    END                                                                                                          AS \"Attribute\",\n    CAST(TIMESTAMPADD(DAY, CAST(\"MTL_SYSTEM_ITEMS_B\".\"ItemBasePEOPlanningTimeFenceDays\" AS INT) * -1,\n    CAST(\"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" AS TIMESTAMP)) AS VARCHAR(255)) AS \"OldValue\",\n    CAST(TIMESTAMPADD(DAY, CAST(\"MTL_SYSTEM_ITEMS_B\".\"ItemBasePEOPlanningTimeFenceDays\" AS INT) * -1,\n    CAST(\"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" AS TIMESTAMP)) AS VARCHAR(255)) AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"USER\"                                AS \"ChangedBy\",\n    \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"TYPE\"                                                             AS \"OperationType\",\n    NULL                                                                                                         AS \"OperationID\",\n    CASE\n        WHEN \"DOO_FULFILL_LINES_ALL\".\"FulfillLineSourceOrderId\" IS NOT NULL\n            AND \"DOO_FULFILL_LINES_ALL\".\"FulfillLineSourceOrderId\" != '0'\n                THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                                                          AS \"ExecutionType\"\nFROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_FulfillLineExtractPVO_CELONIS_CHANGELOG\" AS \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\"\n    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_FulfillLineExtractPVO\" AS \"DOO_FULFILL_LINES_ALL\"\n        ON \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"ID\" = \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\"\n    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_EgpBiccExtractAM_ItemExtractPVO\" AS \"MTL_SYSTEM_ITEMS_B\"\n        ON \"DOO_FULFILL_LINES_ALL\".\"FulfillLineInventoryItemId\" = \"MTL_SYSTEM_ITEMS_B\".\"ItemBasePEOInventoryItemId\"\n            AND \"DOO_FULFILL_LINES_ALL\".\"FulfillLineInventoryOrganizationId\" = \"MTL_SYSTEM_ITEMS_B\".\"ItemBasePEOOrganizationId\"\nWHERE \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\" IS NOT NULL\n    AND \"MTL_SYSTEM_ITEMS_B\".\"ItemBasePEOInventoryItemId\" IS NOT NULL\n    AND \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'FulfillLinePromiseArrivalDate'\n    AND \"DOO_FULFILL_LINES_ALL_CELONIS_CHANGELOG\".\"TYPE\" = 'update'"
                    },
                    {
                        "id": "OrdQtyNetUnitPriceRejectionReason",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_SO_ITEM_CHANGES\" AS (\n    SELECT \n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"ID\"        AS \"Object_ID\",\n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\"    AS \"COLUMN\",\n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"DATE\"      AS \"DATE\",\n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"TYPE\"      AS \"TYPE\",\n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" AS \"OLD_VALUE\",\n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" AS \"NEW_VALUE\",\n        \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"USER\"      AS \"USER\"\n    FROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_LineExtractPVO_CELONIS_CHANGELOG\" AS \"DOO_LINES_ALL_CELONIS_CHANGELOG\"\n    WHERE \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" IN\n        ('LineUnitSellingPrice', 'LineOrderedQty', 'LineInventoryItemId',\n        'LineInventoryOrganizationId')\n        AND \"DOO_LINES_ALL_CELONIS_CHANGELOG\".\"TYPE\" = 'update'\n            UNION ALL\n                SELECT CAST(\n                    \"DOO_LINES_ALL\".\"LineId\" AS VARCHAR)            AS \"Object_ID\",\n                    \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"COLUMN\"    AS \"COLUMN\",\n                    \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"DATE\"      AS \"DATE\",\n                    \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"TYPE\"      AS \"TYPE\",\n                    \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" AS \"OLD_VALUE\",\n                    \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" AS \"NEW_VALUE\",\n                    \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"USER\"      AS \"USER\"\n                FROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_HeaderExtractPVO_CELONIS_CHANGELOG\" AS \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\"\n                    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_HeaderExtractPVO\" AS \"DOO_HEADERS_ALL\"\n                        ON \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"ID\" = \"DOO_HEADERS_ALL\".\"HeaderId\"\n                    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_LineExtractPVO\" AS \"DOO_LINES_ALL\"\n                        ON \"DOO_HEADERS_ALL\".\"HeaderId\" = \"DOO_LINES_ALL\".\"LineHeaderId\"\n                WHERE \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'HeaderCancelReasonCode'\n                    AND \"DOO_HEADERS_ALL_CELONIS_CHANGELOG\".\"TYPE\" = 'update'\n)\nSELECT  \n    <%=sourceSystem%> || '::' ||  \"DOO_LINES_ALL\".\"LineId\"             AS \"ObjectID\",\n    <%=sourceSystem%> || '::' || \"DOO_LINES_ALL\".\"LineId\" || '_1_' ||\n    \"SO_ITEM_CHANGES\".\"COLUMN\" ||\n    \"SO_ITEM_CHANGES\".\"DATE\"                                           AS \"ID\",\n    \"SO_ITEM_CHANGES\".\"DATE\"                                           AS \"Time\",\n    CASE\n        WHEN \"SO_ITEM_CHANGES\".\"COLUMN\" = 'LineUnitSellingPrice' \n            THEN 'NetUnitPrice'\n        WHEN \"SO_ITEM_CHANGES\".\"COLUMN\" = 'LineOrderedQty' \n            THEN 'Quantity'\n        WHEN \"SO_ITEM_CHANGES\".\"COLUMN\" = 'LineInventoryItemId' \n            THEN 'MaterialNumber'\n        WHEN \"SO_ITEM_CHANGES\".\"COLUMN\" = 'LineInventoryOrganizationId' \n            THEN 'Plant'\n        WHEN \"SO_ITEM_CHANGES\".\"COLUMN\" = 'HeaderCancelReasonCode' \n            THEN 'RejectionReason'\n    END                                                                AS \"Attribute\",\n    \"SO_ITEM_CHANGES\".\"OLD_VALUE\"                                      AS \"OldValue\",\n    \"SO_ITEM_CHANGES\".\"NEW_VALUE\"                                      AS \"NewValue\",\n    <%=sourceSystem%> || '::' ||  \"SO_ITEM_CHANGES\".\"USER\"             AS \"ChangedBy\",\n    \"SO_ITEM_CHANGES\".\"TYPE\"                                           AS \"OperationType\",\n    NULL                                                               AS \"OperationID\",\n    CASE\n        WHEN \"DOO_LINES_ALL\".\"LineSourceOrderId\" IS NOT NULL\n            AND \"DOO_LINES_ALL\".\"LineSourceOrderId\" != '0'\n        THEN 'Automatic'\n           ELSE 'Manual'\n    END                                                                AS \"ExecutionType\"\nFROM \"CTE_SO_ITEM_CHANGES\" AS \"SO_ITEM_CHANGES\"\n    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_LineExtractPVO\" AS \"DOO_LINES_ALL\"\n        ON \"SO_ITEM_CHANGES\".\"Object_ID\" = \"DOO_LINES_ALL\".\"LineId\"\nWHERE \"DOO_LINES_ALL\".\"LineId\" IS NOT NULL"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Material",
                    "MaterialMasterPlant",
                    "Plant",
                    "SalesOrder"
                ],
                "namespace": "custom",
                "property_names": [
                    "CancellationReason",
                    "ConfirmedDeliveryDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "ExternalMaterialNumber",
                    "ID",
                    "IsCanceled",
                    "LineNumber",
                    "MaterialAvailabilityDate",
                    "NetAmount",
                    "NetLineWeight",
                    "NetUnitPrice",
                    "PlannedGoodsIssueDate",
                    "Quantity",
                    "QuantityUnit",
                    "RequestedDeliveryDate",
                    "SalesOrderNumber",
                    "SourceSystemInstance",
                    "WeightUnit"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_WSH_DELIVERY_DETAILS\" AS (\n    SELECT \n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineLineId\"                          AS \"SourceLineId\",\n        SUM(\"WSH_DELIVERY_DETAILS\".\"DeliveryLinePEOGrossWeight\")             AS \"GrossWeight\"\n    FROM \"FscmTopModelAM_ScmExtractAM_WshBiccExtractAM_DeliveryLineExtractPVO\" AS \"WSH_DELIVERY_DETAILS\"\n        LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_FulfillLineExtractPVO\" AS \"DOO_FULFILL_LINES_ALL\"\n            ON \"WSH_DELIVERY_DETAILS\".\"DeliveryLinePEOSourceShipmentId\" = \"DOO_FULFILL_LINES_ALL\".\"FulfillLineId\"\n    GROUP BY \"DOO_FULFILL_LINES_ALL\".\"FulfillLineLineId\"\n),\n\"CTE_FULFILL_DETAILS\" AS (\n    SELECT \n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineLineId\"                               AS \"FulfillLineLineId\",\n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineInvoiceInterfacedFlag\"                AS \"FulfillLineInvoiceInterfacedFlag\",\n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineShippableFlag\"                        AS \"FulfillLineShippableFlag\",\n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineRequestShipDate\"                      AS \"FulfillLineRequestShipDate\",\n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLinePromiseArrivalDate\"                   AS \"FulfillLinePromiseArrivalDate\",\n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineScheduleShipDate\"                     AS \"FulfillLineScheduleShipDate\",\n        \"DOO_FULFILL_LINES_ALL\".\"FulfillLineScheduleArrivalDate\"                  AS \"FulfillLineScheduleArrivalDate\",\n        ROW_NUMBER()\n            OVER (PARTITION BY \"DOO_FULFILL_LINES_ALL\".\"FulfillLineLineId\"\n            ORDER BY \"DOO_FULFILL_LINES_ALL\".\"FulfillLineCreationDate\" DESC)      AS \"RN\"\n    FROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_FulfillLineExtractPVO\" AS \"DOO_FULFILL_LINES_ALL\"\n)\nSELECT  \n    <%=sourceSystem%> || '::' || \"DOO_LINES_ALL\".\"LineId\"                                       AS \"ID\",\n    \"DOO_LINES_ALL\".\"LineCreationDate\"                                                          AS \"CreationTime\",\n    CASE\n        WHEN \"DOO_LINES_ALL\".\"LineSourceOrderId\" IS NOT NULL\n            AND \"DOO_LINES_ALL\".\"LineSourceOrderId\" != '0'\n            THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                                          AS \"CreationExecutionType\",\n    CASE\n        WHEN \"DOO_LINES_ALL\".\"LineCanceledFlag\" = 'Y'\n            THEN \"DOO_LINES_ALL\".\"LineCanceledQty\" * \"DOO_LINES_ALL\".\"LineUnitSellingPrice\"\n        ELSE \"DOO_LINES_ALL\".\"LineOrderedQty\" * \"DOO_LINES_ALL\".\"LineUnitSellingPrice\"\n    END                                                                                          AS \"NetAmount\",\n    CASE \n        WHEN \"DOO_LINES_ALL\".\"LineCanceledFlag\" = 'Y' \n            THEN TRUE \n        ELSE FALSE \n    END                                                                                          AS \"IsCanceled\",\n    \"FULFILL_DETAILS\".\"FulfillLineRequestShipDate\"                                               AS \"RequestedDeliveryDate\",\n    \"FULFILL_DETAILS\".\"FulfillLineScheduleShipDate\"                                              AS \"PlannedGoodsIssueDate\",\n    TIMESTAMPADD(DAY, CAST(\"EGP_SYSTEM_ITEMS_B\".\"ItemBasePEOPlanningTimeFenceDays\" AS INT) * -1,\n        \"FULFILL_DETAILS\".\"FulfillLinePromiseArrivalDate\")                                       AS \"MaterialAvailabilityDate\",\n    \"FULFILL_DETAILS\".\"FulfillLinePromiseArrivalDate\"                                            AS \"ConfirmedDeliveryDate\",\n    \"DOO_HEADERS_ALL\".\"HeaderTransactionalCurrencyCode\"                                          AS \"Currency\",\n    \"DOO_LINES_ALL\".\"LineUnitSellingPrice\"                                                       AS \"NetUnitPrice\",\n    CASE\n        WHEN \"DOO_LINES_ALL\".\"LineCanceledFlag\" = 'Y'\n            THEN \"DOO_HEADERS_ALL\".\"HeaderCancelReasonCode\"\n    END                                                                                          AS \"CancellationReason\",\n    <%=sourceSystem%>                                                                            AS \"SourceSystemInstance\",\n    CAST(\"DOO_HEADERS_ALL\".\"HeaderOrderNumber\" AS VARCHAR(255))                                  AS \"SalesOrderNumber\",\n    CAST(\"DOO_LINES_ALL\".\"LineLineNumber\" AS VARCHAR(255))                                       AS \"LineNumber\",\n    \"EGP_SYSTEM_ITEMS_B\".\"ItemBasePEOWeightUomCode\"                                              AS \"WeightUnit\",\n    \"EGP_SYSTEM_ITEMS_B\".\"ItemBasePEOUnitWeight\"                                                 AS \"NetLineWeight\",\n    <%=sourceSystem%> || '::' || \"DOO_LINES_ALL\".\"LineInventoryItemId\"                           AS \"Material\",\n    <%=sourceSystem%> || '::' || \"DOO_LINES_ALL\".\"LineInventoryOrganizationId\" \n    || '::' || \"DOO_LINES_ALL\".\"LineInventoryItemId\"                                             AS \"MaterialMasterPlant\",\n    <%=sourceSystem%> || '::' ||\"DOO_LINES_ALL\".\"LineInventoryOrganizationId\"                    AS \"Plant\",\n    <%=sourceSystem%> || '::' || \"DOO_HEADERS_ALL\".\"HeaderId\"                                    AS \"SalesOrder\",\n    <%=sourceSystem%> || '::' || \"DOO_LINES_ALL\".\"LineCreatedBy\"                                 AS \"CreatedBy\",\n    \"DOO_LINES_ALL\".\"LineOrderedQty\"                                                             AS \"Quantity\",\n    \"DOO_LINES_ALL\".\"LineOrderedUom\"                                                             AS \"QuantityUnit\",\n    \"EGP_SYSTEM_ITEMS_B\".\"ItemBasePEOItemNumber\"                                                 AS \"ExternalMaterialNumber\"\nFROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_LineExtractPVO\" AS \"DOO_LINES_ALL\"\n    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_HeaderExtractPVO\" AS \"DOO_HEADERS_ALL\"\n        ON \"DOO_LINES_ALL\".\"LineHeaderId\" = \"DOO_HEADERS_ALL\".\"HeaderId\"\n    LEFT JOIN \"CTE_FULFILL_DETAILS\" AS \"FULFILL_DETAILS\"\n        ON \"DOO_LINES_ALL\".\"LineId\" = \"FULFILL_DETAILS\".\"FulfillLineLineId\"\n            AND \"FULFILL_DETAILS\".\"RN\" = 1\n    LEFT JOIN \"FscmTopModelAM_ScmExtractAM_EgpBiccExtractAM_ItemExtractPVO\" AS \"EGP_SYSTEM_ITEMS_B\"\n        ON \"DOO_LINES_ALL\".\"LineInventoryItemId\" = \"EGP_SYSTEM_ITEMS_B\".\"ItemBasePEOInventoryItemId\"\n            AND \"DOO_LINES_ALL\".\"LineInventoryOrganizationId\" = \"EGP_SYSTEM_ITEMS_B\".\"ItemBasePEOOrganizationId\"\n    LEFT JOIN \"CTE_WSH_DELIVERY_DETAILS\" AS \"WSH_DELIVERY_DETAILS\"\n        ON \"DOO_LINES_ALL\".\"LineId\" = \"WSH_DELIVERY_DETAILS\".\"SourceLineId\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_AnalyticsExtractServiceAM_LookupValuesTLExtractPVO\" AS \"FND_LOOKUP_VALUES_C\"\n        ON \"DOO_HEADERS_ALL\".\"HeaderCancelReasonCode\" = \"FND_LOOKUP_VALUES_C\".\"LookupCode\"\n            AND \"FND_LOOKUP_VALUES_C\".\"LookupType\" = 'DOO_RETURN_REASON'\n            AND \"FND_LOOKUP_VALUES_C\".\"ViewApplicationId\" = '0'\n            AND \"FND_LOOKUP_VALUES_C\".\"Language\" = <%=languageKey%>\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_AnalyticsExtractServiceAM_LookupValuesTLExtractPVO\" AS \"FND_LOOKUP_VALUES\"\n        ON \"DOO_LINES_ALL\".\"LineItemTypeCode\" = \"FND_LOOKUP_VALUES\".\"LookupCode\"\n            AND \"FND_LOOKUP_VALUES\".\"LookupType\" = 'EGP_BOM_ITEM_TYPE'\n            AND \"FND_LOOKUP_VALUES\".\"ViewApplicationId\" = '0'\n            AND \"FND_LOOKUP_VALUES\".\"Language\" = <%=languageKey%>\nWHERE \"DOO_LINES_ALL\".\"LineCategoryCode\" = 'ORDER'\n"
                    }
                ],
                "relationship_transformations": [
                    {
                        "relationship_name": "GoodsIssue",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipGoodsIssue",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::' || CAST(\"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionId\" AS VARCHAR(255)) AS \"GoodsIssue\",\n    <%=sourceSystem%> || '::' || \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOSourceLineId\"                        AS \"ID\"\nFROM \"FscmTopModelAM_ScmExtractAM_InvBiccExtractAM_InventoryTransactionDetailExtractPVO\" AS \"MTL_MATERIAL_TRANSACTIONS\"\nWHERE\n    (   \n        \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionTypeId\" = '33'\n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionActionId\" = '1'\n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionSourceTypeId\" = '2'\n    )  \n    OR\n    (\n        \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionTypeId\" = '34'\n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionActionId\" = '1'\n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionSourceTypeId\" = '8'\n    )\n    AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOSourceLineId\" IS NOT NULL"
                            }
                        ]
                    },
                    {
                        "relationship_name": "MaterialMovement",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipMaterialMovement",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::' || CAST(\"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionId\" AS VARCHAR(255)) AS \"MaterialMovement\",\n    <%=sourceSystem%> || '::' || \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOSourceLineId\"                        AS \"ID\"\nFROM \"FscmTopModelAM_ScmExtractAM_InvBiccExtractAM_InventoryTransactionDetailExtractPVO\" AS \"MTL_MATERIAL_TRANSACTIONS\"\nWHERE \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionTypeId\" IN ('33', '34', '37')\n  AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionActionId\" ='1'\n  AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOTransactionSourceTypeId\" IN ('2', '8', '12')\n  AND \"MTL_MATERIAL_TRANSACTIONS\".\"InventoryTransactionPEOSourceLineId\" IS NOT NULL"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "change_date": 1760359170216.0,
        "changed_by": {
            "id": "4d82ae0d-2047-4c83-ac8c-e2da04a3b5a0",
            "name": "Brave Gujral",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749630819669.0,
        "data_connection_id": "42d53587-d7fa-45cf-8403-26770d8029d0",
        "description": "",
        "disabled": null,
        "display_name": "SalesOrderScheduleLine transformation - 00. Central Extraction Pool_Oracle-ebs - 1",
        "draft": null,
        "factory_id": "5029ddf1-767e-4ee2-9a96-cd42f5abbbcb",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "languageKey",
                "value": "'US'"
            },
            {
                "name": "sourceSystem",
                "value": "'Oracle_EBS'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "CancellationViaFlag",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\" AS (\n        SELECT\n            \"OE_ORDER_LINES_HISTORY\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_HISTORY\".\"CANCELLED_FLAG\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        UNION\n        SELECT\n            \"OE_ORDER_LINES_ALL\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n            TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\") AS \"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_ALL\".\"CANCELLED_FLAG\",\n            \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                           AS \"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                            AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n        WHERE EXISTS (SELECT\n                          1\n                      FROM \"OE_ORDER_LINES_HISTORY\"\n                      WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                            = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")\n),\n     \"CTE_Identify_Changes\"\n         AS (SELECT\n                    \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::5::'\n                    || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                    || \"CTE_Union_History_and_Present\".\"CANCELLED_FLAG\"                     AS \"ID\",\n                    \"CTE_Union_History_and_Present\".\"LINE_ID\"                               AS \"ObjectID\",\n                    \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                    AS \"Time\",\n                    CASE\n                        WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                             AND LAG(\"CTE_Union_History_and_Present\".\"CANCELLED_FLAG\") OVER \"w\"\n                             != \"CTE_Union_History_and_Present\".\"CANCELLED_FLAG\"\n                            THEN 'IsCanceled'\n                        END                                                                 AS \"Attribute\",\n                    LAG(\"CTE_Union_History_and_Present\".\"CANCELLED_FLAG\") OVER \"w\"          AS \"OldValue\",\n                    \"CTE_Union_History_and_Present\".\"CANCELLED_FLAG\"                        AS \"NewValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                    NULL                                                                    AS \"OperationType\",\n                    -- Identify a multi-select operation by the header, the creator, and the timestamp\n                    -- TODO: consider REQUEST_ID when available with higher prio\n                    \"CTE_Union_History_and_Present\".\"HEADER_ID\" || '::' || \n                        \"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" || '::' || \n                        \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                AS \"OperationID\",\n                    \"CTE_Union_History_and_Present\".\"ExecutionType\"                         AS \"ExecutionType\"\n             FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n             WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                     ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                         \"CTE_Union_History_and_Present\".\"CANCELLED_FLAG\"))\nSELECT\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                            AS \"ID\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"                      AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                                       AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                                  AS \"Attribute\",\n    CAST(FALSE AS VARCHAR(255))                                                     AS \"OldValue\",\n    CAST(TRUE AS VARCHAR(255))                                                      AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"                     AS \"ChangedBy\",\n    \"Identify_Changes\".\"OperationType\"                                              AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                                AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                              AS \"ExecutionType\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL\n    AND (\"Identify_Changes\".\"OldValue\" = 'N' OR \"Identify_Changes\".\"OldValue\" IS NULL)\n    AND \"Identify_Changes\".\"NewValue\" = 'Y'"
                    },
                    {
                        "id": "CancellationViaQuantity",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\"\n    AS (SELECT\n            \"OE_ORDER_LINES_HISTORY\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_HISTORY\".\"ORDERED_QUANTITY\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                   AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        UNION\n        SELECT\n            \"OE_ORDER_LINES_ALL\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n            TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\")         AS \"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_ALL\".\"ORDERED_QUANTITY\",\n            \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                                   AS \"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                    AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n        WHERE EXISTS (SELECT\n                        1\n                    FROM \"OE_ORDER_LINES_HISTORY\"\n                    WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                        = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")),\n    \"CTE_Identify_Changes\"\n        AS (SELECT\n                \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::5::'\n                || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                || \"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\"                AS \"ID\",\n                \"CTE_Union_History_and_Present\".\"LINE_ID\"                            AS \"ObjectID\",\n                \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                 AS \"Time\",\n                CASE\n                    WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                        AND LAG(\"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\") OVER \"w\"\n                        != \"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\"\n                        THEN 'IsCanceled'\n                    END                                                              AS \"Attribute\",\n                LAG(\"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\") OVER \"w\"               AS \"OldValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\" AS VARCHAR(255))       AS \"NewValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                CAST(NULL AS VARCHAR)                                                AS \"OperationType\",\n                CAST(NULL AS VARCHAR)                                                AS \"OperationID\",\n                \"CTE_Union_History_and_Present\".\"ExecutionType\"                      AS \"ExecutionType\"\n            FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n            WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                    \"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\"))\nSELECT\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                             AS \"ID\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"                       AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                                        AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                                   AS \"Attribute\",\n    CAST(FALSE AS VARCHAR(255))                                                      AS \"OldValue\",\n    CAST(TRUE AS VARCHAR(255))                                                       AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"                      AS \"ChangedBy\",\n    \"Identify_Changes\".\"OperationType\"                                               AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                                 AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                               AS \"ExecutionType\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL\n    AND \"Identify_Changes\".\"OldValue\" > 0\n    AND \"Identify_Changes\".\"NewValue\" = 0"
                    },
                    {
                        "id": "ConfirmedDeliveryDate",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\"\n         AS (SELECT DISTINCT \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"PROMISE_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n                             CASE\n                                 WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                                     AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                                     THEN 'Automatic'\n                                 ELSE 'Manual' END AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n             WHERE \"OE_ORDER_LINES_HISTORY\".\"SCHEDULE_STATUS_CODE\" = 'SCHEDULED'\n             UNION\n             SELECT \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n                    TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\") AS \"HIST_CREATION_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"PROMISE_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                           AS \"HIST_CREATED_BY\",\n                    CASE\n                        WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                            AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                            THEN 'Automatic'\n                        ELSE 'Manual' END                                            AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n             WHERE EXISTS (SELECT 1\n                          FROM \"OE_ORDER_LINES_HISTORY\"\n                          WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                                = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\"\n                            AND \"OE_ORDER_LINES_HISTORY\".\"SCHEDULE_STATUS_CODE\" = 'SCHEDULED')),\n     \"CTE_Identify_Changes\"\n         AS (SELECT \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::2::'\n                    || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                    || \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"                       AS \"ID\",\n                    \"CTE_Union_History_and_Present\".\"LINE_ID\"                               AS \"ObjectID\",\n                    \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                    AS \"Time\",\n                    CASE\n                        WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                             AND LAG(\"CTE_Union_History_and_Present\".\"PROMISE_DATE\") OVER \"w\"\n                             != \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"\n                            THEN 'ConfirmedDeliveryDate'\n                        END                                                                 AS \"Attribute\",\n                    LAG(\"CTE_Union_History_and_Present\".\"PROMISE_DATE\") OVER \"w\"            AS \"OldValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"PROMISE_DATE\" AS VARCHAR(255))    AS \"NewValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                    NULL                                                                    AS \"OperationType\",\n                    NULL                                                                    AS \"OperationID\",\n                    \"CTE_Union_History_and_Present\".\"ExecutionType\"                         AS \"ExecutionType\"\n             FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n             WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                     ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                         \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"))\nSELECT \n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"        AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"  AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                   AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                              AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))         AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                               AS \"NewValue\",\n    \"Identify_Changes\".\"OperationType\"                          AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                            AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                          AS \"ExecutionType\",\n     <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\" AS \"ChangedBy\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "GoodsIssueDate",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\"\n         AS (SELECT DISTINCT \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"SCHEDULE_SHIP_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n                             CASE\n                                 WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                                     AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                                     THEN 'Automatic'\n                                 ELSE 'Manual' END AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n             UNION\n             SELECT \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n                    TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\") AS \"HIST_CREATION_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"SCHEDULE_SHIP_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                           AS \"HIST_CREATED_BY\",\n                    CASE\n                        WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                            AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                            THEN 'Automatic'\n                        ELSE 'Manual' END                                            AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n             WHERE EXISTS (SELECT 1\n                          FROM \"OE_ORDER_LINES_HISTORY\"\n                          WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                                = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")\n    ),\n     \"CTE_Identify_Changes\"\n         AS (SELECT \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::10::'\n                    || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                    || \"CTE_Union_History_and_Present\".\"SCHEDULE_SHIP_DATE\"                       AS \"ID\",\n                    \"CTE_Union_History_and_Present\".\"LINE_ID\"                               AS \"ObjectID\",\n                    \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                    AS \"Time\",\n                    CASE\n                        WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                             AND LAG(\"CTE_Union_History_and_Present\".\"SCHEDULE_SHIP_DATE\") OVER \"w\"\n                             != \"CTE_Union_History_and_Present\".\"SCHEDULE_SHIP_DATE\"\n                            THEN 'GoodsIssueDate'\n                        END                                                                 AS \"Attribute\",\n                    LAG(\"CTE_Union_History_and_Present\".\"SCHEDULE_SHIP_DATE\") OVER \"w\"            AS \"OldValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"SCHEDULE_SHIP_DATE\" AS VARCHAR(255))    AS \"NewValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                    NULL                                                                    AS \"OperationType\",\n                    NULL                                                                    AS \"OperationID\",\n                    \"CTE_Union_History_and_Present\".\"ExecutionType\"                         AS \"ExecutionType\"\n             FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n             WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                     ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                         \"CTE_Union_History_and_Present\".\"SCHEDULE_SHIP_DATE\"))\nSELECT \n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"        AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"  AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                   AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                              AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))         AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                               AS \"NewValue\",\n    \"Identify_Changes\".\"OperationType\"                          AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                            AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                          AS \"ExecutionType\",\n     <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\" AS \"ChangedBy\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "MaterialAvailabilityDate",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\"\n         AS (SELECT DISTINCT \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"PROMISE_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"INVENTORY_ITEM_ID\",\n                             \"OE_ORDER_LINES_HISTORY\".\"ORG_ID\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n                             CASE\n                                 WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                                     AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                                     THEN 'Automatic'\n                                 ELSE 'Manual' END AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n             WHERE \"OE_ORDER_LINES_HISTORY\".\"SCHEDULE_STATUS_CODE\" = 'SCHEDULED'\n             UNION\n             SELECT \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n                    TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\") AS \"HIST_CREATION_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"PROMISE_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"INVENTORY_ITEM_ID\",\n                    \"OE_ORDER_LINES_ALL\".\"ORG_ID\",\n                    \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                           AS \"HIST_CREATED_BY\",\n                    CASE\n                        WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                            AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                            THEN 'Automatic'\n                        ELSE 'Manual' END                                            AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n             WHERE EXISTS (SELECT 1\n                          FROM \"OE_ORDER_LINES_HISTORY\"\n                          WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                                = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\"\n                            AND \"OE_ORDER_LINES_HISTORY\".\"SCHEDULE_STATUS_CODE\" = 'SCHEDULED')),\n     \"CTE_Identify_Changes\"\n         AS (SELECT \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::3::'\n                    || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                    || \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"                       AS \"ID\",\n                    \"CTE_Union_History_and_Present\".\"LINE_ID\"                               AS \"ObjectID\",\n                    \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                    AS \"Time\",\n                    CASE\n                        WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                             AND LAG(\"CTE_Union_History_and_Present\".\"PROMISE_DATE\") OVER \"w\"\n                             != \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"\n                            THEN 'MaterialAvailabilityDate'\n                        END                                                                 AS \"Attribute\",\n                    LAG(\"CTE_Union_History_and_Present\".\"PROMISE_DATE\") OVER \"w\"            AS \"OldValue\",\n                    \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"                          AS \"NewValue\",\n                    \"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\"                     AS \"INVENTORY_ITEM_ID\",\n                    \"CTE_Union_History_and_Present\".\"ORG_ID\"                                AS \"ORG_ID\",\n                    CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                    NULL                                                                    AS \"OperationType\",\n                    NULL                                                                    AS \"OperationID\",\n                    \"CTE_Union_History_and_Present\".\"ExecutionType\"                         AS \"ExecutionType\"\n             FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n             WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                     ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                         \"CTE_Union_History_and_Present\".\"PROMISE_DATE\"))\nSELECT \n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                   AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"             AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                              AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                         AS \"Attribute\",\n    CAST((TIMESTAMPADD(DAY, CAST(\"MTL_SYSTEM_ITEMS_B\".\"PLANNING_TIME_FENCE_DAYS\" AS INT) * -1,\n                        \"Identify_Changes\".\"OldValue\")) AS VARCHAR(255))   AS \"OldValue\",\n    CAST((TIMESTAMPADD(DAY, CAST(\"MTL_SYSTEM_ITEMS_B\".\"PLANNING_TIME_FENCE_DAYS\" AS INT) * -1,\n                        \"Identify_Changes\".\"NewValue\")) AS VARCHAR(255))   AS \"NewValue\",\n    \"Identify_Changes\".\"OperationType\"                                     AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                       AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                     AS \"ExecutionType\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"            AS \"ChangedBy\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\n         LEFT JOIN \"MTL_SYSTEM_ITEMS_B\" AS \"MTL_SYSTEM_ITEMS_B\"\n                   ON \"Identify_Changes\".\"INVENTORY_ITEM_ID\" = \"MTL_SYSTEM_ITEMS_B\".\"INVENTORY_ITEM_ID\"\n                       AND \"Identify_Changes\".\"ORG_ID\" = \"MTL_SYSTEM_ITEMS_B\".\"ORGANIZATION_ID\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "MaterialNumber",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\" AS (\n        SELECT\n            \"OE_ORDER_LINES_HISTORY\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_HISTORY\".\"INVENTORY_ITEM_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                   AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        UNION\n        SELECT\n            \"OE_ORDER_LINES_ALL\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n            TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\")         AS \"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_ALL\".\"INVENTORY_ITEM_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                                   AS \"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                    AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n        WHERE EXISTS (SELECT\n                        1\n                    FROM \"OE_ORDER_LINES_HISTORY\"\n                    WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                        = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")),\n    \"CTE_Identify_Changes\" AS (\n        SELECT\n                \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::7::'\n                || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                || \"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\"              AS \"ID\",\n                \"CTE_Union_History_and_Present\".\"LINE_ID\"                            AS \"ObjectID\",\n                \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                 AS \"Time\",\n                CASE\n                    WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                        AND LAG(\"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\") OVER \"w\"\n                        != \"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\"\n                        THEN 'MaterialNumber'\n                    END                                                              AS \"Attribute\",\n                LAG(\"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\") OVER \"w\"               AS \"OldValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\" AS VARCHAR(255))       AS \"NewValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                NULL                                                                 AS \"OperationType\",\n                NULL                                                                 AS \"OperationID\",\n                \"CTE_Union_History_and_Present\".\"ExecutionType\"                      AS \"ExecutionType\"\n        FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n            WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                    \"CTE_Union_History_and_Present\".\"INVENTORY_ITEM_ID\"))\nSELECT\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                             AS \"ID\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"                       AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                                        AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                                   AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))                              AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                                                    AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"                      AS \"ChangedBy\",\n    \"Identify_Changes\".\"OperationType\"                                               AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                                 AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                               AS \"ExecutionType\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "NetUnitPrice",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\"  AS (\n        SELECT\n            \"OE_ORDER_LINES_HISTORY\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_HISTORY\".\"UNIT_SELLING_PRICE\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                   AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        UNION\n        SELECT\n            \"OE_ORDER_LINES_ALL\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n            TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\")         AS \"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_ALL\".\"UNIT_SELLING_PRICE\",\n            \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                                   AS \"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                    AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n        WHERE EXISTS (SELECT\n                        1\n                    FROM \"OE_ORDER_LINES_HISTORY\"\n                    WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                        = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")\n),\n    \"CTE_Identify_Changes\" AS (\n           SELECT\n                \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::6::'\n                || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                || \"CTE_Union_History_and_Present\".\"UNIT_SELLING_PRICE\"              AS \"ID\",\n                \"CTE_Union_History_and_Present\".\"LINE_ID\"                            AS \"ObjectID\",\n                \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                 AS \"Time\",\n                CASE\n                    WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                        AND LAG(\"CTE_Union_History_and_Present\".\"UNIT_SELLING_PRICE\") OVER \"w\"\n                        != \"CTE_Union_History_and_Present\".\"UNIT_SELLING_PRICE\"\n                        THEN 'NetUnitPrice'\n                    END                                                              AS \"Attribute\",\n                LAG(\"CTE_Union_History_and_Present\".\"UNIT_SELLING_PRICE\") OVER \"w\"               AS \"OldValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"UNIT_SELLING_PRICE\" AS VARCHAR(255))       AS \"NewValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                NULL                                                                 AS \"OperationType\",\n                NULL                                                                 AS \"OperationID\",\n                \"CTE_Union_History_and_Present\".\"ExecutionType\"                      AS \"ExecutionType\"\n            FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n            WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                    \"CTE_Union_History_and_Present\".\"UNIT_SELLING_PRICE\")\n)\nSELECT\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                             AS \"ID\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"                       AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                                        AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                                   AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))                              AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                                                    AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"                      AS \"ChangedBy\",\n    \"Identify_Changes\".\"OperationType\"                                               AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                                 AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                               AS \"ExecutionType\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "Plant",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\" AS (\n        SELECT\n            \"OE_ORDER_LINES_HISTORY\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_HISTORY\".\"ORG_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                   AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        UNION\n        SELECT\n            \"OE_ORDER_LINES_ALL\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n            TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\")         AS \"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_ALL\".\"ORG_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                                   AS \"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                    AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n        WHERE EXISTS (SELECT\n                        1\n                    FROM \"OE_ORDER_LINES_HISTORY\"\n                    WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                        = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")),\n    \"CTE_Identify_Changes\" AS (\n            SELECT\n                \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::4::'\n                || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                || \"CTE_Union_History_and_Present\".\"ORG_ID\"                          AS \"ID\",\n                \"CTE_Union_History_and_Present\".\"LINE_ID\"                            AS \"ObjectID\",\n                \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                 AS \"Time\",\n                CASE\n                    WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                        AND LAG(\"CTE_Union_History_and_Present\".\"ORG_ID\") OVER \"w\"\n                        != \"CTE_Union_History_and_Present\".\"ORG_ID\"\n                        THEN 'Plant'\n                    END                                                              AS \"Attribute\",\n                LAG(\"CTE_Union_History_and_Present\".\"ORG_ID\") OVER \"w\"               AS \"OldValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"ORG_ID\" AS VARCHAR(255))       AS \"NewValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                NULL                                                                 AS \"OperationType\",\n                NULL                                                                 AS \"OperationID\",\n                \"CTE_Union_History_and_Present\".\"ExecutionType\"                      AS \"ExecutionType\"\n            FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n            WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                    \"CTE_Union_History_and_Present\".\"ORG_ID\"))\nSELECT\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                             AS \"ID\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"                       AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                                        AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                                   AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))                              AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                                                    AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"                      AS \"ChangedBy\",\n    \"Identify_Changes\".\"OperationType\"                                               AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                                 AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                               AS \"ExecutionType\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "Quantity",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\"  AS (\n        SELECT\n            \"OE_ORDER_LINES_HISTORY\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_HISTORY\".\"ORDERED_QUANTITY\",\n            \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                   AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        UNION\n        SELECT\n            \"OE_ORDER_LINES_ALL\".\"HEADER_ID\",\n            \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n            TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\")         AS \"HIST_CREATION_DATE\",\n            \"OE_ORDER_LINES_ALL\".\"ORDERED_QUANTITY\",\n            \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                                   AS \"HIST_CREATED_BY\",\n            CASE\n                WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                    AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                    THEN 'Automatic'\n                ELSE 'Manual' END                                                    AS \"ExecutionType\"\n        FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n        WHERE EXISTS (SELECT\n                        1\n                    FROM \"OE_ORDER_LINES_HISTORY\"\n                    WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                        = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")),\n    \"CTE_Identify_Changes\" AS (\n            SELECT\n                \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::8::'\n                || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                || \"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\"              AS \"ID\",\n                \"CTE_Union_History_and_Present\".\"LINE_ID\"                            AS \"ObjectID\",\n                \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                 AS \"Time\",\n                CASE\n                    WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                        AND LAG(\"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\") OVER \"w\"\n                        != \"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\"\n                        THEN 'Quantity'\n                    END                                                              AS \"Attribute\",\n                LAG(\"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\") OVER \"w\"               AS \"OldValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\" AS VARCHAR(255))       AS \"NewValue\",\n                CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                NULL                                                                 AS \"OperationType\",\n                NULL                                                                 AS \"OperationID\",\n                \"CTE_Union_History_and_Present\".\"ExecutionType\"                      AS \"ExecutionType\"\n            FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n            WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                    \"CTE_Union_History_and_Present\".\"ORDERED_QUANTITY\"))\nSELECT\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"                             AS \"ID\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"                       AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                                        AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                                                   AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))                              AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                                                    AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\"                      AS \"ChangedBy\",\n    \"Identify_Changes\".\"OperationType\"                                               AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                                                 AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                                               AS \"ExecutionType\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL\n    AND \"Identify_Changes\".\"NewValue\" > 0"
                    },
                    {
                        "id": "RequestedDeliveryDate",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Union_History_and_Present\" AS (\n             SELECT DISTINCT \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"REQUEST_DATE\",\n                             \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATED_BY\",\n                             CASE\n                                 WHEN \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                                     AND \"OE_ORDER_LINES_HISTORY\".\"ORDER_SOURCE_ID\" != '0'\n                                     THEN 'Automatic'\n                                 ELSE 'Manual' END AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n             UNION\n             SELECT \"OE_ORDER_LINES_ALL\".\"LINE_ID\",\n                    TIMESTAMPADD(SECOND, 2, \"OE_ORDER_LINES_ALL\".\"LAST_UPDATE_DATE\") AS \"HIST_CREATION_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"REQUEST_DATE\",\n                    \"OE_ORDER_LINES_ALL\".\"LAST_UPDATED_BY\"                           AS \"HIST_CREATED_BY\",\n                    CASE\n                        WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n                            AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n                            THEN 'Automatic'\n                        ELSE 'Manual' END                                            AS \"ExecutionType\"\n             FROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\n             WHERE EXISTS (SELECT 1\n                          FROM \"OE_ORDER_LINES_HISTORY\"\n                          WHERE \"OE_ORDER_LINES_ALL\".\"LINE_ID\"\n                                = \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\")\n),\n     \"CTE_Identify_Changes\" AS (\n             SELECT \"CTE_Union_History_and_Present\".\"LINE_ID\" || '::9::'\n                    || \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\" || '::'\n                    || \"CTE_Union_History_and_Present\".\"REQUEST_DATE\"                       AS \"ID\",\n                    \"CTE_Union_History_and_Present\".\"LINE_ID\"                               AS \"ObjectID\",\n                    \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\"                    AS \"Time\",\n                    CASE\n                        WHEN LAG(\"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\") OVER \"w\" IS NOT NULL\n                             AND LAG(\"CTE_Union_History_and_Present\".\"REQUEST_DATE\") OVER \"w\"\n                             != \"CTE_Union_History_and_Present\".\"REQUEST_DATE\"\n                            THEN 'RequestedDeliveryDate'\n                        END                                                                 AS \"Attribute\",\n                    LAG(\"CTE_Union_History_and_Present\".\"REQUEST_DATE\") OVER \"w\"            AS \"OldValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"REQUEST_DATE\" AS VARCHAR(255))    AS \"NewValue\",\n                    CAST(\"CTE_Union_History_and_Present\".\"HIST_CREATED_BY\" AS VARCHAR(255)) AS \"ChangedBy\",\n                    NULL                                                                    AS \"OperationType\",\n                    NULL                                                                    AS \"OperationID\",\n                    \"CTE_Union_History_and_Present\".\"ExecutionType\"                         AS \"ExecutionType\"\n             FROM \"CTE_Union_History_and_Present\" AS \"CTE_Union_History_and_Present\"\n             WINDOW \"w\" AS (PARTITION BY \"CTE_Union_History_and_Present\".\"LINE_ID\"\n                     ORDER BY \"CTE_Union_History_and_Present\".\"HIST_CREATION_DATE\",\n                         \"CTE_Union_History_and_Present\".\"REQUEST_DATE\"))\nSELECT \n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ID\"        AS \"ID\",\n\t<%=sourceSystem%> || '::' || \"Identify_Changes\".\"ObjectID\"  AS \"ObjectID\",\n    \"Identify_Changes\".\"Time\"                                   AS \"Time\",\n    \"Identify_Changes\".\"Attribute\"                              AS \"Attribute\",\n    CAST(\"Identify_Changes\".\"OldValue\" AS VARCHAR(255))         AS \"OldValue\",\n    \"Identify_Changes\".\"NewValue\"                               AS \"NewValue\",\n    \"Identify_Changes\".\"OperationType\"                          AS \"OperationType\",\n    \"Identify_Changes\".\"OperationID\"                            AS \"OperationID\",\n    \"Identify_Changes\".\"ExecutionType\"                          AS \"ExecutionType\",\n    <%=sourceSystem%> || '::' || \"Identify_Changes\".\"ChangedBy\" AS \"ChangedBy\"\nFROM \"CTE_Identify_Changes\" AS \"Identify_Changes\"\nWHERE \"Identify_Changes\".\"Attribute\" IS NOT NULL"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Material",
                    "MaterialMasterPlant",
                    "Plant",
                    "SalesOrder"
                ],
                "namespace": "custom",
                "property_names": [
                    "CancellationReason",
                    "ConfirmedDeliveryDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "ExternalMaterialNumber",
                    "ID",
                    "IsCanceled",
                    "LineNumber",
                    "MaterialAvailabilityDate",
                    "NetAmount",
                    "NetLineWeight",
                    "NetUnitPrice",
                    "PlannedGoodsIssueDate",
                    "Quantity",
                    "QuantityUnit",
                    "RequestedDeliveryDate",
                    "SalesOrderNumber",
                    "SourceSystemInstance",
                    "WeightUnit"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH\n\"CTE_REJ_REASONS\" AS (\n    SELECT \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\",\n        \"OE_ORDER_LINES_HISTORY\".\"REASON_CODE\",\n        \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\",\n        ROW_NUMBER()\n        OVER (PARTITION BY \"OE_ORDER_LINES_HISTORY\".\"LINE_ID\" ORDER BY \"OE_ORDER_LINES_HISTORY\".\"HIST_CREATION_DATE\" DESC) AS \"RN\",\n        \"FND_LOOKUP_VALUES\".\"MEANING\"\n    FROM \"OE_ORDER_LINES_HISTORY\" AS \"OE_ORDER_LINES_HISTORY\"\n        LEFT JOIN \"FND_LOOKUP_VALUES\" AS \"FND_LOOKUP_VALUES\"\n            ON \"OE_ORDER_LINES_HISTORY\".\"REASON_CODE\" = \"FND_LOOKUP_VALUES\".\"LOOKUP_CODE\"\n                AND \"FND_LOOKUP_VALUES\".\"ZD_EDITION_NAME\"  = 'SET1'\n                AND \"FND_LOOKUP_VALUES\".\"LOOKUP_TYPE\" = 'CANCEL_CODE'\n                AND \"FND_LOOKUP_VALUES\".\"VIEW_APPLICATION_ID\" = '660'\n                AND \"FND_LOOKUP_VALUES\".\"LANGUAGE\" = <%=languageKey%>\n    WHERE \"OE_ORDER_LINES_HISTORY\".\"HIST_TYPE_CODE\" = 'CANCELLATION'\n        AND \"OE_ORDER_LINES_HISTORY\".\"FLOW_STATUS_CODE\" = 'CANCELLED'\n)\nSELECT \n    <%=sourceSystem%> || '::' || CAST(\"OE_ORDER_LINES_ALL\".\"LINE_ID\" AS VARCHAR(255))                          AS \"ID\",\n    \"OE_ORDER_LINES_ALL\".\"CREATION_DATE\"                                                                       AS \"CreationTime\",\n    CASE\n        WHEN \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" IS NOT NULL\n            AND \"OE_ORDER_LINES_ALL\".\"ORDER_SOURCE_ID\" != '0'\n            THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                                                        AS \"CreationExecutionType\",\n   <%=sourceSystem%>                                                                                           AS \"SourceSystemInstance\",\n   CASE\n        WHEN \"OE_ORDER_LINES_ALL\".\"CANCELLED_FLAG\" = 'Y'\n            THEN \"OE_ORDER_LINES_ALL\".\"CANCELLED_QUANTITY\" * \"OE_ORDER_LINES_ALL\".\"UNIT_SELLING_PRICE\"\n        ELSE \"OE_ORDER_LINES_ALL\".\"ORDERED_QUANTITY\" * \"OE_ORDER_LINES_ALL\".\"UNIT_SELLING_PRICE\"\n        END                                                                                                    AS \"NetAmount\",\n    \"OE_ORDER_HEADERS_ALL\".\"TRANSACTIONAL_CURR_CODE\"                                                           AS \"Currency\",\n    \"OE_ORDER_LINES_ALL\".\"UNIT_SELLING_PRICE\"                                                                  AS \"NetUnitPrice\",\n     CAST(\"OE_ORDER_HEADERS_ALL\".\"ORDER_NUMBER\" AS VARCHAR(255))                                               AS \"SalesOrderNumber\",\n    \"OE_ORDER_LINES_ALL\".\"LINE_NUMBER\" || COALESCE('.' || \"OE_ORDER_LINES_ALL\".\"SHIPMENT_NUMBER\", '')          AS \"LineNumber\",\n    \"OE_ORDER_LINES_ALL\".\"ORDERED_QUANTITY\"                                                                    AS \"Quantity\",\n    \"OE_ORDER_LINES_ALL\".\"ORDER_QUANTITY_UOM\"                                                                  AS \"QuantityUnit\",\n    CAST(\"OE_ORDER_LINES_ALL\".\"REQUEST_DATE\" AS TIMESTAMP)                                                     AS \"RequestedDeliveryDate\",\n    /*\n    On this date, the vendor must start the activities relevant for delivery, such as picking and packing the goods.\n    The Material Availability Date must be sufficiently early enough so that the goods are prepared by the loading date.\n\n    Requested delivery date minus transit time = Goods issue date\n    Goods issue date minus loading time = Loading date\n    Loading date minus pick/pack time = Material availability date\n     */\n    TIMESTAMPADD(\n        DAY, \n        CAST(\"MTL_SYSTEM_ITEMS_B\".\"PLANNING_TIME_FENCE_DAYS\" AS INT) * -1,\n        \"OE_ORDER_LINES_ALL\".\"PROMISE_DATE\"\n    )                                                                                                          AS \"MaterialAvailabilityDate\",\n    \"OE_ORDER_LINES_ALL\".\"SCHEDULE_SHIP_DATE\"                                                                  AS \"PlannedGoodsIssueDate\",\n    \"OE_ORDER_LINES_ALL\".\"PROMISE_DATE\"                                                                        AS \"ConfirmedDeliveryDate\",\n    \"MTL_SYSTEM_ITEMS_B\".\"UNIT_WEIGHT\" \n        * \"OE_ORDER_LINES_ALL\".\"ORDERED_QUANTITY\"                                                              AS \"NetLineWeight\",\n    \"MTL_SYSTEM_ITEMS_B\".\"WEIGHT_UOM_CODE\"                                                                     AS \"WeightUnit\",\n    CAST(\"OE_ORDER_LINES_ALL\".\"ORDERED_ITEM\" AS VARCHAR(255))                                                  AS \"ExternalMaterialNumber\",\n    CASE\n        WHEN \"OE_ORDER_LINES_ALL\".\"CANCELLED_FLAG\" = 'Y'\n            THEN COALESCE(\n                \"REJ_REASONS\".\"REASON_CODE\" || COALESCE(' - ' || \"REJ_REASONS\".\"MEANING\", ''),\n                \"REJ_REASONS\".\"REASON_CODE\",\n                'Generic'\n            )\n        END                                                                                                    AS \"CancellationReason\",\n    CASE WHEN \"OE_ORDER_LINES_ALL\".\"CANCELLED_FLAG\" = 'Y' THEN TRUE ELSE FALSE END                             AS \"IsCanceled\",\n\n    -- FKs\n    <%=sourceSystem%> || '::' ||  \"OE_ORDER_LINES_ALL\".\"CREATED_BY\"                                            AS \"CreatedBy\",\n    <%=sourceSystem%> || '::' || \"OE_ORDER_LINES_ALL\".\"HEADER_ID\"                                              AS \"SalesOrder\",\n    <%=sourceSystem%> || '::' || \"OE_ORDER_LINES_ALL\".\"INVENTORY_ITEM_ID\"                                      AS \"Material\",\n    <%=sourceSystem%> || '::' || \"OE_ORDER_LINES_ALL\".\"SHIP_FROM_ORG_ID\"                                       AS \"Plant\",\n    <%=sourceSystem%> || '::' || \"OE_ORDER_LINES_ALL\".\"SHIP_FROM_ORG_ID\" \n    || '::'  || \"OE_ORDER_LINES_ALL\".\"INVENTORY_ITEM_ID\"                                                       AS \"MaterialMasterPlant\"\nFROM \"OE_ORDER_LINES_ALL\" AS \"OE_ORDER_LINES_ALL\"\nLEFT JOIN \"MTL_SYSTEM_ITEMS_B\" AS \"MTL_SYSTEM_ITEMS_B\"\n    ON \"OE_ORDER_LINES_ALL\".\"INVENTORY_ITEM_ID\" = \"MTL_SYSTEM_ITEMS_B\".\"INVENTORY_ITEM_ID\"\n        AND \"OE_ORDER_LINES_ALL\".\"SHIP_FROM_ORG_ID\" = \"MTL_SYSTEM_ITEMS_B\".\"ORGANIZATION_ID\"\nLEFT JOIN \"OE_ORDER_HEADERS_ALL\" AS \"OE_ORDER_HEADERS_ALL\"\n    ON \"OE_ORDER_LINES_ALL\".\"HEADER_ID\" = \"OE_ORDER_HEADERS_ALL\".\"HEADER_ID\"\nLEFT JOIN \"CTE_REJ_REASONS\" AS \"REJ_REASONS\"\n    ON \"OE_ORDER_LINES_ALL\".\"CANCELLED_FLAG\" = 'Y'\n        AND \"OE_ORDER_LINES_ALL\".\"LINE_ID\" = \"REJ_REASONS\".\"LINE_ID\"\n        AND \"REJ_REASONS\".\"RN\" = '1'\nWHERE \"OE_ORDER_LINES_ALL\".\"LINE_CATEGORY_CODE\" = 'ORDER' \n"
                    }
                ],
                "relationship_transformations": [
                    {
                        "relationship_name": "GoodsIssue",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipGoodsIssue",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::' || CAST(\"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_ID\" AS VARCHAR(255))                AS \"GoodsIssue\",\n\t<%=sourceSystem%> || '::' || \"MTL_MATERIAL_TRANSACTIONS\".\"TRX_SOURCE_LINE_ID\"                                  AS \"ID\"\nFROM \"MTL_MATERIAL_TRANSACTIONS\" AS \"MTL_MATERIAL_TRANSACTIONS\"\nWHERE (\n        --Sales Order Issue\n         (\n            \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_TYPE_ID\" = '33' \n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_ACTION_ID\" = '1' \n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_SOURCE_TYPE_ID\" = '2' \n        )\n        OR\n        --Internal order issue\n        (\n            \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_TYPE_ID\" = '34' \n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_ACTION_ID\" = '1' \n            AND \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_SOURCE_TYPE_ID\" = '8'\n        )\n    )"
                            }
                        ]
                    },
                    {
                        "relationship_name": "MaterialMovement",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipMaterialMovement",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n\t<%=sourceSystem%> || '::' || CAST(\"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_ID\" AS VARCHAR(255))                AS \"MaterialMovement\",\n\t<%=sourceSystem%> || '::' || \"MTL_MATERIAL_TRANSACTIONS\".\"TRX_SOURCE_LINE_ID\"                                  AS \"ID\"\nFROM \"MTL_MATERIAL_TRANSACTIONS\" AS \"MTL_MATERIAL_TRANSACTIONS\"\nWHERE \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_TYPE_ID\" IN ('33', '34', '37')\n  AND \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_ACTION_ID\" ='1'\n  AND \"MTL_MATERIAL_TRANSACTIONS\".\"TRANSACTION_SOURCE_TYPE_ID\" IN ('2', '8', '12')"
                            }
                        ]
                    }
                ]
            }
        ]
    },
    {
        "change_date": 1761839500152.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "d94aa797-47b6-48e1-9b0f-9627812b5866",
            "name": "Lea Hanna",
            "type_": "USER"
        },
        "creation_date": 1753305282797.0,
        "data_connection_id": "8939ad05-4472-435c-a065-ed31be1b9fea",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderScheduleLine - S4 Hana",
        "draft": null,
        "factory_id": "cd2b092d-6aab-479f-a8c1-80d9770ee5b5",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "LanguageKey",
                "value": "'E'"
            },
            {
                "name": "sourceSystem",
                "value": "'SAP_S4_HANA'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Cancellation",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_CDPOS_CDHDR\" AS (\n SELECT\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3) AS \"MANDT\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10) AS \"VBELN\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 16) AS \"POSNR\",\n   \"CDPOS\".\"TABKEY\",\n   \"CDPOS\".\"TABNAME\",\n   \"CDPOS\".\"FNAME\",\n   \"CDPOS\".\"CHANGENR\",\n   \"CDPOS\".\"CHNGIND\",\n   \"CDPOS\".\"VALUE_OLD\",\n   \"CDPOS\".\"VALUE_NEW\",\n   \"CDHDR\".\"MANDANT\",\n   \"CDHDR\".\"USERNAME\",\n   \"CDHDR\".\"UTIME\",\n   \"CDHDR\".\"UDATE\",\n   \"CDHDR\".\"OBJECTCLAS\",\n   \"CDHDR\".\"OBJECTID\",\n   \"CDHDR\".\"TCODE\"\n FROM \"CDPOS\" AS \"CDPOS\"\n   LEFT JOIN \"CDHDR\" AS \"CDHDR\" ON \n    \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\" \n    AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n    AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\" \n    AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\" \n    AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n ORDER BY 1,2,3\n)\nSELECT\n    <%=sourceSystem%>\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6)\n        || COALESCE('::' || \"VBEP\".\"ETENR\", '')                                  AS \"ObjectID\",\n    <%=sourceSystem%>\n        || '::' || \"CDPOS_CDHDR\".\"TABKEY\"\n        || COALESCE('::' || \"VBEP\".\"ETENR\", '')\n        || '::' || \"CDPOS_CDHDR\".\"TABNAME\"\n        || '::' || \"CDPOS_CDHDR\".\"FNAME\"\n        || '::' || \"CDPOS_CDHDR\".\"CHANGENR\"\n        || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"                                                   AS \"ID\",\n    CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n        \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                           AS \"Time\",\n    'IsCanceled'                                                                       AS \"Attribute\",\n    CAST(FALSE AS VARCHAR(255))                                                        AS \"OldValue\",\n    CAST(TRUE AS VARCHAR(255))                                                         AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"       AS \"ChangedBy\",\n    \"CDPOS_CDHDR\".\"TCODE\"                                                                    AS \"OperationType\",\n    \"CDPOS_CDHDR\".\"CHANGENR\"                                                                 AS \"OperationID\",\n    CASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                                AS \"ExecutionType\"\nFROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\nLEFT JOIN \"VBEP\" AS \"VBEP\"\n    ON SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3) = \"VBEP\".\"MANDT\"\n       AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10) = \"VBEP\".\"VBELN\"\n       AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) = \"VBEP\".\"POSNR\"\n       AND \"VBEP\".\"BMENG\" > 0\nLEFT JOIN \"USR02\" AS \"USR02\"\n    ON \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n        AND \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBAP'\n AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'U'\n AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n AND \"CDPOS_CDHDR\".\"FNAME\" = 'ABGRU' AND NULLIF(\"CDPOS_CDHDR\".\"VALUE_OLD\", '') IS NULL\n AND \"CDPOS_CDHDR\".\"FNAME\" = 'ABGRU' AND NULLIF(\"CDPOS_CDHDR\".\"VALUE_NEW\", '') IS NOT NULL"
                    },
                    {
                        "id": "ChangesVBAP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_CDPOS_CDHDR\" AS (\n SELECT\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3) AS \"MANDT\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10) AS \"VBELN\",\n   SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 16) AS \"POSNR\",\n   \"CDPOS\".\"TABKEY\",\n   \"CDPOS\".\"TABNAME\",\n   \"CDPOS\".\"FNAME\",\n   \"CDPOS\".\"CHANGENR\",\n   \"CDPOS\".\"CHNGIND\",\n   \"CDPOS\".\"VALUE_OLD\",\n   \"CDPOS\".\"VALUE_NEW\",\n   \"CDHDR\".\"MANDANT\",\n   \"CDHDR\".\"USERNAME\",\n   \"CDHDR\".\"UTIME\",\n   \"CDHDR\".\"UDATE\",\n   \"CDHDR\".\"OBJECTCLAS\",\n   \"CDHDR\".\"OBJECTID\",\n   \"CDHDR\".\"TCODE\"\n FROM \"CDPOS\" AS \"CDPOS\"\n   LEFT JOIN \"CDHDR\" AS \"CDHDR\" ON \n        \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\" \n        AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\" \n        AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\" \n        AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\" \n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n ORDER BY 1,2,3\n),\n\"CTE_ChangesAll\" AS (\n    SELECT\n        <%=sourceSystem%>\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6)\n            || COALESCE('::' || \"VBEP\".\"ETENR\", '')                                       AS \"ObjectID\",\n        <%=sourceSystem%>\n            || '::' || \"CDPOS_CDHDR\".\"TABKEY\"\n            || COALESCE('::' || \"VBEP\".\"ETENR\", '')\n            || '::' || \"CDPOS_CDHDR\".\"TABNAME\"\n            || '::' || \"CDPOS_CDHDR\".\"FNAME\"\n            || '::' || \"CDPOS_CDHDR\".\"CHANGENR\"\n            || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"                                                   AS \"ID\",\n        CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n            \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                           AS \"Time\",\n        CASE\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'NETPR' THEN 'NetUnitPrice'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'MATNR' THEN 'MaterialNumber'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'ABGRU' AND NULLIF(\"CDPOS_CDHDR\".\"VALUE_OLD\", '') IS NOT NULL\n                THEN 'CancellationReason'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'WERKS' THEN 'Plant'\n            WHEN \"CDPOS_CDHDR\".\"FNAME\" = 'KWMENG' THEN 'Quantity'\n        END                                                                                AS \"Attribute\",\n        CASE\n            WHEN \"CDPOS_CDHDR\".\"VALUE_OLD\" LIKE '%-'\n                THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS_CDHDR\".\"VALUE_OLD\"), '-', ''))\n            ELSE \"CDPOS_CDHDR\".\"VALUE_OLD\" END                                                   AS \"OldValue\",\n        CASE\n            WHEN \"CDPOS_CDHDR\".\"VALUE_NEW\" LIKE '%-'\n                THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS_CDHDR\".\"VALUE_NEW\"), '-', ''))\n            ELSE \"CDPOS_CDHDR\".\"VALUE_NEW\" END                                                   AS \"NewValue\",\n        <%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"       AS \"ChangedBy\",\n        \"CDPOS_CDHDR\".\"TCODE\"                                                                    AS \"OperationType\",\n        \"CDPOS_CDHDR\".\"CHANGENR\"                                                                 AS \"OperationID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                                AS \"ExecutionType\"\n    FROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\n    LEFT JOIN \"VBEP\" AS \"VBEP\"\n        ON SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3) = \"VBEP\".\"MANDT\"\n            AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10) = \"VBEP\".\"VBELN\"\n            AND SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) = \"VBEP\".\"POSNR\"\n            AND \"VBEP\".\"BMENG\" > 0\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n            AND \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n    WHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBAP'\n    AND \"CDPOS_CDHDR\".\"FNAME\" IN ('NETPR', 'MATNR', 'ABGRU', 'WERKS', 'KWMENG')\n    AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'U'\n    AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n    AND \"CDPOS_CDHDR\".\"MANDANT\" IS NOT NULL\n)\nSELECT \n    \"ChangesAll\".\"ObjectID\"         AS \"ObjectID\",\n    \"ChangesAll\".\"ID\"               AS \"ID\",\n    \"ChangesAll\".\"Time\"             AS \"Time\",\n    \"ChangesAll\".\"Attribute\"        AS \"Attribute\",\n    \"ChangesAll\".\"OldValue\"         AS \"OldValue\",\n    \"ChangesAll\".\"NewValue\"         AS \"NewValue\",\n    \"ChangesAll\".\"ChangedBy\"        AS \"ChangedBy\",\n    \"ChangesAll\".\"OperationType\"    AS \"OperationType\",\n    \"ChangesAll\".\"OperationID\"      AS \"OperationID\",\n    \"ChangesAll\".\"ExecutionType\"    AS \"ExecutionType\"\nFROM \"CTE_ChangesAll\" AS \"ChangesAll\" \nWHERE \"ChangesAll\".\"Attribute\" IS NOT NULL"
                    },
                    {
                        "id": "ChangesVBEP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Sorted_Changes\" AS (\n    SELECT\n        \"CDPOS\".\"MANDANT\"                                                                                  AS \"MANDANT\",\n        \"CDPOS\".\"TABNAME\"                                                                                  AS \"TABNAME\",\n        \"CDPOS\".\"TABKEY\"                                                                                   AS \"TABKEY\",\n        CAST(\"CDHDR\".\"UDATE\" AS DATE) +\n            CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \"CDHDR\".\"UTIME\")\n            AS INTERVAL SECOND)                                                                            AS \"CHANGEDATE\",\n        LTRIM(\"CDPOS\".\"VALUE_OLD\")                                                                         AS \"VALUE_OLD\",\n        LTRIM(\"CDPOS\".\"VALUE_NEW\")                                                                         AS \"VALUE_NEW\",\n        ROW_NUMBER()\n        OVER (PARTITION BY \"CDPOS\".\"MANDANT\", \"CDPOS\".\"TABNAME\", \"CDPOS\".\"TABKEY\"\n            ORDER BY \"CDHDR\".\"UDATE\", \"CDHDR\".\"UTIME\")                                                     AS \"rn\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n    LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n        ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n    WHERE \"CDPOS\".\"MANDANT\" IS NOT NULL\n    AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n    AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n    AND \"CDPOS\".\"FNAME\" = 'BMENG'),\n\"CTE_SalesOrderScheduleLine_LookUp\" AS (\n    SELECT\n        \"Current\".\"MANDANT\",\n        \"Current\".\"TABNAME\",\n        \"Current\".\"TABKEY\",\n        \"Current\".\"CHANGEDATE\" AS \"StartDate\",\n        CASE\n            WHEN \"Next\".\"rn\" IS NULL\n                THEN CAST('9999-01-01 09:09:09' AS TIMESTAMP)\n            ELSE \"Next\".\"CHANGEDATE\"\n            END                AS \"EndDate\",\n        \"Current\".\"VALUE_NEW\"  AS \"Value\"\n    FROM \"CTE_Sorted_Changes\" AS \"Current\"\n    LEFT JOIN \"CTE_Sorted_Changes\" AS \"Next\"\n        ON \"Current\".\"MANDANT\" = \"Next\".\"MANDANT\"\n            AND \"Current\".\"TABNAME\" = \"Next\".\"TABNAME\"\n            AND \"Current\".\"TABKEY\" = \"Next\".\"TABKEY\"\n            AND \"Current\".\"rn\" + 1 = \"Next\".\"rn\"\n    UNION ALL\n    SELECT \"Current\".\"MANDANT\",\n        \"Current\".\"TABNAME\",\n        \"Current\".\"TABKEY\",\n        CAST('1970-01-01 00:00:00' AS TIMESTAMP) AS \"StartDate\",\n        \"Current\".\"CHANGEDATE\"                   AS \"EndDate\",\n        \"Current\".\"VALUE_OLD\"                    AS \"Value\"\n    FROM \"CTE_Sorted_Changes\" AS \"Current\"\n    WHERE \"Current\".\"rn\" = 1\n)\nSELECT \n    <%=sourceSystem%> \n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 6) \n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 20, 4)                                           AS \"ObjectID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" || '::' || \"CDPOS\".\"FNAME\"\n       || '::' || \"CDPOS\".\"CHANGENR\" || '::' || \"CDPOS\".\"CHNGIND\"                                   AS \"ID\",\n    CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE),\n        \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                                        AS \"Time\",\n    CASE\n        WHEN \"CDPOS\".\"FNAME\" = 'BMENG' THEN 'Quantity'\n        WHEN \"CDPOS\".\"FNAME\" = 'EDATU' AND COALESCE(CAST(\"SalesOrderScheduleLine_LookUp\".\"Value\" AS FLOAT), \"VBEP\".\"BMENG\") > 0 -- use \"VBEP\".\"BMENG\" as fall back if it has never been changed.\n            THEN 'ConfirmedDeliveryDate'\n        WHEN \"CDPOS\".\"FNAME\" = 'EDATU' THEN 'RequestedDeliveryDate'\n        WHEN \"CDPOS\".\"FNAME\" = 'MBDAT' THEN 'MaterialAvailabilityDate'\n        WHEN \"CDPOS\".\"FNAME\" = 'WADAT' THEN 'GoodsIssueDate'\n        ELSE \"CDPOS\".\"FNAME\"\n    END                                                                     AS \"Attribute\",\n    CASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-'\n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\"\n    END                                                                     AS \"OldValue\",\n    CASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-'\n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n    END                                                                     AS \"NewValue\",\n    <%=sourceSystem%> || \"CDHDR\".\"MANDANT\" || '::' || \"CDHDR\".\"USERNAME\"    AS \"ChangedBy\",\n    \"CDHDR\".\"TCODE\"                                                         AS \"OperationType\",\n    \"CDHDR\".\"CHANGENR\"                                                      AS \"OperationID\",\n    CASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                     AS \"ExecutionType\"\nFROM \"VBEP\" AS \"VBEP\"\nLEFT JOIN \"CDPOS\" AS \"CDPOS\"\n    ON \"VBEP\".\"MANDT\" = \"CDPOS\".\"MANDANT\"\n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n        AND \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\" = \"CDPOS\".\"TABKEY\"\n        AND \"CDPOS\".\"FNAME\" IN ('BMENG', 'EDATU', 'MBDAT', 'WADAT')\nLEFT JOIN \"CDHDR\" AS \"CDHDR\"\n    ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n        AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n        AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n        AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\nLEFT JOIN \"CTE_SalesOrderScheduleLine_LookUp\" AS \"SalesOrderScheduleLine_LookUp\"\n    ON \"VBEP\".\"MANDT\" = \"SalesOrderScheduleLine_LookUp\".\"MANDANT\"\n        AND \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\"\n            = \"SalesOrderScheduleLine_LookUp\".\"TABKEY\"\n        AND CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR), SUBSTRING(\n            CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19)) AS TIMESTAMP)\n            > \"SalesOrderScheduleLine_LookUp\".\"StartDate\"\n        AND CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR), SUBSTRING(\n            CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19)) AS TIMESTAMP)\n            <= \"SalesOrderScheduleLine_LookUp\".\"EndDate\"\nLEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n            AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\nWHERE \"VBEP\".\"MANDT\" IS NOT NULL\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL\n"
                    },
                    {
                        "id": "DeletionRecreationVBEP",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_CDPOS_CDHDR\" AS (\n    SELECT\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3) AS \"MANDT\",\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10) AS \"VBELN\",\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 16) AS \"POSNR\",\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 20, 4) AS \"TABKEY_4\",\n        \"CDPOS\".\"TABKEY\",\n        \"CDPOS\".\"TABNAME\",\n        \"CDPOS\".\"FNAME\",\n        \"CDPOS\".\"CHANGENR\",\n        \"CDPOS\".\"CHNGIND\",\n        \"CDPOS\".\"VALUE_OLD\",\n        \"CDPOS\".\"VALUE_NEW\",\n        \"CDHDR\".\"MANDANT\",\n        \"CDHDR\".\"USERNAME\",\n        \"CDHDR\".\"UTIME\",\n        \"CDHDR\".\"UDATE\",\n        \"CDHDR\".\"OBJECTCLAS\",\n        \"CDHDR\".\"OBJECTID\",\n        \"CDHDR\".\"TCODE\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n        LEFT JOIN \"CDHDR\" AS \"CDHDR\" ON \n            \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n    WHERE \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n    AND \"CDPOS\".\"TABNAME\" = 'VBEP' \n    AND \"CDPOS\".\"FNAME\" = 'KEY'\n    AND \"CDPOS\".\"CHNGIND\" IN ('I', 'D')\n),\n\"CTE_VBEP_CREATION\" AS (\n    SELECT \n        <%=sourceSystem%> \n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) \n            || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 20, 4)                                         AS \"ObjectID\",\n\t    <%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"TABKEY\" || '::' || \"CDPOS_CDHDR\".\"TABNAME\" || '::' || \n            \"CDPOS_CDHDR\".\"FNAME\" || '::' || \"CDPOS_CDHDR\".\"CHANGENR\" || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"            AS \"ID\",\n        CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n        \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                                      AS \"Time\",\n        <%=sourceSystem%> || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"                      AS \"ChangedBy\",\n        \"CDPOS_CDHDR\".\"TCODE\"                                                                           AS \"OperationType\",\n        \"CDPOS_CDHDR\".\"CHANGENR\"                                                                        AS \"OperationID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                                   AS \"ExecutionType\",\n        -- A schedule line can be deleted and recreated with the same line number. Here we assign a row number\n        -- to each insertion of a line with the same line number, the most recent insertion has row number 1.\n        ROW_NUMBER() OVER (\n            PARTITION BY \"CDPOS_CDHDR\".\"TABKEY\", \"CDPOS_CDHDR\".\"CHNGIND\"\n            ORDER BY\n                CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, COALESCE(CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE), CAST('1900-01-01 23:59:59' AS DATE)),\n                COALESCE(\"CDPOS_CDHDR\".\"UTIME\", CAST('1900-01-01 23:59:59' AS TIMESTAMP))) AS INTERVAL SECOND) DESC\n        )                                                                               AS \"rn_desc\"\n    FROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                AND \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n    WHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS_CDHDR\".\"FNAME\" = 'KEY'\n        AND \"CDPOS_CDHDR\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'I'\n)\n-- Deletions\nSELECT \n    <%=sourceSystem%> \n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 1, 3)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 4, 10)\n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 14, 6) \n        || '::' || SUBSTRING(\"CDPOS_CDHDR\".\"TABKEY\", 20, 4)                                         AS \"ObjectID\",\n\t<%=sourceSystem%> || '::' || \"CDPOS_CDHDR\".\"TABKEY\" || '::' || \"CDPOS_CDHDR\".\"TABNAME\" || '::' || \n        \"CDPOS_CDHDR\".\"FNAME\" || '::' || \"CDPOS_CDHDR\".\"CHANGENR\" || '::' || \"CDPOS_CDHDR\".\"CHNGIND\"            AS \"ID\",\n        CAST(\"CDPOS_CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDPOS_CDHDR\".\"UTIME\" AS DATE),\n        \"CDPOS_CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                                  AS \"Time\",\n        'Deleted'                                                                             AS \"Attribute\",\n        LTRIM(\"CDPOS_CDHDR\".\"VALUE_OLD\")                                                            AS \"OldValue\",\n        LTRIM(\"CDPOS_CDHDR\".\"VALUE_NEW\")                                                            AS \"NewValue\",\n        <%=sourceSystem%> || \"CDPOS_CDHDR\".\"MANDANT\" || '::' || \"CDPOS_CDHDR\".\"USERNAME\"                  AS \"ChangedBy\",\n        \"CDPOS_CDHDR\".\"TCODE\"                                                                       AS \"OperationType\",\n        \"CDPOS_CDHDR\".\"CHANGENR\"                                                                    AS \"OperationID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                                   AS \"ExecutionType\"\nFROM \"CTE_CDPOS_CDHDR\" AS \"CDPOS_CDHDR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"CDPOS_CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                AND \"CDPOS_CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\nWHERE \"CDPOS_CDHDR\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS_CDHDR\".\"FNAME\" = 'KEY'\n        AND \"CDPOS_CDHDR\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS_CDHDR\".\"CHNGIND\" = 'D'    \nUNION ALL\n-- Creations (all but the latest creation)\nSELECT \n    \"VBEP_CREATION\".\"ObjectID\"                                                          AS \"ObjectID\",\n\t\"VBEP_CREATION\".\"ID\"                                                                AS \"ID\",\n    \"VBEP_CREATION\".\"Time\"                                                              AS \"Time\",\n    'Created'                                                                           AS \"Attribute\",\n    NULL                                                                                AS \"OldValue\",\n    NULL                                                                                AS \"NewValue\",\n    \"VBEP_CREATION\".\"ChangedBy\"                                                         AS \"ChangedBy\",\n    \"VBEP_CREATION\".\"OperationType\"                                                     AS \"OperationType\",\n    \"VBEP_CREATION\".\"OperationID\"                                                       AS \"OperationID\",\n    \"VBEP_CREATION\".\"ExecutionType\"                                                     AS \"ExecutionType\"\nFROM \"CTE_VBEP_CREATION\" AS \"VBEP_CREATION\"\n-- capture all creations but the latest which is stored on the line from which the standard creation is derived\nWHERE \"VBEP_CREATION\".\"rn_desc\" > 1 "
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Material",
                    "MaterialMasterPlant",
                    "Plant",
                    "SalesOrder"
                ],
                "namespace": "custom",
                "property_names": [
                    "CancellationReason",
                    "ConfirmedDeliveryDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "ExternalMaterialNumber",
                    "ID",
                    "IsCanceled",
                    "LineNumber",
                    "MaterialAvailabilityDate",
                    "NetAmount",
                    "NetLineWeight",
                    "NetUnitPrice",
                    "PlannedGoodsIssueDate",
                    "Quantity",
                    "QuantityUnit",
                    "RequestedDeliveryDate",
                    "SalesOrderNumber",
                    "SourceSystemInstance",
                    "WeightUnit"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH CTE_VBEP_CREATION AS (\n    SELECT\n        \"CDPOS\".\"TABKEY\"                                                                AS \"ID\",\n        CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                        AS \"Time\",\n        \"CDHDR\".\"MANDANT\" || '::' || \"CDHDR\".\"USERNAME\"                                 AS \"User\",\n        \"CDPOS\".\"CHNGIND\"                                                               AS \"ChangeType\",\n        CASE        \n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'     \n            ELSE 'Manual'\n        END                                                                             AS \"ExecutionType\",\n        -- A schedule line can be deleted and recreated with the same line number. Here we assign a row number\n        -- to each insertion of a line with the same line number, the most recent insertion has row number 1.\n        ROW_NUMBER() OVER (\n            PARTITION BY \"CDPOS\".\"TABKEY\", \"CDPOS\".\"CHNGIND\"\n            ORDER BY\n                CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, COALESCE(CAST(\"CDHDR\".\"UTIME\" AS DATE), CAST('1900-01-01 23:59:59' AS DATE)),\n                COALESCE(\"CDHDR\".\"UTIME\", CAST('1900-01-01 23:59:59' AS TIMESTAMP))) AS INTERVAL SECOND) DESC\n        )                                                                               AS \"rn_desc\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n        LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n            ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n                AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n    WHERE \"CDPOS\".\"TABNAME\" = 'VBEP'\n        AND \"CDPOS\".\"FNAME\" = 'KEY'\n        AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n        AND \"CDPOS\".\"CHNGIND\" = 'I'\n    ORDER BY \"ID\", \"rn_desc\"\n), \nCTE_REQUESTED_DATE AS (\n    SELECT\n        \"VBEP\".\"MANDT\",\n        \"VBEP\".\"VBELN\",\n        \"VBEP\".\"POSNR\",\n        \"VBEP\".\"ETENR\",\n        -- To get the actual requested date for each line we check for each line if the date is a requested date by\n        -- checking for requested quantity > 0. If the requested quantity for a schedule line date is 0, it is not \n        -- a requested date and we set it to NULL. LAST_VALUE with IGNORE NULLS then gets the date from the latest\n        -- row where the requested quantity > 0 as the requested date. \n        -- Note: This logic does not cover the case where schedule lines cannot be confirmed between the requested dates\n        -- of the indivudal schedule lines. This requires a matching within the schedule line table. \n        LAST_VALUE(\n            CASE\n                WHEN \"VBEP\".\"WMENG\" > 0 THEN \"VBEP\".\"EDATU\"                                   \n            END) IGNORE NULLS OVER \"w\" AS \"RequestedDeliveryDate\"\n    FROM \"VBEP\" AS \"VBEP\"\n    WINDOW \"w\" AS (PARTITION BY \"VBEP\".\"MANDT\", \"VBEP\".\"VBELN\", \"VBEP\".\"POSNR\" ORDER BY \"VBEP\".\"EDATU\", \"VBEP\".\"ETENR\" ASC)\n),\n\"CTE_VBAP_VBEP\" AS (\n        SELECT\n                \"VBAP\".\"MANDT\",\n                \"VBAP\".\"VBELN\",\n                \"VBAP\".\"POSNR\",\n                \"VBAP\".\"ERDAT\",\n                \"VBAP\".\"ERZET\",\n                \"VBAP\".\"NETWR\",\n                \"VBAP\".\"KWMENG\",\n                \"VBAP\".\"WAERK\",\n                \"VBAP\".\"NETPR\",\n                \"VBAP\".\"KPEIN\",\n                \"VBAP\".\"GEWEI\",\n                \"VBAP\".\"NTGEW\",\n                \"VBAP\".\"VRKME\",\n                \"VBAP\".\"KDMAT\",\n                \"VBAP\".\"ABGRU\",\n                \"VBAP\".\"ERNAM\",\n                \"VBAP\".\"MATNR\",\n                \"VBAP\".\"WERKS\",\n                \"VBAP\".\"PSTYV\",\n                \"VBEP\".\"ETENR\",\n                \"VBEP\".\"BMENG\",\n                \"VBEP\".\"WMENG\",\n                \"VBEP\".\"EDATU\",\n                \"VBEP\".\"MBDAT\",\n                \"VBEP\".\"WADAT\",\n                \"VBAP\".\"ROUTE\"\n    FROM \"VBAP\" AS \"VBAP\"\n        LEFT JOIN \"VBEP\" AS \"VBEP\" ON \n            \"VBAP\".\"MANDT\" = \"VBEP\".\"MANDT\"\n            AND \"VBAP\".\"VBELN\" = \"VBEP\".\"VBELN\" \n            AND \"VBAP\".\"POSNR\" = \"VBEP\".\"POSNR\" \n            AND \"VBEP\".\"BMENG\" > 0\n    ORDER BY 1,2\n)\nSELECT\n    <%=sourceSystem%>  || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"VBELN\" || '::' || \"VBAP_VBEP\".\"POSNR\" || COALESCE('::' || \"VBAP_VBEP\".\"ETENR\", '')      AS \"ID\",\n    COALESCE(\n        \"CTE_VBEP_CREATION\".\"Time\",\n        CAST(\"VBAP_VBEP\".\"ERDAT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"VBAP_VBEP\".\"ERZET\" AS DATE), \"VBAP_VBEP\".\"ERZET\")AS INTERVAL SECOND)\n    )                                                                                                                                             AS \"CreationTime\",\n    COALESCE(\n        \"CTE_VBEP_CREATION\".\"ExecutionType\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n            ELSE 'Manual'\n        END\n    )                                                                                                                                             AS \"CreationExecutionType\",\n    \"VBAP_VBEP\".\"NETWR\" * COALESCE(\"VBAP_VBEP\".\"BMENG\", \"VBAP_VBEP\".\"KWMENG\") / \"VBAP_VBEP\".\"KWMENG\"                                                                  AS \"NetAmount\",\n    \"VBAP_VBEP\".\"WAERK\"                                                                                                                                AS \"Currency\",\n    \"VBAP_VBEP\".\"NETPR\" / COALESCE(\"VBAP_VBEP\".\"KPEIN\", 1)                                                                                                  AS \"NetUnitPrice\",\n    <%=sourceSystem%>  || '::' || \"VBAP_VBEP\".\"MANDT\"                                                                                                  AS \"SourceSystemInstance\",\n    \"VBAP_VBEP\".\"VBELN\"                                                                                                                                AS \"SalesOrderNumber\",\n    \"VBAP_VBEP\".\"POSNR\" || COALESCE('/' || \"VBAP_VBEP\".\"ETENR\", '')                                                                                         AS \"LineNumber\",\n    \"VBAP_VBEP\".\"GEWEI\"                                                                                                                                AS \"WeightUnit\",\n    \"VBAP_VBEP\".\"NTGEW\" * COALESCE(\"VBAP_VBEP\".\"BMENG\", \"VBAP_VBEP\".\"KWMENG\") / \"VBAP_VBEP\".\"KWMENG\"                                                                  AS \"NetLineWeight\",\n    COALESCE(\"VBAP_VBEP\".\"BMENG\", \"VBAP_VBEP\".\"KWMENG\")                                                                                                     AS \"Quantity\",\n    \"VBAP_VBEP\".\"VRKME\"                                                                                                                                AS \"QuantityUnit\",\n    COALESCE(\n        CAST(\"CTE_REQUESTED_DATE\".\"RequestedDeliveryDate\" AS TIMESTAMP),\n        CAST(\"VBAK\".\"VDATU\" AS TIMESTAMP)\n    )                                                                                                                                             AS \"RequestedDeliveryDate\",\n    CAST(\"VBAP_VBEP\".\"EDATU\" AS TIMESTAMP)                                                                                                             AS \"ConfirmedDeliveryDate\",\n    CAST(\"VBAP_VBEP\".\"MBDAT\" AS TIMESTAMP)                                                                                                             AS \"MaterialAvailabilityDate\",\n    CAST(\"VBAP_VBEP\".\"WADAT\" AS TIMESTAMP)                                                                                                             AS \"PlannedGoodsIssueDate\",\n    \"VBAP_VBEP\".\"KDMAT\"                                                                                                                                AS \"ExternalMaterialNumber\",\n    \"VBAP_VBEP\".\"ABGRU\" || ' - ' || \"TVAGT\".\"BEZEI\"                                                                                                    AS \"CancellationReason\",\n    CASE WHEN NULLIF(\"VBAP_VBEP\".\"ABGRU\", '') IS NOT NULL THEN TRUE ELSE FALSE END                                                                     AS \"IsCanceled\",\n    -- Relationships\n    COALESCE(\"CTE_VBEP_CREATION\".\"User\", <%=sourceSystem%>  || '::' ||  \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"ERNAM\" )                                AS \"CreatedBy\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"VBELN\"                                                                         AS \"SalesOrder\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"MATNR\"                                                                         AS \"Material\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"WERKS\"                                                                         AS \"Plant\",\n    <%=sourceSystem%> || '::' || \"VBAP_VBEP\".\"MANDT\" || '::' || \"VBAP_VBEP\".\"MATNR\" || '::' || \"VBAP_VBEP\".\"WERKS\"                                               AS \"MaterialMasterPlant\"\nFROM \"CTE_VBAP_VBEP\" AS \"VBAP_VBEP\"\nLEFT JOIN \"CTE_VBEP_CREATION\" AS \"CTE_VBEP_CREATION\"\n    ON \"CTE_VBEP_CREATION\".\"ID\" = \"VBAP_VBEP\".\"MANDT\"||\"VBAP_VBEP\".\"VBELN\"||\"VBAP_VBEP\".\"POSNR\"||\"VBAP_VBEP\".\"ETENR\"\n        AND \"CTE_VBEP_CREATION\".\"rn_desc\" = 1 -- we select the most recent schedule line if there are multiple with the same ETENR\nLEFT JOIN \"CTE_REQUESTED_DATE\" AS \"CTE_REQUESTED_DATE\" \n    ON \"VBAP_VBEP\".\"MANDT\" = \"CTE_REQUESTED_DATE\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"VBELN\" = \"CTE_REQUESTED_DATE\".\"VBELN\"\n       AND \"VBAP_VBEP\".\"POSNR\" = \"CTE_REQUESTED_DATE\".\"POSNR\"\n       AND \"VBAP_VBEP\".\"ETENR\" = \"CTE_REQUESTED_DATE\".\"ETENR\"\nLEFT JOIN \"VBAK\" AS \"VBAK\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nLEFT JOIN \"USR02\" AS \"USR02\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"USR02\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"ERNAM\" = \"USR02\".\"BNAME\"\nLEFT JOIN \"TVAPT\" AS \"TVAPT\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"TVAPT\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"PSTYV\" = \"TVAPT\".\"PSTYV\"\n       AND \"TVAPT\".\"SPRAS\" = <%=LanguageKey%>\nLEFT JOIN \"TVAGT\" AS \"TVAGT\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"TVAGT\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"ABGRU\" = \"TVAGT\".\"ABGRU\"\n       AND \"TVAGT\".\"SPRAS\" = <%=LanguageKey%>\nLEFT JOIN \"TVRO\" AS \"TVRO\"\n   ON \"VBAP_VBEP\".\"MANDT\" = \"TVRO\".\"MANDT\"\n       AND \"VBAP_VBEP\".\"ROUTE\" = \"TVRO\".\"ROUTE\"\nWHERE \"VBAP_VBEP\".\"MANDT\" IS NOT NULL\n AND \"VBAK\".\"VBTYP\" IN ('C', 'I')"
                    }
                ],
                "relationship_transformations": [
                    {
                        "relationship_name": "GoodsIssue",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipGoodsIssue",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"MATDOC\".\"MANDT\" || '::' || \"MATDOC\".\"KEY1\" || '::' || \"MATDOC\".\"KEY2\" || '::' || \n    \"MATDOC\".\"KEY3\" || '::' || \"MATDOC\".\"KEY4\" || '::' || \"MATDOC\".\"KEY5\" || '::' || \"MATDOC\".\"KEY6\"                                    AS \"GoodsIssue\",\n\t<%=sourceSystem%> || '::' || \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"           AS \"ID\"\nFROM \"VBEP\" AS \"VBEP\"\nINNER JOIN \"MATDOC\" AS \"MATDOC\"\n    ON \"MATDOC\".\"MANDT\" = \"VBEP\".\"MANDT\"\n        AND \"MATDOC\".\"KDAUF\" = \"VBEP\".\"VBELN\"\n        AND \"MATDOC\".\"KDPOS\" = \"VBEP\".\"POSNR\"\nLEFT JOIN \"VBAK\" AS \"VBAK\"\n    ON \"VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n        AND \"VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nWHERE \"VBAK\".\"VBTYP\" IN ('C', 'I')\nAND \"MATDOC\".\"BWART\" IN (\n    '601',\n    '641',\n    '643',\n    '647',\n    '645',\n    '603',\n    '633',\n    '623',\n    '231'\n)"
                            }
                        ]
                    },
                    {
                        "relationship_name": "MaterialMovement",
                        "sql_factory_datasets": [
                            {
                                "id": "RelationshipMaterialMovement",
                                "type_": "SQL_FACTORY_DATA_SET",
                                "complete_overwrite": false,
                                "disabled": false,
                                "materialise_cte": false,
                                "overwrite": null,
                                "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"MATDOC\".\"MANDT\" || '::' || \"MATDOC\".\"KEY1\" || '::' || \"MATDOC\".\"KEY2\" || '::' || \n    \"MATDOC\".\"KEY3\" || '::' || \"MATDOC\".\"KEY4\" || '::' || \"MATDOC\".\"KEY5\" || '::' || \"MATDOC\".\"KEY6\"                                    AS \"MaterialMovement\",\n\t<%=sourceSystem%> || '::' || \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"           AS \"ID\"\nFROM \"VBEP\" AS \"VBEP\"\nINNER JOIN \"MATDOC\" AS \"MATDOC\"\n    ON \"MATDOC\".\"MANDT\" = \"VBEP\".\"MANDT\"\n        AND \"MATDOC\".\"KDAUF\" = \"VBEP\".\"VBELN\"\n        AND \"MATDOC\".\"KDPOS\" = \"VBEP\".\"POSNR\"\nLEFT JOIN \"VBAK\" AS \"VBAK\"\n    ON \"VBEP\".\"MANDT\" = \"VBAK\".\"MANDT\"\n        AND \"VBEP\".\"VBELN\" = \"VBAK\".\"VBELN\"\nWHERE \"VBAK\".\"VBTYP\" IN ('C', 'I')"
                            }
                        ]
                    }
                ]
            }
        ]
    }
]