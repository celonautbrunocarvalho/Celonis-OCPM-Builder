[
    {
        "change_date": 1760431802876.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "2589b288-6fa5-4412-b75b-180b8acb07d0",
            "name": "Carolina Ventura",
            "type_": "USER"
        },
        "creation_date": 1749931118542.0,
        "data_connection_id": "03736e95-3931-4eda-8dfe-fc16e11388bc",
        "description": null,
        "disabled": null,
        "display_name": "VendorInvoiceLine - 00. Central Extraction Pool_Oracle Fusion",
        "draft": null,
        "factory_id": "606837c2-08da-408a-89b3-a22940be9f7f",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'Oracle_Fusion'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT \n    <%=sourceSystem%>  ||'::'|| \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllInvoiceId\" \n        ||'::'|| \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllLineNumber\"                                       AS \"ID\",\n    <%=sourceSystem%>   ||'::'|| \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllInvoiceId\"                        AS \"VendorInvoice\",\n    <%=sourceSystem%>  ||'::'|| \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllPoLineId\"                          AS \"PurchaseDocumentLine\",\n    <%=sourceSystem%>  ||'::'|| 'RCV_'|| \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllRcvTransactionId\"         AS \"GoodsReceipt\",   \n    CAST(\"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllLineNumber\" AS VARCHAR(255))                              AS \"LineNumber\",\n    \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllQuantityInvoiced\"                                              AS \"Quantity\",\n    \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllUnitMeasLookupCode\"                                            AS \"QuantityUnit\",\n    \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllAmount\"                                                        AS \"Amount\",\n    \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllDescription\"                                                   AS \"Description\",\n\t<%=sourceSystem%>                                                                                       AS \"SourceSystemInstance\"\nFROM \"FscmTopModelAM_FinExtractAM_ApBiccExtractAM_InvoiceLineExtractPVO\" AS \"AP_INVOICE_LINES_ALL\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ApBiccExtractAM_InvoiceHeaderExtractPVO\" AS \"AP_INVOICES_ALL\"\n        ON \"AP_INVOICE_LINES_ALL\".\"ApInvoiceLinesAllInvoiceId\" = \"AP_INVOICES_ALL\".\"ApInvoicesInvoiceId\" \nWHERE \"AP_INVOICES_ALL\".\"ApInvoicesInvoiceTypeLookupCode\" IN ('STANDARD', 'CREDIT','DEBIT')"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1760431726181.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "baa4e63e-f8f8-4e48-b1ee-af539386867c",
            "name": "Bruno Carvalho",
            "type_": "USER"
        },
        "creation_date": 1757034382029.0,
        "data_connection_id": "1b87451d-df3c-4f06-b5e6-622d18c93682",
        "description": null,
        "disabled": null,
        "display_name": "VendorInvoiceLine - 00. Central Extraction Pool_ARIBA",
        "draft": null,
        "factory_id": "36a46c67-af45-4e39-a2d3-56dd7ad73fa9",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_ARIBA'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \n    CTE_Invoice AS (\n        SELECT\n            * ,\n            ROW_NUMBER() OVER (\n                PARTITION BY \"InitialUniqueName\"\n                ORDER BY\n                    CAST(\"VersionNumber\" AS integer) DESC\n            ) AS RN\n        FROM \"Invoice\"\n        WHERE 1=1\n            AND \"Active\" = 'true'\n    ),\n    CTE_CreateDate AS (\n        SELECT\n            \"InitialUniqueName\",\n            \"CreateDate\" ,\n            ROW_NUMBER() OVER (\n                PARTITION BY \"InitialUniqueName\"\n                ORDER BY\n                    \"CreateDate\" ASC\n            ) AS RN  -- Takes first creation date for the PR, as versioning will update creation date\n        FROM \"Invoice\"\n    )\nSELECT\n    <%=sourceSystem%> || '::' || \"Invoice\".\"InitialUniqueName\" || '::' || \"InvoiceLineItems\".\"NumberInCollection\" AS \"ID\",\n\t<%=sourceSystem%>  AS \"SourceSystemInstance\",\n\t\"InvoiceLineItems\".\"Description_Description\" AS \"Description\",\n\tCAST(\"InvoiceLineItems\".\"Amount_Amount\" AS DOUBLE) AS \"Amount\",\n\t\"InvoiceLineItems\".\"Description_UnitOfMeasure_UniqueName\" AS \"QuantityUnit\",\n\tCAST(\"InvoiceLineItems\".\"Quantity\" AS DOUBLE) AS \"Quantity\",\n\t\"InvoiceLineItems\".\"NumberInCollection\" AS \"LineNumber\",\n\t--<%=sourceSystem%> || '::' || \"Receipt\".\"InitialUniqueName\" || '::' || \"ReceiptItems\".\"NumberInCollection\" AS \"GoodsReceipt\",\n\t<%=sourceSystem%> || '::' || COALESCE(\"ERPOrder\".\"InitialUniqueName\", \"DirectOrder\".\"InitialUniqueName\") || '::' || COALESCE(\"InvoiceLineItems\".\"OrderLineItem_NumberInCollection\",'') AS \"PurchaseDocumentLine\",\n    <%=sourceSystem%> || '::' || \"Invoice\".\"InitialUniqueName\" AS \"VendorInvoice\"\nFROM \"InvoiceLineItems\" AS \"InvoiceLineItems\"\nJOIN \"CTE_Invoice\" AS \"Invoice\"\n    ON \"InvoiceLineItems\".\"Invoice_UniqueName\" = \"Invoice\".\"UniqueName\"\n    AND \"Invoice\".\"RN\" = 1\nJOIN \"CTE_CreateDate\" AS \"CreateDate\"\n    ON \"Invoice\".\"InitialUniqueName\" = \"CreateDate\".\"InitialUniqueName\"\n    AND \"CreateDate\".\"RN\" = 1\nLEFT JOIN \"ERPOrder\"\n    ON \"InvoiceLineItems\".\"Order_UniqueName\" = \"ERPOrder\".\"UniqueName\"\nLEFT JOIN \"DirectOrder\"\n    ON \"InvoiceLineItems\".\"Order_UniqueName\" = \"DirectOrder\".\"UniqueName\"\nWHERE \"Invoice\".\"RN\" = 1"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1766167236372.0,
        "changed_by": {
            "id": "18f1c3ed-024c-44fb-9163-4a9768c7844f",
            "name": "Gokul",
            "type_": "USER"
        },
        "created_by": {
            "id": "4622cbb7-ba9b-4f8d-9415-2b9ef8a9db64",
            "name": "Rahul Bhat TR",
            "type_": "USER"
        },
        "creation_date": 1764928087413.0,
        "data_connection_id": "35a670b4-96f2-4f18-a811-7a12343a4d2a",
        "description": null,
        "disabled": null,
        "display_name": "VendorInvoiceLine - MSDynamics_365",
        "draft": null,
        "factory_id": "a2d46ba0-5891-48c3-ac89-d3f9508c05b3",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'MSDynamics_365'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "\nSELECT DISTINCT\n    <%=sourceSystem%>||'::'||VendorInvoiceHeaders.InvoiceNumber ||'::'||VendorInvoiceLines.ItemNumber                 AS ID,\n    VendorInvoiceLines.NetAmount                                                    AS Amount,\n    VendorInvoiceLines.ItemNumber                                                   AS LineNumber,\n    VendorInvoiceLines.ReceiveNow                                                   AS Quantity,\n    VendorInvoiceLines.Unit                                                         AS QuantityUnit,\n    NULL                                                                            AS SourceSystemInstance,\n    NULL                                                                            AS Description,\n\n    <%=sourceSystem%>||'::'||VendorInvoiceHeaders.InvoiceNumber                     AS VendorInvoice,\n    <%=sourceSystem%>||'::'||VendorInvoiceLines.ItemNumber                          AS GoodsReceipt,\n    <%=sourceSystem%>||'::'||PurchaseOrderLinesV2.PurchaseOrderNumber               AS PurchaseDocumentLine\nFROM VendorInvoiceLines\n\tLEFT JOIN VendorInvoiceHeaders\n        ON VendorInvoiceHeaders.HeaderReference = VendorInvoiceLines.HeaderReference\n        AND VendorInvoiceHeaders.dataAreaId = VendorInvoiceLines.dataAreaId\n        AND VendorInvoiceHeaders.VendorAccount = VendorInvoiceLines.VendorAccount\n    LEFT JOIN VendorsV2\n        ON VendorsV2.VendorAccountNumber = VendorInvoiceLines.VendorAccount\n        AND VendorsV2.dataAreaId = VendorInvoiceLines.dataAreaId\n    LEFT JOIN PurchaseOrderHeadersV2\n        ON PurchaseOrderHeadersV2.OrderVendorAccountNumber = VendorsV2.VendorAccountNumber\n        AND PurchaseOrderHeadersV2.dataAreaId = VendorsV2.dataAreaId\n    LEFT JOIN PurchaseOrderLinesV3 AS PurchaseOrderLinesV2\n        ON PurchaseOrderHeadersV2.PurchaseOrderNumber = PurchaseOrderLinesV2.PurchaseOrderNumber\n        AND PurchaseOrderHeadersV2.dataAreaId = PurchaseOrderLinesV2.dataAreaId\n    LEFT JOIN ReleasedProductsV2\n        ON ReleasedProductsV2.ItemNumber = PurchaseOrderLinesV2.ItemNumber\n        AND ReleasedProductsV2.dataAreaId = PurchaseOrderLinesV2.dataAreaId\n\tLEFT JOIN InventItemPricesV3\n        ON ReleasedProductsV2.ItemNumber = InventItemPricesV3.ItemNumber\n        AND ReleasedProductsV2.dataAreaId =InventItemPricesV3.dataAreaId\nWHERE <%=sourceSystem%>||'::'||VendorInvoiceHeaders.InvoiceNumber ||'::'||VendorInvoiceLines.ItemNumber !=''\n\n\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1763480930660.0,
        "changed_by": {
            "id": "5477e5f1-b56c-404c-b581-116f9517bb0d",
            "name": "Robert Connolly",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749635392302.0,
        "data_connection_id": "b9f449da-3a15-43d8-89e3-0e87e54fb5af",
        "description": null,
        "disabled": null,
        "display_name": "VendorInvoiceLine - SAP ECC",
        "draft": null,
        "factory_id": "3fcfed4f-c0ef-4be9-b310-f511bb18580c",
        "factory_validation_status": "VALID",
        "has_user_template": true,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_ECC'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::'|| \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"BELNR\" \n        || '::'|| \"RSEG\".\"GJAHR\" ||'::'|| \"RSEG\".\"BUZEI\"                            AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"BELNR\"\n        || '::'|| \"RSEG\".\"GJAHR\"                                                    AS \"VendorInvoice\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"LFBNR\" \n        || '::'|| \"RSEG\".\"LFGJA\" || '::'|| \"RSEG\".\"LFPOS\"                           AS \"GoodsReceipt\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"EBELN\" \n        || '::'|| \"RSEG\".\"EBELP\"                                                    AS \"PurchaseDocumentLine\",\n    \"RSEG\".\"SGTXT\"                                                                  AS \"Description\",\n\t\"RSEG\".\"WRBTR\" *\n    CASE\n       WHEN \"RSEG\".\"SHKZG\" = 'H' THEN -1.0\n       WHEN \"RSEG\".\"SHKZG\" = 'S' THEN 1.0 \n     END                                                                            AS \"Amount\",\n\t\"RSEG\".\"MEINS\"                                                                  AS \"QuantityUnit\",\n\t\"RSEG\".\"MENGE\" *\n    CASE\n        WHEN \"RSEG\".\"SHKZG\" = 'H' THEN -1.0\n        WHEN \"RSEG\".\"SHKZG\" = 'S' THEN 1.0 \n     END                                                                            AS \"Quantity\",\n\tCAST(\"RSEG\".\"BUZEI\" AS VARCHAR(255))                                            AS \"LineNumber\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\"                                     AS \"SourceSystemInstance\"\nFROM \"RSEG\" AS \"RSEG\"\n    JOIN \"RBKP\" AS \"RBKP\" \n        ON \"RSEG\".\"MANDT\" = \"RBKP\".\"MANDT\"\n            AND \"RSEG\".\"BELNR\" = \"RBKP\".\"BELNR\"\n            AND \"RSEG\".\"GJAHR\" = \"RBKP\".\"GJAHR\"\nWHERE NULLIF(\"RSEG\".\"MANDT\", '') IS NOT NULL\n    AND \"RBKP\".\"VGART\" IN ('RD','RS')\n\n\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1760431663269.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749630804948.0,
        "data_connection_id": "42d53587-d7fa-45cf-8403-26770d8029d0",
        "description": "",
        "disabled": null,
        "display_name": "VendorInvoiceLine transformation - 00. Central Extraction Pool_Oracle-ebs - 1",
        "draft": null,
        "factory_id": "a5149341-cf89-46c0-9c08-a620d92b61ce",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'Oracle_EBS'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT \n    <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"INVOICE_ID\" \n        || '::' || \"AP_INVOICE_LINES_ALL\".\"LINE_NUMBER\"                                                        AS \"ID\",\n    <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"INVOICE_ID\"                                          AS \"VendorInvoice\",\n    <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"PO_LINE_ID\"                                          AS \"PurchaseDocumentLine\",\n    <%=sourceSystem%>  || '::' || 'RCV_' || \"AP_INVOICE_LINES_ALL\".\"RCV_TRANSACTION_ID\"                        AS \"GoodsReceipt\",\n\tCAST(\"AP_INVOICE_LINES_ALL\".\"LINE_NUMBER\" AS VARCHAR(255))                                                 AS \"LineNumber\",\n\t\"AP_INVOICE_LINES_ALL\".\"QUANTITY_INVOICED\"                                                                 AS \"Quantity\",\n\t\"AP_INVOICE_LINES_ALL\".\"UNIT_MEAS_LOOKUP_CODE\"                                                             AS \"QuantityUnit\",\n\t\"AP_INVOICE_LINES_ALL\".\"AMOUNT\"                                                                            AS \"Amount\",\n\t\"AP_INVOICE_LINES_ALL\".\"DESCRIPTION\"                                                                       AS \"Description\",\n    <%=sourceSystem%>                                                                                          AS \"SourceSystemInstance\"\nFROM \"AP_INVOICE_LINES_ALL\" AS \"AP_INVOICE_LINES_ALL\"\n    LEFT JOIN \"AP_INVOICES_ALL\" AS \"AP_INVOICES_ALL\"\n        ON \"AP_INVOICE_LINES_ALL\".\"INVOICE_ID\" = \"AP_INVOICES_ALL\".\"INVOICE_ID\" \nWHERE \"AP_INVOICES_ALL\".\"INVOICE_TYPE_LOOKUP_CODE\" IN ('STANDARD', 'CREDIT','DEBIT')"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1761839576408.0,
        "changed_by": {
            "id": "8b0fa45b-28fe-4314-bf39-c9e18042a5f4",
            "name": "Johannes Muhr",
            "type_": "USER"
        },
        "created_by": {
            "id": "8b0fa45b-28fe-4314-bf39-c9e18042a5f4",
            "name": "Johannes Muhr",
            "type_": "USER"
        },
        "creation_date": 1753884657252.0,
        "data_connection_id": "8939ad05-4472-435c-a065-ed31be1b9fea",
        "description": null,
        "disabled": null,
        "display_name": "VendorInvoiceLine - SAP S/4",
        "draft": null,
        "factory_id": "e2d2b90f-d81e-4f24-a2bc-9b6c5baa6e56",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_S4_HANA'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT \n    <%=sourceSystem%> || '::'|| \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"BELNR\" \n        || '::'|| \"RSEG\".\"GJAHR\" ||'::'|| \"RSEG\".\"BUZEI\"                                    AS \"ID\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"BELNR\"\n        || '::'|| \"RSEG\".\"GJAHR\"                                                            AS \"VendorInvoice\",\n    <%=sourceSystem%> || '::' || \"MATDOC\".\"MANDT\" || '::' || \"MATDOC\".\"KEY1\" || '::' || \n        \"MATDOC\".\"KEY2\" || '::' || \"MATDOC\".\"KEY3\" || '::' || \"MATDOC\".\"KEY4\" || '::' || \n        \"MATDOC\".\"KEY5\" || '::' || \"MATDOC\".\"KEY6\"                                          AS \"GoodsReceipt\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\" || '::'|| \"RSEG\".\"EBELN\" \n        || '::'|| \"RSEG\".\"EBELP\"                                                            AS \"PurchaseDocumentLine\",\n    \"RSEG\".\"SGTXT\"                                                                          AS \"Description\",\n\t\"RSEG\".\"WRBTR\" *\n    CASE\n       WHEN \"RSEG\".\"SHKZG\" = 'H' THEN -1.0\n       WHEN \"RSEG\".\"SHKZG\" = 'S' THEN 1.0 \n     END                                                                                    AS \"Amount\",\n\t\"RSEG\".\"MEINS\"                                                                          AS \"QuantityUnit\",\n\t\"RSEG\".\"MENGE\" *\n    CASE\n        WHEN \"RSEG\".\"SHKZG\" = 'H' THEN -1.0\n        WHEN \"RSEG\".\"SHKZG\" = 'S' THEN 1.0 \n     END                                                                                    AS \"Quantity\",\n\t\"RSEG\".\"BUZEI\"                                                                          AS \"LineNumber\",\n    <%=sourceSystem%> || '::' || \"RSEG\".\"MANDT\"                                             AS \"SourceSystemInstance\"\nFROM \"RSEG\" AS \"RSEG\"\n    JOIN \"RBKP\" AS \"RBKP\" \n        ON \"RSEG\".\"MANDT\" = \"RBKP\".\"MANDT\"\n            AND \"RSEG\".\"BELNR\" = \"RBKP\".\"BELNR\"\n            AND \"RSEG\".\"GJAHR\" = \"RBKP\".\"GJAHR\"\n    LEFT JOIN \"MATDOC\" AS \"MATDOC\"\n        ON \"RSEG\".\"MANDT\" = \"MATDOC\".\"MANDT\"\n            AND \"RSEG\".\"LFBNR\" = \"MATDOC\".\"MBLNR\"\n            AND \"RSEG\".\"LFGJA\" = \"MATDOC\".\"MJAHR\"\n            AND \"RSEG\".\"LFPOS\" = \"MATDOC\".\"ZEILE\"\nWHERE NULLIF(\"RSEG\".\"MANDT\", '') IS NOT NULL\n    AND \"RBKP\".\"VGART\" IN ('RD','RS')\n\n\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1766780937148.0,
        "changed_by": {
            "id": "c8f85336-92c4-4edf-b363-3489e2310c8b",
            "name": "Corrie",
            "type_": "USER"
        },
        "created_by": {
            "id": "c8f85336-92c4-4edf-b363-3489e2310c8b",
            "name": "Corrie",
            "type_": "USER"
        },
        "creation_date": 1765763469719.0,
        "data_connection_id": "bb2bd2e3-5af0-4cda-b7c8-552ed55569b6",
        "description": null,
        "disabled": true,
        "display_name": "VendorInvoiceLine - Coupa",
        "draft": null,
        "factory_id": "8bdffcb2-6249-401b-bc0f-f889fe73e357",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'Coupa'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "VendorInvoiceLine",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "GoodsReceipt",
                    "PurchaseDocumentLine",
                    "VendorInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "Description",
                    "ID",
                    "LineNumber",
                    "Quantity",
                    "QuantityUnit",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "VendorInvoiceLineAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "\n\nSELECT DISTINCT\n    -- Unique ID for the Invoice Line\n    <%=sourceSystem%> || '::' || \"InvoiceLine\".\"id\"                                     AS \"ID\",\n    \n    -- Link to the Invoice Header\n    <%=sourceSystem%> || '::' || \"Invoice\".\"id\"                                         AS \"VendorDocument\",\n    \n    -- Link to the PO Line\n    <%=sourceSystem%> || '::' || \"PurchaseOrderLine\".\"id\"                               AS \"PurchaseOrderItem\",\n    <%=sourceSystem%> || '::' || \"InvoiceLine\".\"order-header-num\"                 AS \"PurchaseOrder\",\n    \n    -- Link to the Receipt (Coupa stores the Receipt ID on the Invoice Line match record)\n    -- This assumes a simplified match object for reporting; otherwise, a join to 'match' is needed.\n    NULL                                                                                AS \"GoodsReceipt\",\n    \n    -- Line Number and Quantities\n    CAST(\"InvoiceLine\".\"line-num\" AS VARCHAR(255))                                      AS \"ItemNumber\",\n    CAST(\"InvoiceLine\".\"quantity\" AS FLOAT)                                             AS \"Quantity\",\n    \"InvoiceLine\".\"UOM\"                                                                 AS \"QuantityUnit\",\n    \"InvoiceLine\".\"accounting-total\"                                                    AS \"Amount\",\n    \"InvoiceLine\".\"description\"                                                         AS \"Description\",\n    \n    -- Source System\n    <%=sourceSystem%>                                                                   AS \"SourceSystemInstance\",\n\n--Extension Attributes\n\"InvoiceLine\".\"status\",\n\"InvoiceLine\".\"category\",\n\"InvoiceLine\".\"subcategory\",\n\"InvoiceLine\".\"currency\",\n\"InvoiceLine\".\"tags\",\n\"InvoiceLine\".\"taggings\",\n\"InvoiceLine\".\"item_name\" AS \"ItemName\",\n\"InvoiceLine\".\"created-at\" AS \"CreationTime\"\n\nFROM \n    \"invoice_lines\" AS \"InvoiceLine\"\n\nINNER JOIN \n    \"invoices\" AS \"Invoice\"\n    -- Join Invoice Line to its Header\n    ON \"InvoiceLine\".\"invoices_id\" = \"Invoice\".\"id\" \n    \nLEFT JOIN \n    \"purchase_order_lines\" AS \"PurchaseOrderLine\"\n    -- Link to the Purchase Order Line. This foreign key is often on the invoice line itself.\n    ON \"InvoiceLine\".\"order-header-num\" || \"InvoiceLine\".\"order-line-num\" = \"PurchaseOrderLine\".\"id\"\n    \n/*SELECT <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"INVOICE_ID\" \n            || '::' || \"AP_INVOICE_LINES_ALL\".\"LINE_NUMBER\"                                                       AS \"ID\",\n       <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"INVOICE_ID\"                                          AS \"VendorDocument\",\n       <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"PO_LINE_ID\"                                          AS \"PurchaseDocumentItem\",\n       <%=sourceSystem%>  || '::' || \"AP_INVOICE_LINES_ALL\".\"RCV_TRANSACTION_ID\"                                  AS \"GoodsReceipt\",\n\t   CAST(\"AP_INVOICE_LINES_ALL\".\"LINE_NUMBER\" AS VARCHAR(255))                                                 AS \"ItemNumber\",\n\t   \"AP_INVOICE_LINES_ALL\".\"QUANTITY_INVOICED\"                                                                 AS \"Quantity\",\n\t   \"AP_INVOICE_LINES_ALL\".\"UNIT_MEAS_LOOKUP_CODE\"                                                             AS \"QuantityUnit\",\n\t   \"AP_INVOICE_LINES_ALL\".\"AMOUNT\"                                                                            AS \"Amount\",\n\t   \"AP_INVOICE_LINES_ALL\".\"DESCRIPTION\"                                                                       AS \"Description\",\n       <%=sourceSystem%>                                                                                          AS \"SourceSystemInstance\"\nFROM \"AP_INVOICE_LINES_ALL\" AS \"AP_INVOICE_LINES_ALL\"\nLEFT JOIN \"AP_INVOICES_ALL\" AS \"AP_INVOICES_ALL\"\n           ON \"AP_INVOICE_LINES_ALL\".\"INVOICE_ID\" = \"AP_INVOICES_ALL\".\"INVOICE_ID\" \nWHERE \"AP_INVOICES_ALL\".\"INVOICE_TYPE_LOOKUP_CODE\" IN ('STANDARD', 'CREDIT','DEBIT')*/\n\n/*\nSELECT\n\t<> AS \"rc\",\n\t<> AS \"LineNumber\",\n\t<> AS \"SourceSystemInstance\",\n\t<> AS \"Description\",\n\t<> AS \"Amount\",\n\t<> AS \"QuantityUnit\",\n\t<> AS \"Quantity\",\n\t<> AS \"ID\",\n\t<> AS \"GoodsReceipt\",\n\t<> AS \"PurchaseDocumentLine\",\n\t<> AS \"VendorInvoice\"\nFROM <>\n\tLEFT JOIN <>\n\tON <>\nWHERE <>\n*/"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]