[
    {
        "change_date": 1769613521451.0,
        "changed_by": {
            "id": "5477e5f1-b56c-404c-b581-116f9517bb0d",
            "name": "Robert Connolly",
            "type_": "USER"
        },
        "created_by": {
            "id": "d94aa797-47b6-48e1-9b0f-9627812b5866",
            "name": "Lea Hanna",
            "type_": "USER"
        },
        "creation_date": 1753305104384.0,
        "data_connection_id": "8939ad05-4472-435c-a065-ed31be1b9fea",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderLineBlock - S4 Hana",
        "draft": null,
        "factory_id": "7c5aebaf-a1b1-47d8-afbc-bb22fb7c0de5",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "LanguageKey",
                "value": "'E'"
            },
            {
                "name": "sourceSystem",
                "value": "'SAP_S4_HANA'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLineBlock",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "CDPOS",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_JoinTable\" AS (\n    SELECT\n        \"CDPOS\".\"TABKEY\"    AS \"TABKEY\",\n        \"CDPOS\".\"MANDANT\"    AS \"MANDANT\",\n        \"CDPOS\".\"OBJECTCLAS\" AS \"OBJECTCLAS\",\n        \"CDPOS\".\"OBJECTID\"   AS \"OBJECTID\",\n        \"CDPOS\".\"FNAME\"      AS \"FNAME\",\n        \"CDPOS\".\"VALUE_NEW\"  AS \"VALUE_NEW\",\n        \"CDPOS\".\"VALUE_OLD\"  AS \"VALUE_OLD\",\n        \"CDPOS\".\"TABNAME\"    AS \"TABNAME\",\n        \"CDHDR\".\"UDATE\"      AS \"UDATE\",\n        \"CDHDR\".\"UTIME\"      AS \"UTIME\",\n        \"CDPOS\".\"CHNGIND\"    AS \"CHNGIND\",\n        \"CDHDR\".\"USERNAME\"   AS \"USERNAME\",\n        \"CDHDR\".\"TCODE\"      AS \"TCODE\",\n        \"CDHDR\".\"CHANGENR\"   AS \"CHANGENR\",\n        \"USR02\".\"USTYP\"      AS \"USTYP\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n    INNER JOIN \"CDHDR\" AS \"CDHDR\"\n        ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n            AND \"CDPOS\".\"CHNGIND\" = 'U'\n            AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n            AND \"CDPOS\".\"FNAME\" = 'LIFSP'\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n            AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n),\n    \"CTE_BlockFromChangelog\" AS (\n        SELECT\n            \"JoinTable\".\"TABKEY\"                                                          AS \"BlockID\",\n            CAST(\"JoinTable\".\"UDATE\" AS DATE)\n                + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)        AS \"BlockTime\",\n            'DeliveryBlock'                                                               AS \"BlockType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\"                                        AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                                                       AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                                                       AS \"VALUE_OLD\",\n            \"JoinTable\".\"MANDANT\" || '::' || \"JoinTable\".\"USERNAME\"                       AS \"BlockedBy\",\n            CASE\n                WHEN \"JoinTable\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n                ELSE 'Manual'\n            END                                                                           AS \"BlockExecutionType\",\n            \"JoinTable\".\"TCODE\"                                                           AS \"BlockOperationType\",\n            \"JoinTable\".\"CHANGENR\"                                                        AS \"SystemBlockNumber\",\n            \"JoinTable\".\"TABKEY\"                                                          AS \"SalesOrderLine_ID\",\n            \"JoinTable\".\"MANDANT\"                                                         AS \"MANDANT\",\n            \"JoinTable\".\"OBJECTCLAS\"                                                      AS \"OBJECTCLAS\",\n            \"JoinTable\".\"OBJECTID\"                                                        AS \"OBJECTID\",\n            \"JoinTable\".\"FNAME\"                                                           AS \"FNAME\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NULL\n            AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL\n    ),\n    \"CTE_MinBlock\" AS (\n        SELECT\n            \"JoinTable\".\"CHANGENR\"                                               AS \"CHANGENR\",\n            \"JoinTable\".\"TABKEY\"                                                 AS \"TABKEY\",\n            MIN(TIMESTAMPDIFF(SECOND, \"BlockFromChangelog\".\"BlockTime\", CAST(\"JoinTable\".\"UDATE\" AS DATE)\n                + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND))) AS \"LatestBlockSelector\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        LEFT JOIN \"CTE_BlockFromChangelog\" AS \"BlockFromChangelog\"\n            ON \"JoinTable\".\"MANDANT\" = \"BlockFromChangelog\".\"MANDANT\"\n                AND \"JoinTable\".\"OBJECTCLAS\" = \"BlockFromChangelog\".\"OBJECTCLAS\"\n                AND \"JoinTable\".\"OBJECTID\" = \"BlockFromChangelog\".\"OBJECTID\"\n                AND \"JoinTable\".\"TABKEY\" = \"BlockFromChangelog\".\"BlockID\"\n                AND CAST(\"JoinTable\".\"UDATE\" AS DATE)\n                    + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                        \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)\n                    >= \"BlockFromChangelog\".\"BlockTime\"\n                AND \"JoinTable\".\"FNAME\" = \"BlockFromChangelog\".\"FNAME\"\n        GROUP BY \"JoinTable\".\"CHANGENR\", \"JoinTable\".\"TABKEY\"\n    )\nSELECT\n    <%=sourceSystem%>\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 1, 3)\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 4, 10)\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 14, 6)\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 20, 4)\n        || '::'\n        || COALESCE(\"BlockFromChangelog\".\"SystemBlockNumber\", '-1') || '::'\n        || CASE\n            WHEN \"JoinTable\".\"FNAME\" = 'LIFSP' THEN 'DeliveryBlock'\n        END                                                                          AS \"ObjectID\",\n    <%=sourceSystem%> || '::' || \"JoinTable\".\"TABKEY\"\n        || '::' || \"JoinTable\".\"TABNAME\" || '::' || \"JoinTable\".\"FNAME\"\n        || '::' || \"JoinTable\".\"CHANGENR\" || '::' || \"JoinTable\".\"CHNGIND\"           AS \"ID\",\n    CAST(\"JoinTable\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND)                             AS \"Time\",\n    'LatestBlockReason'                                                              AS \"Attribute\",\n    \"JoinTable\".\"VALUE_OLD\"                                                          AS \"OldValue\",\n    \"JoinTable\".\"VALUE_NEW\"                                                          AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"JoinTable\".\"MANDANT\"\n        || '::' || \"JoinTable\".\"USERNAME\"                                            AS \"ChangedBy\",\n    \"JoinTable\".\"TCODE\"                                                              AS \"OperationType\",\n    \"JoinTable\".\"CHANGENR\"                                                           AS \"OperationID\",\n    CASE\n        WHEN \"JoinTable\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                              AS \"ExecutionType\"\nFROM \"CTE_JoinTable\" AS \"JoinTable\"\nLEFT JOIN \"CTE_MinBlock\" AS \"MinBlock\"\n    ON \"JoinTable\".\"CHANGENR\" = \"MinBlock\".\"CHANGENR\"\n        AND \"JoinTable\".\"TABKEY\" = \"MinBlock\".\"TABKEY\"\nLEFT JOIN \"CTE_BlockFromChangelog\" AS \"BlockFromChangelog\"\n    ON \"JoinTable\".\"MANDANT\" = \"BlockFromChangelog\".\"MANDANT\"\n        AND \"JoinTable\".\"OBJECTCLAS\" = \"BlockFromChangelog\".\"OBJECTCLAS\"\n        AND \"JoinTable\".\"OBJECTID\" = \"BlockFromChangelog\".\"OBJECTID\"\n        AND \"JoinTable\".\"TABKEY\" = \"BlockFromChangelog\".\"BlockID\"\n        AND CAST(\"JoinTable\".\"UDATE\" AS DATE)\n            + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)\n            >= \"BlockFromChangelog\".\"BlockTime\"\n        AND \"JoinTable\".\"FNAME\" = \"BlockFromChangelog\".\"FNAME\"\n        AND TIMESTAMPDIFF(SECOND, \"BlockFromChangelog\".\"BlockTime\", CAST(\"JoinTable\".\"UDATE\" AS DATE)\n            + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND))\n            = \"MinBlock\".\"LatestBlockSelector\"\nWHERE NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NOT NULL\n    AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL"
                    }
                ],
                "foreign_key_names": [
                    "BlockedBy",
                    "ReleasedBy",
                    "SalesOrderScheduleLine"
                ],
                "namespace": "custom",
                "property_names": [
                    "BlockExecutionType",
                    "BlockType",
                    "CreationTime",
                    "FirstBlockReason",
                    "ID",
                    "LatestBlockReason",
                    "LatestBlockReasonText",
                    "ReleaseExecutionType",
                    "ReleaseReason",
                    "ReleaseTime",
                    "ReleaseType",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineBlockAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_JoinTable\" AS (\n    SELECT\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 6)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 20, 4)                       AS \"JoinID\",\n        CAST(\"CDHDR\".\"UDATE\" AS DATE)\n            + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE),\n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)      AS \"JoinTime\",\n        \"CDHDR\".\"MANDANT\"                                                       AS \"MANDANT\",\n        \"CDHDR\".\"UDATE\"                                                         AS \"UDATE\",\n        \"CDHDR\".\"UTIME\"                                                         AS \"UTIME\",\n        \"CDPOS\".\"FNAME\"                                                         AS \"FNAME\",\n        \"CDPOS\".\"TABNAME\"                                                       AS \"TABNAME\",\n        \"CDPOS\".\"VALUE_NEW\"                                                     AS \"VALUE_NEW\",\n        \"CDPOS\".\"VALUE_OLD\"                                                     AS \"VALUE_OLD\",\n        \"CDHDR\".\"MANDANT\" || '::' || \"CDHDR\".\"USERNAME\"                         AS \"JoinUserID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C')\n                THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                     AS \"JoinExecutionType\",\n        \"CDHDR\".\"TCODE\"                                                         AS \"JoinOperationType\",\n        \"CDHDR\".\"CHANGENR\"                                                      AS \"JoinSystemNumber\",\n        \"CDPOS\".\"OBJECTCLAS\"                                                    AS \"OBJECTCLAS\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n    INNER JOIN \"CDHDR\" AS \"CDHDR\"\n        ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n            AND \"CDPOS\".\"CHNGIND\" = 'U'\n            AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n            AND \"CDPOS\".\"FNAME\" = 'LIFSP'\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n            AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n),\n    \"CTE_Releases\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"                                                                               AS \"ReleasesID\",\n            \"JoinTable\".\"JoinTime\"                                                                             AS \"ReleaseTime\",\n            \"JoinTable\".\"MANDANT\"                                                                              AS \"MANDANT\",\n            'DeliveryBlock'                                                                                    AS \"ReleaseType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\"                                                             AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                                                                            AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                                                                            AS \"VALUE_OLD\",\n            \"JoinTable\".\"JoinUserID\"                                                                           AS \"ReleasedBy_ID\",\n            \"JoinTable\".\"JoinExecutionType\"                                                                    AS \"ReleaseExecutionType\",\n            \"JoinTable\".\"JoinOperationType\"                                                                    AS \"ReleaseOperationType\",\n            \"JoinTable\".\"JoinSystemNumber\"                                                                     AS \"SystemReleaseNumber\",\n            \"JoinTable\".\"JoinID\"                                                                               AS \"SalesOrderLineID\",\n            ROW_NUMBER()\n            OVER (PARTITION BY \"JoinTable\".\"JoinID\" ORDER BY \"JoinTable\".\"UDATE\" ASC, \"JoinTable\".\"UTIME\" ASC) AS \"ReleaseRN\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE (NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NOT NULL AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NULL)\n    ),\n    \"CTE_Changes\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"                   AS \"ID\",\n            \"JoinTable\".\"JoinTime\"                 AS \"ChangeTime\",\n            \"JoinTable\".\"MANDANT\"                  AS \"MANDANT\",\n            'DeliveryBlock'                        AS \"ChangeType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\" AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                AS \"VALUE_OLD\",\n            \"JoinTable\".\"JoinUserID\"               AS \"ChangeBy\",\n            \"JoinTable\".\"JoinExecutionType\"        AS \"ChangeExecutionType\",\n            \"JoinTable\".\"JoinOperationType\"        AS \"ChangeOperationType\",\n            \"JoinTable\".\"JoinSystemNumber\"         AS \"ChangeID\",\n            \"JoinTable\".\"JoinID\"                   AS \"SalesOrderLineID\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NOT NULL\n            AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL\n    ),\n    \"CTE_BlockFromChangelog\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"                   AS \"BlockID\",\n            \"JoinTable\".\"JoinTime\"                 AS \"BlockTime\",\n            \"JoinTable\".\"MANDANT\"                  AS \"MANDANT\",\n            'DeliveryBlock'                        AS \"BlockType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\" AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                AS \"VALUE_OLD\",\n            \"JoinTable\".\"JoinUserID\"               AS \"BlockedBy\",\n            \"JoinTable\".\"JoinExecutionType\"        AS \"BlockExecutionType\",\n            \"JoinTable\".\"JoinOperationType\"        AS \"BlockOperationType\",\n            \"JoinTable\".\"JoinSystemNumber\"         AS \"SystemBlockNumber\",\n            \"JoinTable\".\"JoinID\"                   AS \"SalesOrderLineID\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE (NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NULL AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL)\n    ),\n    \"CTE_LineCreations\" AS (\n        SELECT\n            \"CDPOS\".\"TABKEY\"                                                                AS \"ID\",\n            CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR), COALESCE(SUBSTRING(\n            CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19), '23:59:59')) AS TIMESTAMP)           AS \"Time\",\n            ROW_NUMBER() OVER (\n                PARTITION BY \"CDPOS\".\"TABKEY\", \"CDPOS\".\"CHNGIND\"\n                ORDER BY CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR),\n                    COALESCE(SUBSTRING(CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19), '23:59:59')) AS TIMESTAMP) ASC\n            )                                                                               AS \"rn_asc\"\n        FROM \"CDPOS\" AS \"CDPOS\"\n        LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n            ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n        WHERE \"CDPOS\".\"TABNAME\" = 'VBEP'\n            AND \"CDPOS\".\"FNAME\" = 'KEY'\n            AND \"CDPOS\".\"CHNGIND\" IN ('I')\n            AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n    ),\n    \"CTE_ImplicitActiveBlock\" AS (\n        SELECT\n            \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\"\n                || '::' || \"VBEP\".\"POSNR\"\n                || '::' || \"VBEP\".\"ETENR\"                                                AS \"BlockID\",\n            COALESCE(\n                \"LineCreations\".\"Time\",\n                CAST(\n                    CONCAT(\n                        CAST(\"VBAP\".\"ERDAT\" AS VARCHAR),\n                        SUBSTRING(CAST(\"VBAP\".\"ERZET\" AS VARCHAR), 11, 19)\n                    ) AS TIMESTAMP\n                )\n            )                                                                            AS \"BlockTime\",\n            \"VBEP\".\"MANDT\"                                                               AS \"MANDANT\",\n            'DeliveryBlock'                                                              AS \"BlockType\",\n            'Block to ' || \"VBEP\".\"LIFSP\"                                                AS \"ValueType\",\n            \"VBEP\".\"LIFSP\"                                                               AS \"VALUE_NEW\",\n            NULL                                                                         AS \"VALUE_OLD\",\n            \"VBAP\".\"MANDT\" || '::' || \"VBAP\".\"ERNAM\"                                     AS \"BlockedBy\",\n            CASE\n                WHEN \"USR02\".\"USTYP\" IN ('B', 'C')\n                    THEN 'Automatic'\n                ELSE 'Manual'\n            END                                                                          AS \"BlockExecutionType\",\n            NULL                                                                         AS \"BlockOperationType\",\n            '-1'                                                                         AS \"SystemBlockNumber\",\n            \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' ||\n                \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"                                 AS \"SalesOrderLineID\"\n        FROM \"VBEP\" AS \"VBEP\"\n        LEFT JOIN \"CTE_BlockFromChangelog\" AS \"Block\"\n            ON \"Block\".\"BlockID\" = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"CTE_Releases\" AS \"Releases\"\n            ON \"Releases\".\"ReleasesID\"\n                = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"CTE_Changes\" AS \"Changes\"\n            ON \"Changes\".\"ID\" = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"VBAP\" AS \"VBAP\"\n            ON \"VBEP\".\"MANDT\" = \"VBAP\".\"MANDT\"\n                AND \"VBEP\".\"VBELN\" = \"VBAP\".\"VBELN\"\n                AND \"VBEP\".\"POSNR\" = \"VBAP\".\"POSNR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"VBAP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"VBAP\".\"ERNAM\" = \"USR02\".\"BNAME\"\n        LEFT JOIN \"CTE_LineCreations\" AS \"LineCreations\"\n            ON \"LineCreations\".\"ID\" = \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\" \n                AND \"LineCreations\".\"rn_asc\" = 1\n        WHERE NULLIF(\"Block\".\"BlockID\", '') IS NOT NULL\n            AND NULLIF(\"Changes\".\"ID\", '') IS NULL\n            AND NULLIF(\"Releases\".\"ReleasesID\", '') IS NULL\n            AND NULLIF(\"VBEP\".\"LIFSP\", '') IS NOT NULL\n    ),\n    \"CTE_FirstAction\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"        AS \"BlockID\",\n            MIN(\"JoinTable\".\"JoinTime\") AS \"BlockTime\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        GROUP BY \"JoinTable\".\"JoinID\"\n    ),\n    \"CTE_ImplicitInactiveBlock\" AS (\n        SELECT\n            \"FirstAction\".\"BlockID\"                                      AS \"BlockID\",\n            CAST(NULL AS TIMESTAMP)                                      AS \"BlockTime\",\n            \"VBEP\".\"MANDT\"                                               AS \"MANDANT\",\n            'DeliveryBlock'                                              AS \"BlockType\",\n            'Block to '\n                ||\n            COALESCE(\"Changes\".\"VALUE_OLD\", \"Releases\".\"VALUE_OLD\")      AS \"ValueType\",\n            COALESCE(\"Changes\".\"VALUE_OLD\", \"Releases\".\"VALUE_OLD\")      AS \"VALUE_NEW\",\n            NULL                                                         AS \"VALUE_OLD\",\n            \"VBEP\".\"MANDT\" || '::' || \"VBAP\".\"ERNAM\"                     AS \"BlockedBy\",\n            CASE\n                WHEN \"USR02\".\"USTYP\" IN ('B', 'C')\n                    THEN 'Automatic'\n                ELSE 'Manual'\n            END                                                          AS \"BlockExecutionType\",\n            NULL                                                         AS \"BlockOperationType\",\n            '-1'                                                         AS \"SystemBlockNumber\",\n            \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' ||\n                \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"                 AS \"SalesOrderLineID\"\n        FROM \"CTE_FirstAction\" AS \"FirstAction\"\n        LEFT JOIN \"CTE_Changes\" AS \"Changes\"\n            ON \"FirstAction\".\"BlockID\" = \"Changes\".\"ID\"\n                AND \"FirstAction\".\"BlockTime\" = \"Changes\".\"ChangeTime\"\n        LEFT JOIN \"CTE_Releases\" AS \"Releases\"\n            ON \"FirstAction\".\"BlockID\" = \"Releases\".\"ReleasesID\"\n                AND \"FirstAction\".\"BlockTime\" = \"Releases\".\"ReleaseTime\"\n        LEFT JOIN \"VBEP\" AS \"VBEP\"\n            ON \"FirstAction\".\"BlockID\"\n                = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"VBAP\" AS \"VBAP\"\n            ON \"VBEP\".\"MANDT\" = \"VBAP\".\"MANDT\"\n                AND \"VBEP\".\"VBELN\" = \"VBAP\".\"VBELN\"\n                AND \"VBEP\".\"POSNR\" = \"VBAP\".\"POSNR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"VBAP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"VBAP\".\"ERNAM\" = \"USR02\".\"BNAME\"\n        WHERE (NULLIF(\"Changes\".\"ID\", '') IS NOT NULL\n            OR NULLIF(\"Releases\".\"ReleasesID\", '') IS NOT NULL)\n    ),\n    \"CTE_ImplicitDuplicates\" AS (\n        SELECT\n            \"Inactive\".\"BlockID\",\n            \"Inactive\".\"BlockTime\",\n            \"Inactive\".\"BlockType\"\n        FROM \"CTE_ImplicitInactiveBlock\" AS \"Inactive\"\n        LEFT JOIN \"CTE_ImplicitActiveBlock\" AS \"Active\"\n            ON \"Inactive\".\"BlockID\" = \"Active\".\"BlockID\"\n                AND \"Inactive\".\"BlockTime\" = \"Active\".\"BlockTime\"\n                AND \"Inactive\".\"BlockType\" = \"Active\".\"BlockType\"\n        WHERE NULLIF(\"Active\".\"BlockID\", '') IS NOT NULL\n    ),\n    \"CTE_ImplicitActiveBlockNoDuplicates\" AS (\n        SELECT\n            \"Active\".*\n        FROM \"CTE_ImplicitActiveBlock\" AS \"Active\"\n        LEFT JOIN \"CTE_ImplicitDuplicates\" AS \"Duplicates\"\n            ON \"Active\".\"BlockID\" = \"Duplicates\".\"BlockID\"\n                AND \"Active\".\"BlockTime\" = \"Duplicates\".\"BlockTime\"\n                AND \"Active\".\"BlockType\" = \"Duplicates\".\"BlockType\"\n        WHERE NULLIF(\"Duplicates\".\"BlockID\", '') IS NULL\n    ),\n    \"CTE_BlockNoRN\" AS (\n        SELECT\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockID\"            AS \"BlockID\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockTime\"          AS \"BlockTime\",\n            \"ImplicitActiveBlockNoDuplicates\".\"MANDANT\"            AS \"MANDANT\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockType\"          AS \"BlockType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"ValueType\"          AS \"ValueType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"VALUE_NEW\"          AS \"VALUE_NEW\",\n            \"ImplicitActiveBlockNoDuplicates\".\"VALUE_OLD\"          AS \"VALUE_OLD\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockedBy\"          AS \"BlockedBy\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockExecutionType\" AS \"BlockExecutionType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockOperationType\" AS \"BlockOperationType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"SystemBlockNumber\"  AS \"SystemBlockNumber\",\n            \"ImplicitActiveBlockNoDuplicates\".\"SalesOrderLineID\"   AS \"SalesOrderLineID\"\n        FROM \"CTE_ImplicitActiveBlockNoDuplicates\" AS \"ImplicitActiveBlockNoDuplicates\"\n        UNION\n        SELECT\n            \"ImplicitInactiveBlock\".\"BlockID\"                      AS \"BlockID\",\n            \"ImplicitInactiveBlock\".\"BlockTime\"                    AS \"BlockTime\",\n            \"ImplicitInactiveBlock\".\"MANDANT\"                      AS \"MANDANT\",\n            \"ImplicitInactiveBlock\".\"BlockType\"                    AS \"BlockType\",\n            \"ImplicitInactiveBlock\".\"ValueType\"                    AS \"ValueType\",\n            \"ImplicitInactiveBlock\".\"VALUE_NEW\"                    AS \"VALUE_NEW\",\n            \"ImplicitInactiveBlock\".\"VALUE_OLD\"                    AS \"VALUE_OLD\",\n            \"ImplicitInactiveBlock\".\"BlockedBy\"                    AS \"BlockedBy\",\n            \"ImplicitInactiveBlock\".\"BlockExecutionType\"           AS \"BlockExecutionType\",\n            \"ImplicitInactiveBlock\".\"BlockOperationType\"           AS \"BlockOperationType\",\n            \"ImplicitInactiveBlock\".\"SystemBlockNumber\"            AS \"SystemBlockNumber\",\n            \"ImplicitInactiveBlock\".\"SalesOrderLineID\"             AS \"SalesOrderLineID\"\n        FROM \"CTE_ImplicitInactiveBlock\" AS \"ImplicitInactiveBlock\"\n        UNION\n        SELECT\n            \"BlockFromChangelog\".\"BlockID\"            AS \"BlockID\",\n            \"BlockFromChangelog\".\"BlockTime\"          AS \"BlockTime\",\n            \"BlockFromChangelog\".\"MANDANT\"            AS \"MANDANT\",\n            \"BlockFromChangelog\".\"BlockType\"          AS \"BlockType\",\n            \"BlockFromChangelog\".\"ValueType\"          AS \"ValueType\",\n            \"BlockFromChangelog\".\"VALUE_NEW\"          AS \"VALUE_NEW\",\n            \"BlockFromChangelog\".\"VALUE_OLD\"          AS \"VALUE_OLD\",\n            \"BlockFromChangelog\".\"BlockedBy\"          AS \"BlockedBy\",\n            \"BlockFromChangelog\".\"BlockExecutionType\" AS \"BlockExecutionType\",\n            \"BlockFromChangelog\".\"BlockOperationType\" AS \"BlockOperationType\",\n            \"BlockFromChangelog\".\"SystemBlockNumber\"  AS \"SystemBlockNumber\",\n            \"BlockFromChangelog\".\"SalesOrderLineID\"   AS \"SalesOrderLineID\"\n        FROM \"CTE_BlockFromChangelog\" AS \"BlockFromChangelog\"\n    ),\n    \"CTE_Block\" AS (\n        SELECT\n            *,\n            ROW_NUMBER()\n            OVER (PARTITION BY \"BlockNoRN\".\"BlockID\", \"BlockNoRN\".\"BlockType\" ORDER BY \"BlockNoRN\".\"BlockTime\" ASC) AS \"BlockRN\"\n        FROM \"CTE_BlockNoRN\" AS \"BlockNoRN\"\n    )\nSELECT\n    <%=sourceSystem%> || '::' || \"Block\".\"BlockID\" \n        || '::' || \"Block\".\"SystemBlockNumber\" \n        || '::' || \"Block\".\"BlockType\"                              AS \"ID\",\n    \"Block\".\"BlockTime\"                                             AS \"CreationTime\",\n    COALESCE(\"Block\".\"BlockType\", \"Releases\".\"ReleaseType\")         AS \"BlockType\",\n    \"Block\".\"VALUE_NEW\"                                             AS \"FirstBlockReason\",\n    CASE\n        WHEN NULLIF(\"Releases\".\"ReleaseType\", '') IS NOT NULL\n            THEN \"Releases\".\"VALUE_NEW\"\n        ELSE COALESCE(\"VBEP\".\"LIFSP\", 'Data cut - no entry in VBEP')\n    END                                                             AS \"LatestBlockReason\",\n    CASE\n        WHEN NULLIF(\"Releases\".\"ReleaseType\", '') IS NOT NULL\n            THEN \"Releases\".\"VALUE_NEW\"\n        ELSE \"TVLST\".\"VTEXT\"\n    END                                                             AS \"LatestBlockReasonText\",\n    <%=sourceSystem%> || '::' || \"Block\".\"BlockedBy\"                AS \"BlockedBy\",\n    \"Block\".\"BlockExecutionType\"                                    AS \"BlockExecutionType\",\n    \"Releases\".\"ReleaseTime\"                                        AS \"ReleaseTime\",\n    \"Releases\".\"ReleaseType\"                                        AS \"ReleaseType\",\n    \"Releases\".\"VALUE_OLD\"                                          AS \"ReleaseReason\",\n    <%=sourceSystem%> || '::' || \"Releases\".\"ReleasedBy_ID\"         AS \"ReleasedBy\",\n    \"Releases\".\"ReleaseExecutionType\"                               AS \"ReleaseExecutionType\",\n    <%=sourceSystem%> || '::' || \"Block\".\"SalesOrderLineID\"         AS \"SalesOrderScheduleLine\",\n    <%=sourceSystem%> || '::' || \"Block\".\"MANDANT\"                  AS \"SourceSystemInstance\"\nFROM \"CTE_Block\" AS \"Block\"\nLEFT JOIN \"CTE_Releases\" AS \"Releases\"\n    ON \"Block\".\"BlockID\" = \"Releases\".\"ReleasesID\"\n        AND \"Block\".\"BlockRN\" = \"Releases\".\"ReleaseRN\"\n        AND \"Block\".\"BlockType\" = \"Releases\".\"ReleaseType\"\nLEFT JOIN \"VBEP\" AS \"VBEP\"\n    ON \"Block\".\"BlockID\" = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        AND NULLIF(\"VBEP\".\"LIFSP\", '') IS NOT NULL\nLEFT JOIN \"TVLST\" AS \"TVLST\"\n    ON \"VBEP\".\"MANDT\" = \"TVLST\".\"MANDT\"\n        AND \"VBEP\".\"LIFSP\" = \"TVLST\".\"LIFSP\"\n        AND \"TVLST\".\"SPRAS\" = <%=LanguageKey%>"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1764707794149.0,
        "changed_by": {
            "id": "5477e5f1-b56c-404c-b581-116f9517bb0d",
            "name": "Robert Connolly",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749635038898.0,
        "data_connection_id": "b9f449da-3a15-43d8-89e3-0e87e54fb5af",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderLineBlock - 00. Central Extraction Pool_TS1",
        "draft": null,
        "factory_id": "6d80c8d4-708a-4963-b560-c2e419aa7105",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "LanguageKey",
                "value": "'E'"
            },
            {
                "name": "sourceSystem",
                "value": "'SAP_ECC'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLineBlock",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "CDPOS",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_JoinTable\" AS (\n    SELECT\n        \"CDPOS\".\"TABKEY\"    AS \"TABKEY\",\n        \"CDPOS\".\"MANDANT\"    AS \"MANDANT\",\n        \"CDPOS\".\"OBJECTCLAS\" AS \"OBJECTCLAS\",\n        \"CDPOS\".\"OBJECTID\"   AS \"OBJECTID\",\n        \"CDPOS\".\"FNAME\"      AS \"FNAME\",\n        \"CDPOS\".\"VALUE_NEW\"  AS \"VALUE_NEW\",\n        \"CDPOS\".\"VALUE_OLD\"  AS \"VALUE_OLD\",\n        \"CDPOS\".\"TABNAME\"    AS \"TABNAME\",\n        \"CDHDR\".\"UDATE\"      AS \"UDATE\",\n        \"CDHDR\".\"UTIME\"      AS \"UTIME\",\n        \"CDPOS\".\"CHNGIND\"    AS \"CHNGIND\",\n        \"CDHDR\".\"USERNAME\"   AS \"USERNAME\",\n        \"CDHDR\".\"TCODE\"      AS \"TCODE\",\n        \"CDHDR\".\"CHANGENR\"   AS \"CHANGENR\",\n        \"USR02\".\"USTYP\"      AS \"USTYP\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n    INNER JOIN \"CDHDR\" AS \"CDHDR\"\n        ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n            AND \"CDPOS\".\"CHNGIND\" = 'U'\n            AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n            AND \"CDPOS\".\"FNAME\" = 'LIFSP'\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n            AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n),\n    \"CTE_BlockFromChangelog\" AS (\n        SELECT\n            \"JoinTable\".\"TABKEY\"                                                          AS \"BlockID\",\n            CAST(\"JoinTable\".\"UDATE\" AS DATE)\n                + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)        AS \"BlockTime\",\n            'DeliveryBlock'                                                               AS \"BlockType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\"                                        AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                                                       AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                                                       AS \"VALUE_OLD\",\n            \"JoinTable\".\"MANDANT\" || '::' || \"JoinTable\".\"USERNAME\"                       AS \"BlockedBy\",\n            CASE\n                WHEN \"JoinTable\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n                ELSE 'Manual'\n            END                                                                           AS \"BlockExecutionType\",\n            \"JoinTable\".\"TCODE\"                                                           AS \"BlockOperationType\",\n            \"JoinTable\".\"CHANGENR\"                                                        AS \"SystemBlockNumber\",\n            \"JoinTable\".\"TABKEY\"                                                          AS \"SalesOrderLine_ID\",\n            \"JoinTable\".\"MANDANT\"                                                         AS \"MANDANT\",\n            \"JoinTable\".\"OBJECTCLAS\"                                                      AS \"OBJECTCLAS\",\n            \"JoinTable\".\"OBJECTID\"                                                        AS \"OBJECTID\",\n            \"JoinTable\".\"FNAME\"                                                           AS \"FNAME\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NULL\n            AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL\n    ),\n    \"CTE_MinBlock\" AS (\n        SELECT\n            \"JoinTable\".\"CHANGENR\"                                               AS \"CHANGENR\",\n            \"JoinTable\".\"TABKEY\"                                                 AS \"TABKEY\",\n            MIN(TIMESTAMPDIFF(SECOND, \"BlockFromChangelog\".\"BlockTime\", CAST(\"JoinTable\".\"UDATE\" AS DATE)\n                + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND))) AS \"LatestBlockSelector\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        LEFT JOIN \"CTE_BlockFromChangelog\" AS \"BlockFromChangelog\"\n            ON \"JoinTable\".\"MANDANT\" = \"BlockFromChangelog\".\"MANDANT\"\n                AND \"JoinTable\".\"OBJECTCLAS\" = \"BlockFromChangelog\".\"OBJECTCLAS\"\n                AND \"JoinTable\".\"OBJECTID\" = \"BlockFromChangelog\".\"OBJECTID\"\n                AND \"JoinTable\".\"TABKEY\" = \"BlockFromChangelog\".\"BlockID\"\n                AND CAST(\"JoinTable\".\"UDATE\" AS DATE)\n                    + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                        \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)\n                    >= \"BlockFromChangelog\".\"BlockTime\"\n                AND \"JoinTable\".\"FNAME\" = \"BlockFromChangelog\".\"FNAME\"\n        GROUP BY \"JoinTable\".\"CHANGENR\", \"JoinTable\".\"TABKEY\"\n    )\nSELECT\n    <%=sourceSystem%>\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 1, 3)\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 4, 10)\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 14, 6)\n        || '::' || SUBSTRING(\"JoinTable\".\"TABKEY\", 20, 4)\n        || '::'\n        || COALESCE(\"BlockFromChangelog\".\"SystemBlockNumber\", '-1') || '::'\n        || CASE\n            WHEN \"JoinTable\".\"FNAME\" = 'LIFSP' THEN 'DeliveryBlock'\n        END                                                                          AS \"ObjectID\",\n    <%=sourceSystem%> || '::' || \"JoinTable\".\"TABKEY\"\n        || '::' || \"JoinTable\".\"TABNAME\" || '::' || \"JoinTable\".\"FNAME\"\n        || '::' || \"JoinTable\".\"CHANGENR\" || '::' || \"JoinTable\".\"CHNGIND\"           AS \"ID\",\n    CAST(\"JoinTable\".\"UDATE\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND)                             AS \"Time\",\n    'LatestBlockReason'                                                              AS \"Attribute\",\n    \"JoinTable\".\"VALUE_OLD\"                                                          AS \"OldValue\",\n    \"JoinTable\".\"VALUE_NEW\"                                                          AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"JoinTable\".\"MANDANT\"\n        || '::' || \"JoinTable\".\"USERNAME\"                                            AS \"ChangedBy\",\n    \"JoinTable\".\"TCODE\"                                                              AS \"OperationType\",\n    \"JoinTable\".\"CHANGENR\"                                                           AS \"OperationID\",\n    CASE\n        WHEN \"JoinTable\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual'\n    END                                                                              AS \"ExecutionType\"\nFROM \"CTE_JoinTable\" AS \"JoinTable\"\nLEFT JOIN \"CTE_MinBlock\" AS \"MinBlock\"\n    ON \"JoinTable\".\"CHANGENR\" = \"MinBlock\".\"CHANGENR\"\n        AND \"JoinTable\".\"TABKEY\" = \"MinBlock\".\"TABKEY\"\nLEFT JOIN \"CTE_BlockFromChangelog\" AS \"BlockFromChangelog\"\n    ON \"JoinTable\".\"MANDANT\" = \"BlockFromChangelog\".\"MANDANT\"\n        AND \"JoinTable\".\"OBJECTCLAS\" = \"BlockFromChangelog\".\"OBJECTCLAS\"\n        AND \"JoinTable\".\"OBJECTID\" = \"BlockFromChangelog\".\"OBJECTID\"\n        AND \"JoinTable\".\"TABKEY\" = \"BlockFromChangelog\".\"BlockID\"\n        AND CAST(\"JoinTable\".\"UDATE\" AS DATE)\n            + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)\n            >= \"BlockFromChangelog\".\"BlockTime\"\n        AND \"JoinTable\".\"FNAME\" = \"BlockFromChangelog\".\"FNAME\"\n        AND TIMESTAMPDIFF(SECOND, \"BlockFromChangelog\".\"BlockTime\", CAST(\"JoinTable\".\"UDATE\" AS DATE)\n            + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"JoinTable\".\"UTIME\" AS DATE),\n                \"JoinTable\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND))\n            = \"MinBlock\".\"LatestBlockSelector\"\nWHERE NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NOT NULL\n    AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL"
                    }
                ],
                "foreign_key_names": [
                    "BlockedBy",
                    "ReleasedBy",
                    "SalesOrderScheduleLine"
                ],
                "namespace": "custom",
                "property_names": [
                    "BlockExecutionType",
                    "BlockType",
                    "CreationTime",
                    "FirstBlockReason",
                    "ID",
                    "LatestBlockReason",
                    "LatestBlockReasonText",
                    "ReleaseExecutionType",
                    "ReleaseReason",
                    "ReleaseTime",
                    "ReleaseType",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineBlockAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_JoinTable\" AS (\n    SELECT\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 10)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 14, 6)\n            || '::' || SUBSTRING(\"CDPOS\".\"TABKEY\", 20, 4)                       AS \"JoinID\",\n        CAST(\"CDHDR\".\"UDATE\" AS DATE)\n            + COALESCE(CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE),\n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND), INTERVAL '86399' SECOND)      AS \"JoinTime\",\n        \"CDHDR\".\"MANDANT\"                                                       AS \"MANDANT\",\n        \"CDHDR\".\"UDATE\"                                                         AS \"UDATE\",\n        \"CDHDR\".\"UTIME\"                                                         AS \"UTIME\",\n        \"CDPOS\".\"FNAME\"                                                         AS \"FNAME\",\n        \"CDPOS\".\"TABNAME\"                                                       AS \"TABNAME\",\n        \"CDPOS\".\"VALUE_NEW\"                                                     AS \"VALUE_NEW\",\n        \"CDPOS\".\"VALUE_OLD\"                                                     AS \"VALUE_OLD\",\n        \"CDHDR\".\"MANDANT\" || '::' || \"CDHDR\".\"USERNAME\"                         AS \"JoinUserID\",\n        CASE\n            WHEN \"USR02\".\"USTYP\" IN ('B', 'C')\n                THEN 'Automatic'\n            ELSE 'Manual'\n        END                                                                     AS \"JoinExecutionType\",\n        \"CDHDR\".\"TCODE\"                                                         AS \"JoinOperationType\",\n        \"CDHDR\".\"CHANGENR\"                                                      AS \"JoinSystemNumber\",\n        \"CDPOS\".\"OBJECTCLAS\"                                                    AS \"OBJECTCLAS\"\n    FROM \"CDPOS\" AS \"CDPOS\"\n    INNER JOIN \"CDHDR\" AS \"CDHDR\"\n        ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n            AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n            AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n            AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n            AND \"CDPOS\".\"CHNGIND\" = 'U'\n            AND \"CDPOS\".\"TABNAME\" = 'VBEP'\n            AND \"CDPOS\".\"FNAME\" = 'LIFSP'\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\n            AND \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n),\n    \"CTE_Releases\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"                                                                               AS \"ReleasesID\",\n            \"JoinTable\".\"JoinTime\"                                                                             AS \"ReleaseTime\",\n            \"JoinTable\".\"MANDANT\"                                                                              AS \"MANDANT\",\n            'DeliveryBlock'                                                                                    AS \"ReleaseType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\"                                                             AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                                                                            AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                                                                            AS \"VALUE_OLD\",\n            \"JoinTable\".\"JoinUserID\"                                                                           AS \"ReleasedBy_ID\",\n            \"JoinTable\".\"JoinExecutionType\"                                                                    AS \"ReleaseExecutionType\",\n            \"JoinTable\".\"JoinOperationType\"                                                                    AS \"ReleaseOperationType\",\n            \"JoinTable\".\"JoinSystemNumber\"                                                                     AS \"SystemReleaseNumber\",\n            \"JoinTable\".\"JoinID\"                                                                               AS \"SalesOrderLineID\",\n            ROW_NUMBER()\n            OVER (PARTITION BY \"JoinTable\".\"JoinID\" ORDER BY \"JoinTable\".\"UDATE\" ASC, \"JoinTable\".\"UTIME\" ASC) AS \"ReleaseRN\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE (NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NOT NULL AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NULL)\n    ),\n    \"CTE_Changes\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"                   AS \"ID\",\n            \"JoinTable\".\"JoinTime\"                 AS \"ChangeTime\",\n            \"JoinTable\".\"MANDANT\"                  AS \"MANDANT\",\n            'DeliveryBlock'                        AS \"ChangeType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\" AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                AS \"VALUE_OLD\",\n            \"JoinTable\".\"JoinUserID\"               AS \"ChangeBy\",\n            \"JoinTable\".\"JoinExecutionType\"        AS \"ChangeExecutionType\",\n            \"JoinTable\".\"JoinOperationType\"        AS \"ChangeOperationType\",\n            \"JoinTable\".\"JoinSystemNumber\"         AS \"ChangeID\",\n            \"JoinTable\".\"JoinID\"                   AS \"SalesOrderLineID\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NOT NULL\n            AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL\n    ),\n    \"CTE_BlockFromChangelog\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"                   AS \"BlockID\",\n            \"JoinTable\".\"JoinTime\"                 AS \"BlockTime\",\n            \"JoinTable\".\"MANDANT\"                  AS \"MANDANT\",\n            'DeliveryBlock'                        AS \"BlockType\",\n            'Block to ' || \"JoinTable\".\"VALUE_NEW\" AS \"ValueType\",\n            \"JoinTable\".\"VALUE_NEW\"                AS \"VALUE_NEW\",\n            \"JoinTable\".\"VALUE_OLD\"                AS \"VALUE_OLD\",\n            \"JoinTable\".\"JoinUserID\"               AS \"BlockedBy\",\n            \"JoinTable\".\"JoinExecutionType\"        AS \"BlockExecutionType\",\n            \"JoinTable\".\"JoinOperationType\"        AS \"BlockOperationType\",\n            \"JoinTable\".\"JoinSystemNumber\"         AS \"SystemBlockNumber\",\n            \"JoinTable\".\"JoinID\"                   AS \"SalesOrderLineID\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        WHERE (NULLIF(\"JoinTable\".\"VALUE_OLD\", '') IS NULL AND NULLIF(\"JoinTable\".\"VALUE_NEW\", '') IS NOT NULL)\n    ),\n    \"CTE_LineCreations\" AS (\n        SELECT\n            \"CDPOS\".\"TABKEY\"                                                                AS \"ID\",\n            CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR), COALESCE(SUBSTRING(\n            CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19), '23:59:59')) AS TIMESTAMP)           AS \"Time\",\n            ROW_NUMBER() OVER (\n                PARTITION BY \"CDPOS\".\"TABKEY\", \"CDPOS\".\"CHNGIND\"\n                ORDER BY CAST(CONCAT(CAST(\"CDHDR\".\"UDATE\" AS VARCHAR),\n                    COALESCE(SUBSTRING(CAST(\"CDHDR\".\"UTIME\" AS VARCHAR), 11, 19), '23:59:59')) AS TIMESTAMP) ASC\n            )                                                                               AS \"rn_asc\"\n        FROM \"CDPOS\" AS \"CDPOS\"\n        LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n            ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n        WHERE \"CDPOS\".\"TABNAME\" = 'VBEP'\n            AND \"CDPOS\".\"FNAME\" = 'KEY'\n            AND \"CDPOS\".\"CHNGIND\" IN ('I')\n            AND \"CDPOS\".\"OBJECTCLAS\" = 'VERKBELEG'\n    ),\n    \"CTE_ImplicitActiveBlock\" AS (\n        SELECT\n            \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\"\n                || '::' || \"VBEP\".\"POSNR\"\n                || '::' || \"VBEP\".\"ETENR\"                                                AS \"BlockID\",\n            COALESCE(\n                \"LineCreations\".\"Time\",\n                CAST(\n                    CONCAT(\n                        CAST(\"VBAP\".\"ERDAT\" AS VARCHAR),\n                        SUBSTRING(CAST(\"VBAP\".\"ERZET\" AS VARCHAR), 11, 19)\n                    ) AS TIMESTAMP\n                )\n            )                                                                            AS \"BlockTime\",\n            \"VBEP\".\"MANDT\"                                                               AS \"MANDANT\",\n            'DeliveryBlock'                                                              AS \"BlockType\",\n            'Block to ' || \"VBEP\".\"LIFSP\"                                                AS \"ValueType\",\n            \"VBEP\".\"LIFSP\"                                                               AS \"VALUE_NEW\",\n            NULL                                                                         AS \"VALUE_OLD\",\n            \"VBAP\".\"MANDT\" || '::' || \"VBAP\".\"ERNAM\"                                     AS \"BlockedBy\",\n            CASE\n                WHEN \"USR02\".\"USTYP\" IN ('B', 'C')\n                    THEN 'Automatic'\n                ELSE 'Manual'\n            END                                                                          AS \"BlockExecutionType\",\n            NULL                                                                         AS \"BlockOperationType\",\n            '-1'                                                                         AS \"SystemBlockNumber\",\n            \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' ||\n                \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"                                 AS \"SalesOrderLineID\"\n        FROM \"VBEP\" AS \"VBEP\"\n        LEFT JOIN \"CTE_BlockFromChangelog\" AS \"Block\"\n            ON \"Block\".\"BlockID\" = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"CTE_Releases\" AS \"Releases\"\n            ON \"Releases\".\"ReleasesID\"\n                = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"CTE_Changes\" AS \"Changes\"\n            ON \"Changes\".\"ID\" = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"VBAP\" AS \"VBAP\"\n            ON \"VBEP\".\"MANDT\" = \"VBAP\".\"MANDT\"\n                AND \"VBEP\".\"VBELN\" = \"VBAP\".\"VBELN\"\n                AND \"VBEP\".\"POSNR\" = \"VBAP\".\"POSNR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"VBAP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"VBAP\".\"ERNAM\" = \"USR02\".\"BNAME\"\n        LEFT JOIN \"CTE_LineCreations\" AS \"LineCreations\"\n            ON \"LineCreations\".\"ID\" = \"VBEP\".\"MANDT\" || \"VBEP\".\"VBELN\" || \"VBEP\".\"POSNR\" || \"VBEP\".\"ETENR\" \n                AND \"LineCreations\".\"rn_asc\" = 1\n        WHERE NULLIF(\"Block\".\"BlockID\", '') IS NOT NULL\n            AND NULLIF(\"Changes\".\"ID\", '') IS NULL\n            AND NULLIF(\"Releases\".\"ReleasesID\", '') IS NULL\n            AND NULLIF(\"VBEP\".\"LIFSP\", '') IS NOT NULL\n    ),\n    \"CTE_FirstAction\" AS (\n        SELECT\n            \"JoinTable\".\"JoinID\"        AS \"BlockID\",\n            MIN(\"JoinTable\".\"JoinTime\") AS \"BlockTime\"\n        FROM \"CTE_JoinTable\" AS \"JoinTable\"\n        GROUP BY \"JoinTable\".\"JoinID\"\n    ),\n    \"CTE_ImplicitInactiveBlock\" AS (\n        SELECT\n            \"FirstAction\".\"BlockID\"                                      AS \"BlockID\",\n            CAST(NULL AS TIMESTAMP)                                      AS \"BlockTime\",\n            \"VBEP\".\"MANDT\"                                               AS \"MANDANT\",\n            'DeliveryBlock'                                              AS \"BlockType\",\n            'Block to '\n                ||\n            COALESCE(\"Changes\".\"VALUE_OLD\", \"Releases\".\"VALUE_OLD\")      AS \"ValueType\",\n            COALESCE(\"Changes\".\"VALUE_OLD\", \"Releases\".\"VALUE_OLD\")      AS \"VALUE_NEW\",\n            NULL                                                         AS \"VALUE_OLD\",\n            \"VBEP\".\"MANDT\" || '::' || \"VBAP\".\"ERNAM\"                     AS \"BlockedBy\",\n            CASE\n                WHEN \"USR02\".\"USTYP\" IN ('B', 'C')\n                    THEN 'Automatic'\n                ELSE 'Manual'\n            END                                                          AS \"BlockExecutionType\",\n            NULL                                                         AS \"BlockOperationType\",\n            '-1'                                                         AS \"SystemBlockNumber\",\n            \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' ||\n                \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"                 AS \"SalesOrderLineID\"\n        FROM \"CTE_FirstAction\" AS \"FirstAction\"\n        LEFT JOIN \"CTE_Changes\" AS \"Changes\"\n            ON \"FirstAction\".\"BlockID\" = \"Changes\".\"ID\"\n                AND \"FirstAction\".\"BlockTime\" = \"Changes\".\"ChangeTime\"\n        LEFT JOIN \"CTE_Releases\" AS \"Releases\"\n            ON \"FirstAction\".\"BlockID\" = \"Releases\".\"ReleasesID\"\n                AND \"FirstAction\".\"BlockTime\" = \"Releases\".\"ReleaseTime\"\n        LEFT JOIN \"VBEP\" AS \"VBEP\"\n            ON \"FirstAction\".\"BlockID\"\n                = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        LEFT JOIN \"VBAP\" AS \"VBAP\"\n            ON \"VBEP\".\"MANDT\" = \"VBAP\".\"MANDT\"\n                AND \"VBEP\".\"VBELN\" = \"VBAP\".\"VBELN\"\n                AND \"VBEP\".\"POSNR\" = \"VBAP\".\"POSNR\"\n        LEFT JOIN \"USR02\" AS \"USR02\"\n            ON \"VBAP\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"VBAP\".\"ERNAM\" = \"USR02\".\"BNAME\"\n        WHERE (NULLIF(\"Changes\".\"ID\", '') IS NOT NULL\n            OR NULLIF(\"Releases\".\"ReleasesID\", '') IS NOT NULL)\n    ),\n    \"CTE_ImplicitDuplicates\" AS (\n        SELECT\n            \"Inactive\".\"BlockID\",\n            \"Inactive\".\"BlockTime\",\n            \"Inactive\".\"BlockType\"\n        FROM \"CTE_ImplicitInactiveBlock\" AS \"Inactive\"\n        LEFT JOIN \"CTE_ImplicitActiveBlock\" AS \"Active\"\n            ON \"Inactive\".\"BlockID\" = \"Active\".\"BlockID\"\n                AND \"Inactive\".\"BlockTime\" = \"Active\".\"BlockTime\"\n                AND \"Inactive\".\"BlockType\" = \"Active\".\"BlockType\"\n        WHERE NULLIF(\"Active\".\"BlockID\", '') IS NOT NULL\n    ),\n    \"CTE_ImplicitActiveBlockNoDuplicates\" AS (\n        SELECT\n            \"Active\".*\n        FROM \"CTE_ImplicitActiveBlock\" AS \"Active\"\n        LEFT JOIN \"CTE_ImplicitDuplicates\" AS \"Duplicates\"\n            ON \"Active\".\"BlockID\" = \"Duplicates\".\"BlockID\"\n                AND \"Active\".\"BlockTime\" = \"Duplicates\".\"BlockTime\"\n                AND \"Active\".\"BlockType\" = \"Duplicates\".\"BlockType\"\n        WHERE NULLIF(\"Duplicates\".\"BlockID\", '') IS NULL\n    ),\n    \"CTE_BlockNoRN\" AS (\n        SELECT\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockID\"            AS \"BlockID\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockTime\"          AS \"BlockTime\",\n            \"ImplicitActiveBlockNoDuplicates\".\"MANDANT\"            AS \"MANDANT\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockType\"          AS \"BlockType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"ValueType\"          AS \"ValueType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"VALUE_NEW\"          AS \"VALUE_NEW\",\n            \"ImplicitActiveBlockNoDuplicates\".\"VALUE_OLD\"          AS \"VALUE_OLD\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockedBy\"          AS \"BlockedBy\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockExecutionType\" AS \"BlockExecutionType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"BlockOperationType\" AS \"BlockOperationType\",\n            \"ImplicitActiveBlockNoDuplicates\".\"SystemBlockNumber\"  AS \"SystemBlockNumber\",\n            \"ImplicitActiveBlockNoDuplicates\".\"SalesOrderLineID\"   AS \"SalesOrderLineID\"\n        FROM \"CTE_ImplicitActiveBlockNoDuplicates\" AS \"ImplicitActiveBlockNoDuplicates\"\n        UNION\n        SELECT\n            \"ImplicitInactiveBlock\".\"BlockID\"                      AS \"BlockID\",\n            \"ImplicitInactiveBlock\".\"BlockTime\"                    AS \"BlockTime\",\n            \"ImplicitInactiveBlock\".\"MANDANT\"                      AS \"MANDANT\",\n            \"ImplicitInactiveBlock\".\"BlockType\"                    AS \"BlockType\",\n            \"ImplicitInactiveBlock\".\"ValueType\"                    AS \"ValueType\",\n            \"ImplicitInactiveBlock\".\"VALUE_NEW\"                    AS \"VALUE_NEW\",\n            \"ImplicitInactiveBlock\".\"VALUE_OLD\"                    AS \"VALUE_OLD\",\n            \"ImplicitInactiveBlock\".\"BlockedBy\"                    AS \"BlockedBy\",\n            \"ImplicitInactiveBlock\".\"BlockExecutionType\"           AS \"BlockExecutionType\",\n            \"ImplicitInactiveBlock\".\"BlockOperationType\"           AS \"BlockOperationType\",\n            \"ImplicitInactiveBlock\".\"SystemBlockNumber\"            AS \"SystemBlockNumber\",\n            \"ImplicitInactiveBlock\".\"SalesOrderLineID\"             AS \"SalesOrderLineID\"\n        FROM \"CTE_ImplicitInactiveBlock\" AS \"ImplicitInactiveBlock\"\n        UNION\n        SELECT\n            \"BlockFromChangelog\".\"BlockID\"            AS \"BlockID\",\n            \"BlockFromChangelog\".\"BlockTime\"          AS \"BlockTime\",\n            \"BlockFromChangelog\".\"MANDANT\"            AS \"MANDANT\",\n            \"BlockFromChangelog\".\"BlockType\"          AS \"BlockType\",\n            \"BlockFromChangelog\".\"ValueType\"          AS \"ValueType\",\n            \"BlockFromChangelog\".\"VALUE_NEW\"          AS \"VALUE_NEW\",\n            \"BlockFromChangelog\".\"VALUE_OLD\"          AS \"VALUE_OLD\",\n            \"BlockFromChangelog\".\"BlockedBy\"          AS \"BlockedBy\",\n            \"BlockFromChangelog\".\"BlockExecutionType\" AS \"BlockExecutionType\",\n            \"BlockFromChangelog\".\"BlockOperationType\" AS \"BlockOperationType\",\n            \"BlockFromChangelog\".\"SystemBlockNumber\"  AS \"SystemBlockNumber\",\n            \"BlockFromChangelog\".\"SalesOrderLineID\"   AS \"SalesOrderLineID\"\n        FROM \"CTE_BlockFromChangelog\" AS \"BlockFromChangelog\"\n    ),\n    \"CTE_Block\" AS (\n        SELECT\n            *,\n            ROW_NUMBER()\n            OVER (PARTITION BY \"BlockNoRN\".\"BlockID\", \"BlockNoRN\".\"BlockType\" ORDER BY \"BlockNoRN\".\"BlockTime\" ASC) AS \"BlockRN\"\n        FROM \"CTE_BlockNoRN\" AS \"BlockNoRN\"\n    )\nSELECT\n    <%=sourceSystem%> || '::' || \"Block\".\"BlockID\" \n        || '::' || \"Block\".\"SystemBlockNumber\" \n        || '::' || \"Block\".\"BlockType\"                              AS \"ID\",\n    \"Block\".\"BlockTime\"                                             AS \"CreationTime\",\n    COALESCE(\"Block\".\"BlockType\", \"Releases\".\"ReleaseType\")         AS \"BlockType\",\n    \"Block\".\"VALUE_NEW\"                                             AS \"FirstBlockReason\",\n    CASE\n        WHEN NULLIF(\"Releases\".\"ReleaseType\", '') IS NOT NULL\n            THEN \"Releases\".\"VALUE_NEW\"\n        ELSE COALESCE(\"VBEP\".\"LIFSP\", 'Data cut - no entry in VBEP')\n    END                                                             AS \"LatestBlockReason\",\n    CASE\n        WHEN NULLIF(\"Releases\".\"ReleaseType\", '') IS NOT NULL\n            THEN \"Releases\".\"VALUE_NEW\"\n        ELSE \"TVLST\".\"VTEXT\"\n    END                                                             AS \"LatestBlockReasonText\",\n    <%=sourceSystem%> || '::' || \"Block\".\"BlockedBy\"                AS \"BlockedBy\",\n    \"Block\".\"BlockExecutionType\"                                    AS \"BlockExecutionType\",\n    \"Releases\".\"ReleaseTime\"                                        AS \"ReleaseTime\",\n    \"Releases\".\"ReleaseType\"                                        AS \"ReleaseType\",\n    \"Releases\".\"VALUE_OLD\"                                          AS \"ReleaseReason\",\n    <%=sourceSystem%> || '::' || \"Releases\".\"ReleasedBy_ID\"         AS \"ReleasedBy\",\n    \"Releases\".\"ReleaseExecutionType\"                               AS \"ReleaseExecutionType\",\n    <%=sourceSystem%> || '::' || \"Block\".\"SalesOrderLineID\"         AS \"SalesOrderScheduleLine\",\n    <%=sourceSystem%> || '::' || \"Block\".\"MANDANT\"                  AS \"SourceSystemInstance\"\nFROM \"CTE_Block\" AS \"Block\"\nLEFT JOIN \"CTE_Releases\" AS \"Releases\"\n    ON \"Block\".\"BlockID\" = \"Releases\".\"ReleasesID\"\n        AND \"Block\".\"BlockRN\" = \"Releases\".\"ReleaseRN\"\n        AND \"Block\".\"BlockType\" = \"Releases\".\"ReleaseType\"\nLEFT JOIN \"VBEP\" AS \"VBEP\"\n    ON \"Block\".\"BlockID\" = \"VBEP\".\"MANDT\" || '::' || \"VBEP\".\"VBELN\" || '::' || \"VBEP\".\"POSNR\" || '::' || \"VBEP\".\"ETENR\"\n        AND NULLIF(\"VBEP\".\"LIFSP\", '') IS NOT NULL\nLEFT JOIN \"TVLST\" AS \"TVLST\"\n    ON \"VBEP\".\"MANDT\" = \"TVLST\".\"MANDT\"\n        AND \"VBEP\".\"LIFSP\" = \"TVLST\".\"LIFSP\"\n        AND \"TVLST\".\"SPRAS\" = <%=LanguageKey%>"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1760098147150.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "4d82ae0d-2047-4c83-ac8c-e2da04a3b5a0",
            "name": "Brave Gujral",
            "type_": "USER"
        },
        "creation_date": 1752754267869.0,
        "data_connection_id": "03736e95-3931-4eda-8dfe-fc16e11388bc",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderLineBlock - OracleFusion",
        "draft": null,
        "factory_id": "d81d6250-9879-4bf8-9087-1dbb93df4905",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "LanguageKey",
                "value": "'US'"
            },
            {
                "name": "sourceSystem",
                "value": "'Oracle_Fusion'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLineBlock",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "BlockedBy",
                    "ReleasedBy",
                    "SalesOrderScheduleLine"
                ],
                "namespace": "custom",
                "property_names": [
                    "BlockExecutionType",
                    "BlockType",
                    "CreationTime",
                    "FirstBlockReason",
                    "ID",
                    "LatestBlockReason",
                    "LatestBlockReasonText",
                    "ReleaseExecutionType",
                    "ReleaseReason",
                    "ReleaseTime",
                    "ReleaseType",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineBlockAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT <%=sourceSystem%>  \n        || '::' || \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldInstanceId\"                 AS \"ID\",\n       \"DOO_HOLD_INSTANCES\".\"HoldInstanceCreationDate\"                               AS \"CreationTime\",\n       CASE\n           WHEN \"DOO_HOLD_CODES_B\".\"HoldHoldCode\" IN ('DOO_CREDIT_CHECK', 'HOLD_FOR_CREDIT_CHECK')\n               THEN 'CreditBlock'\n           WHEN \"DOO_HOLD_CODES_B\".\"HoldHoldCode\" IN ('HOLD_FOR_SCHEDULING','HOLD_FOR_SHIPPING_INSTRUCTIONS')\n               THEN 'DeliveryBlock'\n           WHEN \"DOO_HOLD_CODES_B\".\"HoldHoldCode\" = 'DOO_INVOICE_CREATE'\n               THEN 'BillingBlock'\n           END                                                                       AS \"BlockType\",\n       \"DOO_HOLD_CODES_B\".\"HoldHoldCode\"                                             AS \"FirstBlockReason\",\n        CASE\n           WHEN \"DOO_HOLD_INSTANCES\".\"HoldInstanceActiveFlag\" = 'Y'\n               THEN \"DOO_HOLD_CODES_B\".\"HoldHoldCode\" \n        END                                                                          AS \"LatestBlockReason\",\n        CASE\n           WHEN \"DOO_HOLD_INSTANCES\".\"HoldInstanceActiveFlag\" = 'Y'\n               THEN \"DOO_HOLD_CODES_B\".\"HoldTranslationHoldDescription\" \n        END                                                                          AS \"LatestBlockReasonText\",\n       <%=sourceSystem%> || '::' ||  \"DOO_HOLD_INSTANCES\".\"HoldInstanceCreatedBy\"    AS \"BlockedBy\",\n       'Automatic'                                                                   AS \"BlockExecutionType\",\n       \"DOO_HOLD_INSTANCES\".\"HoldInstanceReleaseDate\"                                AS \"ReleaseTime\",\n       CASE\n           WHEN \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldReleaseReasonCode\" LIKE '%CREDIT%'\n               THEN 'CreditBlock'\n           WHEN (\"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldReleaseReasonCode\" LIKE '%SCHEDULING%' OR\n                 \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldReleaseReasonCode\" LIKE '%SHIPPING%')\n               THEN 'DeliveryBlock'\n           WHEN \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldReleaseReasonCode\" LIKE '%INVOICE%'\n               THEN 'BillingBlock'\n           END                                                                       AS \"ReleaseType\",\n       \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldReleaseReasonCode\"                      AS \"ReleaseReason\",\n       <%=sourceSystem%> || '::' || \"DOO_HOLD_INSTANCES\".\"HoldInstanceReleaseUserId\" AS \"ReleasedBy\",\n       CASE\n           WHEN \"DOO_HOLD_INSTANCES\".\"HoldInstanceReleaseUserId\" IS NOT NULL\n               THEN 'Manual'\n           WHEN \"DOO_HOLD_INSTANCES\".\"HoldInstanceReleaseUserId\" IS NULL\n               AND \"DOO_HOLD_INSTANCES\".\"HoldInstanceActiveFlag\" = 'N'\n               THEN 'Automatic'\n           END                                                                      AS \"ReleaseExecutionType\",\n        <%=sourceSystem%>                                                           AS \"SourceSystemInstance\",\n        <%=sourceSystem%>  \n        || '::' || \"DOO_HOLD_INSTANCES\".\"HoldInstanceTransactionEntityId1\"          AS \"SalesOrderScheduleLine\"\nFROM \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_HoldInstanceExtractPVO\" AS \"DOO_HOLD_INSTANCES\"\n         LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_HoldCodeExtractPVO\" AS \"DOO_HOLD_CODES_B\"\n                   ON \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldCodeId\" = \"DOO_HOLD_CODES_B\".\"HoldHoldCodeId\"\n                       AND  \"DOO_HOLD_CODES_B\".\"HoldTranslationLanguage\" = <%=LanguageKey%> -- TODO: Parameter (LanguageKey = 'US')\n         LEFT JOIN \"FscmTopModelAM_ScmExtractAM_DooBiccExtractAM_LineExtractPVO\" AS \"DOO_LINES_ALL\"\n                   ON \"DOO_HOLD_INSTANCES\".\"HoldInstanceTransactionEntityId1\" = \"DOO_LINES_ALL\".\"LineId\"\n         LEFT JOIN \"FscmTopModelAM_FinExtractAM_AnalyticsExtractServiceAM_LookupValuesTLExtractPVO\" AS \"FND_LOOKUP_VALUES\"\n                   ON \"DOO_HOLD_INSTANCES\".\"HoldInstanceHoldReleaseReasonCode\" = \"FND_LOOKUP_VALUES\".\"LookupCode\"\n                       AND \"FND_LOOKUP_VALUES\".\"LookupType\" = 'DOO_HLD_RELEASE_REASON'\n                       AND \"FND_LOOKUP_VALUES\".\"ViewApplicationId\" = '0'\n                       AND \"FND_LOOKUP_VALUES\".\"Language\" = <%=LanguageKey%> \nWHERE \"DOO_HOLD_INSTANCES\".\"HoldInstanceTransactionEntityId1\" IS NOT NULL\n  AND \"DOO_HOLD_INSTANCES\".\"HoldInstanceTransactionEntityName1\" = 'DOO_ORDER_FLINES_V'\n  AND \"DOO_HOLD_CODES_B\".\"HoldHoldCode\" IN\n      ('DOO_CREDIT_CHECK', 'HOLD_FOR_CREDIT_CHECK', 'HOLD_FOR_SCHEDULING', 'DOO_INVOICE_CREATE','HOLD_FOR_SHIPPING_INSTRUCTIONS')"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1760098147150.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "4d82ae0d-2047-4c83-ac8c-e2da04a3b5a0",
            "name": "Brave Gujral",
            "type_": "USER"
        },
        "creation_date": 1749651471007.0,
        "data_connection_id": "42d53587-d7fa-45cf-8403-26770d8029d0",
        "description": null,
        "disabled": null,
        "display_name": "SalesOrderLineBlock - Oracle EBS",
        "draft": null,
        "factory_id": "3694288a-f030-4abd-87c5-81721e56c775",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "LanguageKey",
                "value": "'US'"
            },
            {
                "name": "sourceSystem",
                "value": "'Oracle_EBS'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "SalesOrderScheduleLineBlock",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "BlockedBy",
                    "ReleasedBy",
                    "SalesOrderScheduleLine"
                ],
                "namespace": "custom",
                "property_names": [
                    "BlockExecutionType",
                    "BlockType",
                    "CreationTime",
                    "FirstBlockReason",
                    "ID",
                    "LatestBlockReason",
                    "LatestBlockReasonText",
                    "ReleaseExecutionType",
                    "ReleaseReason",
                    "ReleaseTime",
                    "ReleaseType",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "SalesOrderLineBlockAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_SalesOrderScheduleLineBlock\" AS\n(\n--Credit Block\n SELECT\n    <%=sourceSystem%>  \n    || '::' || CAST(\"OE_ORDER_HOLDS_ALL\".\"ORDER_HOLD_ID\" AS VARCHAR(255))         AS \"ID\",\n    \"OE_ORDER_HOLDS_ALL\".\"CREATION_DATE\"                                          AS \"CreationTime\",\n    'CreditBlock'                                                                 AS \"BlockType\",\n    \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\"                                             AS \"FirstBlockReason\",\n    CASE\n        WHEN \"OE_ORDER_HOLDS_ALL\".\"RELEASED_FLAG\" = 'N' \n        THEN \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\"\n    END                                                                           AS \"LatestBlockReason\",\n    CASE\n        WHEN \"OE_ORDER_HOLDS_ALL\".\"RELEASED_FLAG\" = 'N' \n        THEN \"FND_LOOKUP_VALUES\".\"MEANING\"\n    END                                                                           AS \"LatestBlockReasonText\",\n    <%=sourceSystem%>  || '::' || \"OE_ORDER_HOLDS_ALL\".\"CREATED_BY\"               AS \"BlockedBy\",\n    'Automatic'                                                                   AS \"BlockExecutionType\",\n    \"OE_HOLD_RELEASES\".\"CREATION_DATE\"                                            AS \"ReleaseTime\",\n    CASE\n        WHEN \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" IS NOT NULL \n        THEN 'CreditBlock'\n    END                                                                           AS \"ReleaseType\",\n    \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\"                                      AS \"ReleaseReason\",\n    <%=sourceSystem%>  || '::' ||\"OE_HOLD_RELEASES\".\"CREATED_BY\"                  AS \"ReleasedBy\",\n    CASE\n        WHEN \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" LIKE '%AUTOMATIC%'\n             OR \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" = 'OM_CLOSE'\n             OR \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" = 'OM_CANCEL' \n             THEN 'Automatic'\n        WHEN \"OE_ORDER_HOLDS_ALL\".\"RELEASED_FLAG\" = 'Y' \n             THEN 'Manual'\n    END                                                                           AS \"ReleaseExecutionType\",\n       <%=sourceSystem%>                                                          AS \"SourceSystemInstance\",\n       <%=sourceSystem%>  || '::'|| \"OE_ORDER_HOLDS_ALL\".\"LINE_ID\"                AS \"SalesOrderScheduleLine\"\nFROM \"OE_ORDER_HOLDS_ALL\" AS \"OE_ORDER_HOLDS_ALL\"\n         LEFT JOIN \"OE_HOLD_SOURCES_ALL\" AS \"OE_HOLD_SOURCES_ALL\"\n                   ON \"OE_ORDER_HOLDS_ALL\".\"HOLD_SOURCE_ID\" = \"OE_HOLD_SOURCES_ALL\".\"HOLD_SOURCE_ID\"\n                       AND \"OE_ORDER_HOLDS_ALL\".\"ORG_ID\" = \"OE_HOLD_SOURCES_ALL\".\"ORG_ID\"\n         LEFT JOIN \"OE_HOLD_DEFINITIONS\" AS \"OE_HOLD_DEFINITIONS\"\n                   ON \"OE_HOLD_SOURCES_ALL\".\"HOLD_ID\" = \"OE_HOLD_DEFINITIONS\".\"HOLD_ID\"\n         LEFT JOIN \"OE_HOLD_RELEASES\" AS \"OE_HOLD_RELEASES\"\n                   ON \"OE_ORDER_HOLDS_ALL\".\"HOLD_RELEASE_ID\" = \"OE_HOLD_RELEASES\".\"HOLD_RELEASE_ID\"\n         LEFT JOIN \"FND_LOOKUP_VALUES\" AS \"FND_LOOKUP_VALUES\"\n                   ON \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\" = \"FND_LOOKUP_VALUES\".\"LOOKUP_CODE\"\n                       AND \"FND_LOOKUP_VALUES\".\"ZD_EDITION_NAME\" = 'SET1' \n                       AND \"FND_LOOKUP_VALUES\".\"LOOKUP_TYPE\" = 'HOLD_TYPE'\n                       AND \"FND_LOOKUP_VALUES\".\"VIEW_APPLICATION_ID\" = '660'\n                       AND \"FND_LOOKUP_VALUES\".\"LANGUAGE\" = <%=LanguageKey%> \nWHERE \"OE_ORDER_HOLDS_ALL\".\"LINE_ID\" IS NOT NULL\n  AND \"OE_HOLD_SOURCES_ALL\".\"HOLD_ENTITY_CODE\" != 'C'\n  AND \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\" = 'CREDIT'\n  UNION\n--Billing and Delivery Block\nSELECT   <%=sourceSystem%>  \n         || '::' || CAST(\"OE_ORDER_HOLDS_ALL\".\"ORDER_HOLD_ID\" AS VARCHAR(255))   AS \"ID\",\n       \"OE_ORDER_HOLDS_ALL\".\"CREATION_DATE\"                                      AS \"CreationTime\",\n       CASE\n           WHEN \"OE_HOLD_DEFINITIONS\".\"ACTIVITY_NAME\"\n               IN ('HEADER_INVOICE_INTERFACE', 'INVOICE_INTERFACE')\n               THEN 'BillingBlock'\n           ELSE 'DeliveryBlock'\n       END                                                                      AS \"BlockType\",\n       \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\"                                        AS \"FirstBlockReason\",\n       CASE\n           WHEN \"OE_ORDER_HOLDS_ALL\".\"RELEASED_FLAG\" = 'N'\n               THEN \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\" \n        END                                                                     AS \"LatestBlockReason\",\n       CASE\n           WHEN \"OE_ORDER_HOLDS_ALL\".\"RELEASED_FLAG\" = 'N'\n               THEN \"FND_LOOKUP_VALUES\".\"MEANING\" \n       END                                                                      AS \"LatestBlockReasonText\",\n       <%=sourceSystem%>  || '::' || \"OE_ORDER_HOLDS_ALL\".\"CREATED_BY\"          AS \"BlockedBy\",\n       CASE\n           WHEN \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\" = 'HOLD' THEN 'Manual'\n           ELSE 'Automatic'\n           END                                                                  AS \"BlockExecutionType\",\n      \"OE_HOLD_RELEASES\".\"CREATION_DATE\"                                        AS \"ReleaseTime\",\n       CASE\n           WHEN \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" IS NOT NULL\n               THEN CASE\n                        WHEN \"OE_HOLD_DEFINITIONS\".\"ACTIVITY_NAME\"\n                            IN ('HEADER_INVOICE_INTERFACE', 'INVOICE_INTERFACE')\n                            THEN 'BillingBlock'\n                        ELSE 'DeliveryBlock' END\n           END                                                                  AS \"ReleaseType\",\n       \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\"                                 AS \"ReleaseReason\",\n       <%=sourceSystem%>  || '::' || \"OE_HOLD_RELEASES\".\"CREATED_BY\"            AS \"ReleasedBy\",\n       CASE\n           WHEN \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" LIKE '%AUTOMATIC%'\n               OR \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" = 'OM_CLOSE'\n               OR \"OE_HOLD_RELEASES\".\"RELEASE_REASON_CODE\" = 'OM_CANCEL'\n               THEN 'Automatic'\n           WHEN \"OE_ORDER_HOLDS_ALL\".\"RELEASED_FLAG\" = 'Y'\n                       THEN 'Manual'\n           END                                                                  AS \"ReleaseExecutionType\",\n      <%=sourceSystem%>                                                         AS \"SourceSystemInstance\",\n      <%=sourceSystem%>  || '::' || \"OE_ORDER_HOLDS_ALL\".\"LINE_ID\"              AS \"SalesOrderScheduleLine\"\nFROM \"OE_ORDER_HOLDS_ALL\" AS \"OE_ORDER_HOLDS_ALL\"\n         LEFT JOIN \"OE_HOLD_SOURCES_ALL\" AS \"OE_HOLD_SOURCES_ALL\"\n                   ON \"OE_ORDER_HOLDS_ALL\".\"HOLD_SOURCE_ID\" = \"OE_HOLD_SOURCES_ALL\".\"HOLD_SOURCE_ID\"\n                       AND \"OE_ORDER_HOLDS_ALL\".\"ORG_ID\" = \"OE_HOLD_SOURCES_ALL\".\"ORG_ID\"\n         LEFT JOIN \"OE_HOLD_DEFINITIONS\" AS \"OE_HOLD_DEFINITIONS\"\n                   ON \"OE_HOLD_SOURCES_ALL\".\"HOLD_ID\" = \"OE_HOLD_DEFINITIONS\".\"HOLD_ID\"\n         LEFT JOIN \"OE_HOLD_RELEASES\" AS \"OE_HOLD_RELEASES\"\n                   ON \"OE_ORDER_HOLDS_ALL\".\"HOLD_RELEASE_ID\" = \"OE_HOLD_RELEASES\".\"HOLD_RELEASE_ID\"\n         LEFT JOIN \"FND_LOOKUP_VALUES\" AS \"FND_LOOKUP_VALUES\"\n                   ON \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\" = \"FND_LOOKUP_VALUES\".\"LOOKUP_CODE\"\n                       AND \"FND_LOOKUP_VALUES\".\"ZD_EDITION_NAME\" = 'SET1' \n                       AND \"FND_LOOKUP_VALUES\".\"LOOKUP_TYPE\" = 'HOLD_TYPE'\n                       AND \"FND_LOOKUP_VALUES\".\"VIEW_APPLICATION_ID\" = '660'\n                       AND \"FND_LOOKUP_VALUES\".\"LANGUAGE\" = <%=LanguageKey%> \nWHERE \"OE_ORDER_HOLDS_ALL\".\"LINE_ID\" IS NOT NULL\n  AND \"OE_HOLD_DEFINITIONS\".\"TYPE_CODE\" != 'CREDIT'\n  AND \"OE_HOLD_SOURCES_ALL\".\"HOLD_ENTITY_CODE\" != 'C'\n  AND \"OE_HOLD_DEFINITIONS\".\"ACTIVITY_NAME\" IN ('HEADER_INVOICE_INTERFACE', 'INVOICE_INTERFACE', 'LINE_SCHEDULING'))\nSELECT\n    \"ID\"                    AS \"ID\",\n    \"CreationTime\"          AS \"CreationTime\",\n    \"BlockType\"             AS \"BlockType\",\n    \"FirstBlockReason\"      AS \"FirstBlockReason\",\n    \"LatestBlockReason\"     AS \"LatestBlockReason\",\n    \"LatestBlockReasonText\" AS \"LatestBlockReasonText\",\n    \"BlockedBy\"             AS \"BlockedBy\",\n    \"BlockExecutionType\"    AS \"BlockExecutionType\",\n    \"ReleaseTime\"           AS \"ReleaseTime\",\n    \"ReleaseType\"           AS \"ReleaseType\",\n    \"ReleaseReason\"         AS \"ReleaseReason\",\n    \"ReleasedBy\"            AS \"ReleasedBy\",\n    \"ReleaseExecutionType\"  AS \"ReleaseExecutionType\",\n    \"SourceSystemInstance\"  AS \"SourceSystemInstance\",\n    \"SalesOrderScheduleLine\"        AS \"SalesOrderScheduleLine\"\nFROM  \"CTE_SalesOrderScheduleLineBlock\""
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]