[
    {
        "change_date": 1763396111724.0,
        "changed_by": {
            "id": "5477e5f1-b56c-404c-b581-116f9517bb0d",
            "name": "Robert Connolly",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749634583036.0,
        "data_connection_id": "b9f449da-3a15-43d8-89e3-0e87e54fb5af",
        "description": null,
        "disabled": null,
        "display_name": "ReceivableItem - 00. Central Extraction Pool_TS1",
        "draft": null,
        "factory_id": "91a2f2b5-ac62-4aaf-aef7-f92805f88e5d",
        "factory_validation_status": "VALID",
        "has_user_template": true,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_ECC'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "ReceivableItem",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Clearing",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    \n    CASE\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN <%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::' || \"BKPF_PAY\".\"BUKRS\" || '::' || \"BKPF_PAY\".\"BELNR\" || '::' || \"BKPF_PAY\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END  \n     || <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \n     \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"\n                                                                                                                        AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \"BSEG\".\"BELNR\" || '::' || \n        \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                                                                        AS \"ObjectID\", \n    CASE\n\t    WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN CAST(\"BKPF_PAY\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF_PAY\".\"CPUTM\" AS DATE), \n                \"BKPF_PAY\".\"CPUTM\") AS INTERVAL SECOND) + INTERVAL '2' SECOND\n        ELSE CAST(\"BSEG\".\"AUGDT\" AS DATE) + INTERVAL '86399' SECOND\n     END                                                                                                                AS \"Time\",\n    'Clearing'                                                                                                          AS \"Attribute\",\n    NULL                                                                                                                AS \"OldValue\",\n    NULL                                                                                                                AS \"NewValue\",\n    CASE\n\t    WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN \"BKPF_PAY\".\"MANDT\" || '::' || \"BKPF_PAY\".\"USNAM\"\n        ELSE NULL \n     END                                                                                                                AS \"ChangedBy\",\n    NULL                                                                                                                AS \"OperationType\",\n    CASE\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN <%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::' || \"BKPF_PAY\".\"BUKRS\" || '::' || \"BKPF_PAY\".\"BELNR\" || '::' || \"BKPF_PAY\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END                                                                                                                AS \"OperationID\",\n    CASE\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL AND \"USR02\".\"USTYP\" IN ('B', 'C')\n\t        THEN 'Automatic'\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL AND \"USR02\".\"USTYP\" NOT IN ('B', 'C')\n            THEN 'Manual' \n        ELSE NULL\n     END                                                                                                                AS \"ExecutionType\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF_PAY\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                       AND \"BSEG\".\"AUGBL\" = \"BKPF_PAY\".\"BELNR\"\n                       AND \"BSEG\".\"AUGGJ\" = \"BKPF_PAY\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF_PAY\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF_PAY\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"AUGBL\" IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('01', '11')\n\n"
                    },
                    {
                        "id": "IncomingPayment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\" || \n        <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                   AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                   AS \"ObjectID\",\n    CAST(\"BKPF_PAY\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF_PAY\".\"CPUTM\" AS DATE), \n                \"BKPF_PAY\".\"CPUTM\") AS INTERVAL SECOND)                                         AS \"Time\",\n    'IncomingPayment'                                                                           AS \"Attribute\",\n    NULL                                                                                        AS \"OldValue\",\n    NULL                                                                                        AS \"NewValue\",\n\tCASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                        AS \"ExecutionType\",\n\t<%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::'  || \"BKPF_PAY\".\"USNAM\"              AS \"ChangedBy\",\n    NULL                                                                                        AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\"          AS \"OperationID\"\nFROM \"BSEG\" AS \"BSEG\"\n\tLEFT JOIN \"BKPF\" AS \"BKPF_PAY\"\n\t    ON \"BSEG\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                AND \"BSEG\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                AND \"BSEG\".\"AUGBL\" = \"BKPF_PAY\".\"BELNR\"\n                AND \"BSEG\".\"AUGGJ\" = \"BKPF_PAY\".\"GJAHR\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAY\"\n                   ON \"BSEG_PAY\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                       AND \"BSEG_PAY\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                       AND \"BSEG_PAY\".\"BELNR\" = \"BKPF_PAY\".\"BELNR\"\n                       AND \"BSEG_PAY\".\"GJAHR\" = \"BKPF_PAY\".\"GJAHR\"\n                       AND \"BSEG_PAY\".\"BSCHL\" IN ('15', '16')\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF_PAY\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"BKPF_PAY\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG_PAY\".\"MANDT\" IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" = '01'\n"
                    },
                    {
                        "id": "PartialPayment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\"          AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                   AS \"ObjectID\",\n    CAST(\"BKPF_PAY\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF_PAY\".\"CPUTM\" AS DATE), \n                \"BKPF_PAY\".\"CPUTM\") AS INTERVAL SECOND)                                         AS \"Time\",\n    'IncomingPayment'                                                                           AS \"Attribute\",\n    NULL                                                                                        AS \"OldValue\",\n    NULL                                                                                        AS \"NewValue\",\n\tCASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                        AS \"ExecutionType\",\n\t<%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::'  || \"BKPF_PAY\".\"USNAM\"              AS \"ChangedBy\",\n    NULL                                                                                        AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\"          AS \"OperationID\"\nFROM \"BSEG\" AS \"BSEG\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAY\"\n                   ON \"BSEG_PAY\".\"MANDT\" = \"BSEG\".\"MANDT\"\n                       AND \"BSEG_PAY\".\"BUKRS\" = \"BSEG\".\"BUKRS\"\n                       AND \"BSEG_PAY\".\"REBZG\" = \"BSEG\".\"BELNR\"\n                       AND \"BSEG_PAY\".\"REBZJ\" = \"BSEG\".\"GJAHR\"\n                       AND \"BSEG_PAY\".\"REBZZ\" = \"BSEG\".\"BUZEI\"\n                       AND \"BSEG_PAY\".\"BSCHL\" IN ('15', '16')\n    LEFT JOIN \"BKPF\" AS \"BKPF_PAY\"\n\t    ON \"BSEG_PAY\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                AND \"BSEG_PAY\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                AND \"BSEG_PAY\".\"BELNR\" = \"BKPF_PAY\".\"BELNR\"\n                AND \"BSEG_PAY\".\"GJAHR\" = \"BKPF_PAY\".\"GJAHR\"\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF_PAY\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"BKPF_PAY\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"BSCHL\" = '01'\n    AND \"BSEG_PAY\".\"MANDT\" IS NOT NULL\n"
                    },
                    {
                        "id": "ReceivableItemChanges",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" || '::' || \"CDPOS\".\"FNAME\" \n        || '::' || \"CDPOS\".\"CHANGENR\" || '::' || \"CDPOS\".\"CHNGIND\"              AS \"ID\",\n    <%=sourceSystem%> || '::' || \n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 4)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 8, 10) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 18, 4) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 22, 3)                                       AS \"ObjectID\",\n\tCAST(\"CDHDR\".\"UDATE\" AS DATE) +\n            CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                AS \"Time\",\n\tCASE\n           WHEN \"CDPOS\".\"FNAME\" = 'MANST' THEN 'DunningLevel'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaselineDate'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n           WHEN \"CDPOS\".\"FNAME\" = 'MANSP' THEN 'DunningBlock'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-',REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" \n     END                                                                        AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n     END                                                                        AS \"NewValue\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"MANDANT\" || '::' || \n        \"CDHDR\".\"USERNAME\"                                                      AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"CHANGENR\"                             AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                        AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"ObjectID\" = \"CDHDR\".\"ObjectID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'BELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS\".\"TABNAME\" = 'BSEG'\n  AND \"CDPOS\".\"FNAME\" IN ('MANST', 'ZFBDT', 'ZTERM', 'MANSP')\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL\n  AND \"CDHDR\".\"MANDANT\" IS NOT NULL\n"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Customer",
                    "CustomerInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "BaselineDate",
                    "BusinessUnit",
                    "CashDiscountDueDate1",
                    "CashDiscountDueDate2",
                    "CashDiscountEligibleAmount",
                    "CashDiscountPercentage1",
                    "CashDiscountPercentage2",
                    "CashDiscountTakenAmount",
                    "ClearingDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "DebitCreditIndicator",
                    "DocumentCategory",
                    "DocumentDate",
                    "DocumentNumber",
                    "DocumentType",
                    "FiscalYear",
                    "ID",
                    "IsBlockedForDunning",
                    "IsReversed",
                    "NetDueDate",
                    "PaymentTerm",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "ReceivableItemAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"       AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\"                                     AS \"SourceSystemInstance\",\n\tCASE\n        WHEN \"BSEG\".\"MANSP\" IS NOT NULL \n            THEN  TRUE \n        ELSE FALSE \n     END                                                                            AS \"IsBlockedForDunning\",\n\tCASE\n        WHEN \"BKPF\".\"XREVERSAL\" IS NOT NULL \n            THEN True\n        ELSE False\n     END                                                                            AS \"IsReversed\",\n\tCASE\n        WHEN \"BSEG\".\"SHKZG\" = 'S' THEN 'Debit'\n        WHEN \"BSEG\".\"SHKZG\" = 'H' THEN 'Credit'\n     END                                                                            AS \"DebitCreditIndicator\",\n\tCAST( CASE\n        WHEN \"BSEG\".\"ZBD3T\" > 0\n            THEN \n                CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD3T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n        WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" > 0\n            THEN \n                CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n        WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" = 0 AND \"BSEG\".\"ZBD1T\" > 0\n            THEN \n                CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n        ELSE \"BSEG\".\"ZFBDT\" + INTERVAL '86399' SECOND\n     END AS TIMESTAMP)                                                              AS \"NetDueDate\",\n    \"BKPF\".\"BLART\"                                                                  AS \"DocumentType\",\n\t\"BSEG\".\"ZTERM\"                                                                  AS \"PaymentTerm\",\n\t\"BKPF\".\"WAERS\"                                                                  AS \"Currency\",\n\t\"BSEG\".\"WSKTO\"                                                                  AS \"CashDiscountTakenAmount\",\n\t\"BSEG\".\"SKFBT\"                                                                  AS \"CashDiscountEligibleAmount\",\n    \"BSEG\".\"ZBD2P\"                                                                  AS \"CashDiscountPercentage2\",\n    \"BSEG\".\"ZBD1P\"                                                                  AS \"CashDiscountPercentage1\",\n    CASE \n        WHEN \"BSEG\".\"ZBD2P\" > 0 \n        THEN \n            CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n     END                                                                            AS \"CashDiscountDueDate2\",\n    CASE\n        WHEN \"BSEG\".\"ZBD1P\" > 0 \n        THEN \n            CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n     END                                                                            AS \"CashDiscountDueDate1\",\n\t\"BSEG\".\"WRBTR\" * \n    CASE \n        WHEN \"BSEG\".\"SHKZG\" = 'H' THEN -1.0 \n        ELSE 1.0 \n     END                                                                            AS \"Amount\",\n\tCAST(\"BSEG\".\"AUGDT\" AS TIMESTAMP)                                               AS \"ClearingDate\",\n\tCAST(\"BKPF\".\"BLDAT\" AS TIMESTAMP)                                               AS \"DocumentDate\",\n\tCAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP)                                               AS \"BaselineDate\",\n    CASE\n        WHEN \"BSEG\".\"BSCHL\" = '01' THEN 'CustomerInvoice'\n        WHEN \"BSEG\".\"BSCHL\" = '11' THEN 'CreditMemo'\n     END                                                                            AS \"DocumentCategory\",\n\tCAST(\"BSEG\".\"GJAHR\" AS BIGINT)                                                  AS \"FiscalYear\",\n\t\"BSEG\".\"BELNR\"                                                                  AS \"DocumentNumber\",\n    \"T001\".\"BUTXT\"                                                                  AS \"BusinessUnit\",\n\tCAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n            \"BKPF\".\"CPUTM\") AS INTERVAL SECOND)                                     AS \"CreationTime\",\n\tCASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END      AS \"CreationExecutionType\",\n\t<%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"           AS \"CreatedBy\",\n    CASE \n        WHEN \"BKPF\".\"AWTYP\" = 'VBRK' AND \"BSEG\".\"BSCHL\" IN ('01', '11') \n            THEN <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"AWKEY\" \n     END                                                                            AS \"CustomerInvoice\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"KUNNR\"           AS \"Customer\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"BELNR\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"GJAHR\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"BSEG\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE \"BSEG\".\"MANDT\" IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('01', '11')\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1763396111724.0,
        "changed_by": {
            "id": "5477e5f1-b56c-404c-b581-116f9517bb0d",
            "name": "Robert Connolly",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1752508725024.0,
        "data_connection_id": "8939ad05-4472-435c-a065-ed31be1b9fea",
        "description": null,
        "disabled": null,
        "display_name": "ReceivableItem - SAP S4",
        "draft": null,
        "factory_id": "90214f75-264f-4671-a113-6f921bc57b21",
        "factory_validation_status": "VALID",
        "has_user_template": true,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "'SAP_S4_HANA'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "ReceivableItem",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Clearing",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    \n    CASE\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN <%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::' || \"BKPF_PAY\".\"BUKRS\" || '::' || \"BKPF_PAY\".\"BELNR\" || '::' || \"BKPF_PAY\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END  \n     || <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \n     \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"\n                                                                                                                        AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \"BSEG\".\"BELNR\" || '::' || \n        \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                                                                        AS \"ObjectID\", \n    CASE\n\t    WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN CAST(\"BKPF_PAY\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF_PAY\".\"CPUTM\" AS DATE), \n                \"BKPF_PAY\".\"CPUTM\") AS INTERVAL SECOND) + INTERVAL '2' SECOND\n        ELSE CAST(\"BSEG\".\"AUGDT\" AS DATE) + INTERVAL '86399' SECOND\n     END                                                                                                                AS \"Time\",\n    'Clearing'                                                                                                          AS \"Attribute\",\n    NULL                                                                                                                AS \"OldValue\",\n    NULL                                                                                                                AS \"NewValue\",\n    CASE\n\t    WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN \"BKPF_PAY\".\"MANDT\" || '::' || \"BKPF_PAY\".\"USNAM\"\n        ELSE NULL \n     END                                                                                                                AS \"ChangedBy\",\n    NULL                                                                                                                AS \"OperationType\",\n    CASE\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL\n            THEN <%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::' || \"BKPF_PAY\".\"BUKRS\" || '::' || \"BKPF_PAY\".\"BELNR\" || '::' || \"BKPF_PAY\".\"GJAHR\" \n        ELSE <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' || \"BSEG\".\"AUGBL\" || '::' || \"BSEG\".\"AUGGJ\" \n     END                                                                                                                AS \"OperationID\",\n    CASE\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL AND \"USR02\".\"USTYP\" IN ('B', 'C')\n\t        THEN 'Automatic'\n        WHEN \"BKPF_PAY\".\"MANDT\" IS NOT NULL AND \"USR02\".\"USTYP\" NOT IN ('B', 'C')\n            THEN 'Manual' \n        ELSE NULL\n     END                                                                                                                AS \"ExecutionType\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF_PAY\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                       AND \"BSEG\".\"AUGBL\" = \"BKPF_PAY\".\"BELNR\"\n                       AND \"BSEG\".\"AUGGJ\" = \"BKPF_PAY\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF_PAY\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF_PAY\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"AUGBL\" IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('01', '11')\n\n"
                    },
                    {
                        "id": "IncomingPayment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\" || \n        <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                   AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                   AS \"ObjectID\",\n    CAST(\"BKPF_PAY\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF_PAY\".\"CPUTM\" AS DATE), \n                \"BKPF_PAY\".\"CPUTM\") AS INTERVAL SECOND)                                         AS \"Time\",\n    'IncomingPayment'                                                                           AS \"Attribute\",\n    NULL                                                                                        AS \"OldValue\",\n    NULL                                                                                        AS \"NewValue\",\n\tCASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                        AS \"ExecutionType\",\n\t<%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::'  || \"BKPF_PAY\".\"USNAM\"              AS \"ChangedBy\",\n    NULL                                                                                        AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\"          AS \"OperationID\"\nFROM \"BSEG\" AS \"BSEG\"\n\tLEFT JOIN \"BKPF\" AS \"BKPF_PAY\"\n\t    ON \"BSEG\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                AND \"BSEG\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                AND \"BSEG\".\"AUGBL\" = \"BKPF_PAY\".\"BELNR\"\n                AND \"BSEG\".\"AUGGJ\" = \"BKPF_PAY\".\"GJAHR\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAY\"\n                   ON \"BSEG_PAY\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                       AND \"BSEG_PAY\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                       AND \"BSEG_PAY\".\"BELNR\" = \"BKPF_PAY\".\"BELNR\"\n                       AND \"BSEG_PAY\".\"GJAHR\" = \"BKPF_PAY\".\"GJAHR\"\n                       AND \"BSEG_PAY\".\"BSCHL\" IN ('15', '16')\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF_PAY\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"BKPF_PAY\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG_PAY\".\"MANDT\" IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" = '01'\n"
                    },
                    {
                        "id": "PartialPayment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\"          AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"                   AS \"ObjectID\",\n    CAST(\"BKPF_PAY\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF_PAY\".\"CPUTM\" AS DATE), \n                \"BKPF_PAY\".\"CPUTM\") AS INTERVAL SECOND)                                         AS \"Time\",\n    'IncomingPayment'                                                                           AS \"Attribute\",\n    NULL                                                                                        AS \"OldValue\",\n    NULL                                                                                        AS \"NewValue\",\n\tCASE \n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                                        AS \"ExecutionType\",\n\t<%=sourceSystem%> || '::' || \"BKPF_PAY\".\"MANDT\" || '::'  || \"BKPF_PAY\".\"USNAM\"              AS \"ChangedBy\",\n    NULL                                                                                        AS \"OperationType\",\n    <%=sourceSystem%> || '::' || \"BSEG_PAY\".\"MANDT\" || '::' || \"BSEG_PAY\".\"BUKRS\" || '::' || \n        \"BSEG_PAY\".\"BELNR\" || '::' || \"BSEG_PAY\".\"GJAHR\" || '::' || \"BSEG_PAY\".\"BUZEI\"          AS \"OperationID\"\nFROM \"BSEG\" AS \"BSEG\"\n    LEFT JOIN \"BSEG\" AS \"BSEG_PAY\"\n                   ON \"BSEG_PAY\".\"MANDT\" = \"BSEG\".\"MANDT\"\n                       AND \"BSEG_PAY\".\"BUKRS\" = \"BSEG\".\"BUKRS\"\n                       AND \"BSEG_PAY\".\"REBZG\" = \"BSEG\".\"BELNR\"\n                       AND \"BSEG_PAY\".\"REBZJ\" = \"BSEG\".\"GJAHR\"\n                       AND \"BSEG_PAY\".\"REBZZ\" = \"BSEG\".\"BUZEI\"\n                       AND \"BSEG_PAY\".\"BSCHL\" IN ('15', '16')\n    LEFT JOIN \"BKPF\" AS \"BKPF_PAY\"\n\t    ON \"BSEG_PAY\".\"MANDT\" = \"BKPF_PAY\".\"MANDT\"\n                AND \"BSEG_PAY\".\"BUKRS\" = \"BKPF_PAY\".\"BUKRS\"\n                AND \"BSEG_PAY\".\"BELNR\" = \"BKPF_PAY\".\"BELNR\"\n                AND \"BSEG_PAY\".\"GJAHR\" = \"BKPF_PAY\".\"GJAHR\"\n    LEFT JOIN \"USR02\" AS \"USR02\"\n        ON \"BKPF_PAY\".\"MANDT\" = \"USR02\".\"MANDT\"\n                AND \"BKPF_PAY\".\"USNAM\" = \"USR02\".\"BNAME\"\nWHERE \"BSEG\".\"BSCHL\" = '01'\n    AND \"BSEG_PAY\".\"MANDT\" IS NOT NULL\n"
                    },
                    {
                        "id": "ReceivableItemChanges",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n\t<%=sourceSystem%> || '::' || \"CDPOS\".\"TABKEY\" || '::' || \"CDPOS\".\"TABNAME\" || '::' || \"CDPOS\".\"FNAME\" \n        || '::' || \"CDPOS\".\"CHANGENR\" || '::' || \"CDPOS\".\"CHNGIND\"              AS \"ID\",\n    <%=sourceSystem%> || '::' || \n        SUBSTRING(\"CDPOS\".\"TABKEY\", 1, 3)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 4, 4)  || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 8, 10) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 18, 4) || '::' ||\n        SUBSTRING(\"CDPOS\".\"TABKEY\", 22, 3)                                       AS \"ObjectID\",\n\tCAST(\"CDHDR\".\"UDATE\" AS DATE) +\n            CAST(TIMESTAMPDIFF(SECOND, CAST(\"CDHDR\".\"UTIME\" AS DATE), \n            \"CDHDR\".\"UTIME\") AS INTERVAL SECOND)                                AS \"Time\",\n\tCASE\n           WHEN \"CDPOS\".\"FNAME\" = 'MANST' THEN 'DunningLevel'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZFBDT' THEN 'BaselineDate'\n           WHEN \"CDPOS\".\"FNAME\" = 'ZTERM' THEN 'PaymentTerms'\n           WHEN \"CDPOS\".\"FNAME\" = 'MANSP' THEN 'DunningBlock'\n     END                                                                        AS \"Attribute\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' \n            THEN CONCAT('-',REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_OLD\" \n     END                                                                        AS \"OldValue\",\n\tCASE\n        WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' \n            THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n        ELSE \"CDPOS\".\"VALUE_NEW\"\n     END                                                                        AS \"NewValue\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"MANDANT\" || '::' || \n        \"CDHDR\".\"USERNAME\"                                                      AS \"ChangedBy\",\n\t\"CDHDR\".\"TCODE\"                                                             AS \"OperationType\",\n\t<%=sourceSystem%> || '::' || \"CDHDR\".\"CHANGENR\"                             AS \"OperationID\",\n\tCASE\n        WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n        ELSE 'Manual' \n     END                                                                        AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"ObjectID\" = \"CDHDR\".\"ObjectID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'BELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS\".\"TABNAME\" = 'BSEG'\n  AND \"CDPOS\".\"FNAME\" IN ('MANST', 'ZFBDT', 'ZTERM', 'MANSP')\n  AND \"CDPOS\".\"CHNGIND\" = 'U'\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL\n  AND \"CDHDR\".\"MANDANT\" IS NOT NULL\n"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Customer",
                    "CustomerInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "BaselineDate",
                    "BusinessUnit",
                    "CashDiscountDueDate1",
                    "CashDiscountDueDate2",
                    "CashDiscountEligibleAmount",
                    "CashDiscountPercentage1",
                    "CashDiscountPercentage2",
                    "CashDiscountTakenAmount",
                    "ClearingDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "DebitCreditIndicator",
                    "DocumentCategory",
                    "DocumentDate",
                    "DocumentNumber",
                    "DocumentType",
                    "FiscalYear",
                    "ID",
                    "IsBlockedForDunning",
                    "IsReversed",
                    "NetDueDate",
                    "PaymentTerm",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "ReceivableItemAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"BUKRS\" || '::' \n        || \"BSEG\".\"BELNR\" || '::' || \"BSEG\".\"GJAHR\" || '::' || \"BSEG\".\"BUZEI\"       AS \"ID\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\"                                     AS \"SourceSystemInstance\",\n\tCASE\n        WHEN \"BSEG\".\"MANSP\" IS NOT NULL \n            THEN  TRUE \n        ELSE FALSE \n     END                                                                            AS \"IsBlockedForDunning\",\n\tCASE\n        WHEN \"BKPF\".\"XREVERSAL\" IS NOT NULL \n            THEN True\n        ELSE False\n     END                                                                            AS \"IsReversed\",\n\tCASE\n        WHEN \"BSEG\".\"SHKZG\" = 'S' THEN 'Debit'\n        WHEN \"BSEG\".\"SHKZG\" = 'H' THEN 'Credit'\n     END                                                                            AS \"DebitCreditIndicator\",\n\tCAST( CASE\n        WHEN \"BSEG\".\"ZBD3T\" > 0\n            THEN \n                CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD3T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n        WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" > 0\n            THEN \n                CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n        WHEN \"BSEG\".\"ZBD3T\" = 0 AND \"BSEG\".\"ZBD2T\" = 0 AND \"BSEG\".\"ZBD1T\" > 0\n            THEN \n                CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n        ELSE \"BSEG\".\"ZFBDT\" + INTERVAL '86399' SECOND\n     END AS TIMESTAMP)                                                              AS \"NetDueDate\",\n    \"BKPF\".\"BLART\"                                                                  AS \"DocumentType\",\n\t\"BSEG\".\"ZTERM\"                                                                  AS \"PaymentTerm\",\n\t\"BKPF\".\"WAERS\"                                                                  AS \"Currency\",\n\t\"BSEG\".\"WSKTO\"                                                                  AS \"CashDiscountTakenAmount\",\n\t\"BSEG\".\"SKFBT\"                                                                  AS \"CashDiscountEligibleAmount\",\n    \"BSEG\".\"ZBD2P\"                                                                  AS \"CashDiscountPercentage2\",\n    \"BSEG\".\"ZBD1P\"                                                                  AS \"CashDiscountPercentage1\",\n    CASE \n        WHEN \"BSEG\".\"ZBD2P\" > 0 \n        THEN \n            CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD2T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n     END                                                                            AS \"CashDiscountDueDate2\",\n    CASE\n        WHEN \"BSEG\".\"ZBD1P\" > 0 \n        THEN \n            CAST((CAST(\"BSEG\".\"ZFBDT\" AS DATE)\n                         + \"BSEG\".\"ZBD1T\" * INTERVAL '1' DAY) AS DATE) + INTERVAL '86399' SECOND\n     END                                                                            AS \"CashDiscountDueDate1\",\n\t\"BSEG\".\"WRBTR\" * \n    CASE \n        WHEN \"BSEG\".\"SHKZG\" = 'H' THEN -1.0 \n        ELSE 1.0 \n     END                                                                            AS \"Amount\",\n\tCAST(\"BSEG\".\"AUGDT\" AS TIMESTAMP)                                               AS \"ClearingDate\",\n\tCAST(\"BKPF\".\"BLDAT\" AS TIMESTAMP)                                               AS \"DocumentDate\",\n\tCAST(\"BSEG\".\"ZFBDT\" AS TIMESTAMP)                                               AS \"BaselineDate\",\n    CASE\n        WHEN \"BSEG\".\"BSCHL\" = '01' THEN 'CustomerInvoice'\n        WHEN \"BSEG\".\"BSCHL\" = '11' THEN 'CreditMemo'\n     END                                                                            AS \"DocumentCategory\",\n\tCAST(\"BSEG\".\"GJAHR\" AS BIGINT)                                                  AS \"FiscalYear\",\n\t\"BSEG\".\"BELNR\"                                                                  AS \"DocumentNumber\",\n    \"T001\".\"BUTXT\"                                                                  AS \"BusinessUnit\",\n\tCAST(\"BKPF\".\"CPUDT\" AS DATE) + CAST(TIMESTAMPDIFF(SECOND, CAST(\"BKPF\".\"CPUTM\" AS DATE), \n            \"BKPF\".\"CPUTM\") AS INTERVAL SECOND)                                     AS \"CreationTime\",\n\tCASE WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic' ELSE 'Manual' END      AS \"CreationExecutionType\",\n\t<%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"USNAM\"           AS \"CreatedBy\",\n    CASE \n        WHEN \"BKPF\".\"AWTYP\" = 'VBRK' AND \"BSEG\".\"BSCHL\" IN ('01', '11') \n            THEN <%=sourceSystem%> || '::' || \"BKPF\".\"MANDT\" || '::' || \"BKPF\".\"AWKEY\" \n     END                                                                            AS \"CustomerInvoice\",\n    <%=sourceSystem%> || '::' || \"BSEG\".\"MANDT\" || '::' || \"BSEG\".\"KUNNR\"           AS \"Customer\"\nFROM \"BSEG\" AS \"BSEG\"\n         LEFT JOIN \"BKPF\" AS \"BKPF\"\n                   ON \"BSEG\".\"MANDT\" = \"BKPF\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"BKPF\".\"BUKRS\"\n                       AND \"BSEG\".\"BELNR\" = \"BKPF\".\"BELNR\"\n                       AND \"BSEG\".\"GJAHR\" = \"BKPF\".\"GJAHR\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"BKPF\".\"MANDT\" = \"USR02\".\"MANDT\"\n                       AND \"BKPF\".\"USNAM\" = \"USR02\".\"BNAME\"\n         LEFT JOIN \"T001\" AS \"T001\"\n                   ON \"BSEG\".\"MANDT\" = \"T001\".\"MANDT\"\n                       AND \"BSEG\".\"BUKRS\" = \"T001\".\"BUKRS\"\nWHERE \"BSEG\".\"MANDT\" IS NOT NULL\n    AND \"BSEG\".\"BSCHL\" IN ('01', '11')\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1760347288913.0,
        "changed_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "created_by": {
            "id": "2202cbc9-7251-4630-bfb2-36812e688613",
            "name": "l.pigozzi",
            "type_": "USER"
        },
        "creation_date": 1749630800214.0,
        "data_connection_id": "42d53587-d7fa-45cf-8403-26770d8029d0",
        "description": "",
        "disabled": null,
        "display_name": "ReceivableItem transformation - 00. Central Extraction Pool_Oracle-ebs - 1",
        "draft": null,
        "factory_id": "c1de0c42-eb46-4aae-b383-741bfa9d089b",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "languageKey",
                "value": "'US'"
            },
            {
                "name": "sourceSystem",
                "value": "'Oracle_EBS'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "ReceivableItem",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Changelog",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_INVPosted\" AS (\n    SELECT \n        \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\"              AS \"CUSTOMER_TRX_ID\",\n        MAX(CAST(\"XLA_EVENTS\".\"CREATION_DATE\" AS TIMESTAMP)) AS \"PostedTime\",\n        MIN(\"GL_PERIOD_STATUSES\".\"PERIOD_YEAR\")              AS \"PERIOD_YEAR\"\n    FROM \"RA_CUSTOMER_TRX_ALL\" AS \"RA_CUSTOMER_TRX_ALL\"\n        LEFT JOIN \"XLA_TRANSACTION_ENTITIES\" AS \"XLA_TRANSACTION_ENTITIES\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\" = \"XLA_TRANSACTION_ENTITIES\".\"SOURCE_ID_INT_1\"\n        LEFT JOIN \"XLA_EVENTS\" AS \"XLA_EVENTS\"\n            ON \"XLA_TRANSACTION_ENTITIES\".\"APPLICATION_ID\" = \"XLA_EVENTS\".\"APPLICATION_ID\"\n                AND \"XLA_TRANSACTION_ENTITIES\".\"ENTITY_ID\" = \"XLA_EVENTS\".\"ENTITY_ID\"\n        LEFT JOIN \"XLA_AE_HEADERS\" AS \"XLA_AE_HEADERS\"\n            ON \"XLA_EVENTS\".\"APPLICATION_ID\" = \"XLA_AE_HEADERS\".\"APPLICATION_ID\"\n                AND \"XLA_EVENTS\".\"EVENT_ID\" = \"XLA_AE_HEADERS\".\"EVENT_ID\"\n        LEFT JOIN \"GL_PERIOD_STATUSES\" AS \"GL_PERIOD_STATUSES\"\n            ON \"XLA_AE_HEADERS\".\"PERIOD_NAME\" = \"GL_PERIOD_STATUSES\".\"PERIOD_NAME\"\n                AND \"XLA_AE_HEADERS\".\"LEDGER_ID\" = \"GL_PERIOD_STATUSES\".\"LEDGER_ID\"\n    WHERE \"XLA_TRANSACTION_ENTITIES\".\"ENTITY_CODE\" = 'TRANSACTIONS'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"APPLICATION_ID\" = 222\n        AND \"XLA_EVENTS\".\"EVENT_TYPE_CODE\" IN ('INV_CREATE', 'DM_CREATE')\n        AND \"XLA_EVENTS\".\"EVENT_STATUS_CODE\" = 'P'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"SOURCE_ID_INT_1\" IS NOT NULL\n    GROUP BY \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\"\n),\n    \"CTE_TRX_SOURCE\" AS (\n    SELECT \n        \"RA_BATCH_SOURCES_ALL\".\"NAME\"           AS \"SOURCE\",\n        \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\" AS \"CUSTOMER_TRX_ID\"\n    FROM \"RA_CUSTOMER_TRX_ALL\" AS \"RA_CUSTOMER_TRX_ALL\"\n        LEFT JOIN \"RA_BATCH_SOURCES_ALL\" AS \"RA_BATCH_SOURCES_ALL\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"BATCH_SOURCE_ID\" = \"RA_BATCH_SOURCES_ALL\".\"BATCH_SOURCE_ID\"\n                AND \"RA_CUSTOMER_TRX_ALL\".\"ORG_ID\" = \"RA_BATCH_SOURCES_ALL\".\"ORG_ID\"\n)\nSELECT \n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" \n        || '::' || \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" \n        || '::' || \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                           AS \"ID\",\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"                                AS \"ObjectID\",\n    \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                                          AS \"Time\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TERM_ID' \n            THEN 'PaymentTerms'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TRX_DATE' \n            THEN 'BaselineDate'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'EXCLUDE_FROM_DUNNING_FLAG' \n            THEN 'DunningBlock'\n    END                                                                                                          AS \"Attribute\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TERM_ID' \n            THEN \"RA_TERMS_TL_O\".\"NAME\"\n        ELSE \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" \n    END                                                                                                          AS \"OldValue\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TERM_ID' \n            THEN \"RA_TERMS_TL_N\".\"NAME\"\n        ELSE \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" \n    END                                                                                                          AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"USER\"                             AS \"ChangedBy\",\n    \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"TYPE\"                                                          AS \"OperationType\",\n    NULL                                                                                                         AS \"OperationID\",\n    CASE\n        WHEN UPPER(\"TRX_SOURCE\".\"SOURCE\") LIKE 'MANUAL%'\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                          AS \"ExecutionType\"\nFROM \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\" AS \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\"\n    LEFT JOIN \"AR_PAYMENT_SCHEDULES_ALL\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"ID\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"\n    LEFT JOIN \"CTE_TRX_SOURCE\" AS \"TRX_SOURCE\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_TRX_ID\" = \"TRX_SOURCE\".\"CUSTOMER_TRX_ID\"\n    LEFT JOIN \"RA_TERMS_TL\" AS \"RA_TERMS_TL_O\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" = \"RA_TERMS_TL_O\".\"TERM_ID\"    \n            AND  \"RA_TERMS_TL_O\".\"LANGUAGE\" = <%=languageKey%> \n    LEFT JOIN \"RA_TERMS_TL\" AS \"RA_TERMS_TL_N\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" = \"RA_TERMS_TL_N\".\"TERM_ID\"     \n            AND \"RA_TERMS_TL_N\".\"LANGUAGE\" = <%=languageKey%> \nWHERE EXISTS (\n    SELECT 1 \n    FROM \"CTE_INVPosted\" AS \"INVPosted\"\n    WHERE \"INVPosted\".\"CUSTOMER_TRX_ID\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_TRX_ID\"\n        AND \"INVPosted\".\"CUSTOMER_TRX_ID\" IS NOT NULL)\n    AND \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" IN ('TERM_ID', 'TRX_DATE','EXCLUDE_FROM_DUNNING_FLAG')\n    AND \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"TYPE\" = 'update'\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" IS NOT NULL\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV', 'DM','CM')"
                    },
                    {
                        "id": "Clearing",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_AGG_TR_REC\" AS (\n    SELECT \n        \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"                                               AS \"ID\",\n        \"AR_PAYMENT_SCHEDULES_ALL\".\"ACTUAL_DATE_CLOSED\"                                                AS \"ACTUAL_DATE_CLOSED\",\n        \"AR_CASH_RECEIPTS_ALL\".\"CASH_RECEIPT_ID\"                                                       AS \"CASH_RECEIPT_ID\",\n        \"AR_CASH_RECEIPTS_ALL\".\"CREATED_BY\"                                                            AS \"CREATED_BY\",\n        \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"REQUEST_ID\"                                                  AS \"REQUEST_ID\",\n        \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"RECEIVABLE_APPLICATION_ID\"                                   AS \"RECEIVABLE_APPLICATION_ID\",\n        ROW_NUMBER() \n        OVER (PARTITION BY \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"\n        ORDER BY \"AR_CASH_RECEIPTS_ALL\".\"CREATION_DATE\" DESC)                                          AS \"RN\"\n    FROM \"AR_RECEIVABLE_APPLICATIONS_ALL\" AS \"AR_RECEIVABLE_APPLICATIONS_ALL\"\n        LEFT JOIN \"AR_CASH_RECEIPTS_ALL\" AS \"AR_CASH_RECEIPTS_ALL\"\n            ON \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"CASH_RECEIPT_ID\" = \"AR_CASH_RECEIPTS_ALL\".\"CASH_RECEIPT_ID\"\n        LEFT JOIN \"AR_PAYMENT_SCHEDULES_ALL\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n            ON \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"APPLIED_PAYMENT_SCHEDULE_ID\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"\n    WHERE \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"STATUS\" = 'APP'\n      AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"APPLICATION_TYPE\" = 'CASH'\n      AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"DISPLAY\" = 'Y'\n      AND \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV', 'DM','CM')\n      AND \"AR_PAYMENT_SCHEDULES_ALL\".\"STATUS\" = 'CL'\n)\nSELECT \n    <%=sourceSystem%> || '::' || \"AGG_TR_REC\".\"ID\" || '::' || 'CLEARING' || '::' || \"AGG_TR_REC\".\"RECEIVABLE_APPLICATION_ID\" AS \"ID\",        \n    <%=sourceSystem%> || '::' || \"AGG_TR_REC\".\"ID\"                                                                           AS \"ObjectID\",    \n    \"AGG_TR_REC\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND                                                              AS \"Time\",\n    'Clearing'                                                                                                               AS \"Attribute\",\n    NULL                                                                                                                     AS \"OldValue\",\n    CAST(\"AGG_TR_REC\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND AS VARCHAR(255))                                        AS \"NewValue\",\n    <%=sourceSystem%> || '::' || CAST(\"AGG_TR_REC\".\"CREATED_BY\"  AS VARCHAR(255))                                            AS \"ChangedBy\",\n    NULL                                                                                                                     AS \"OperationType\",\n    <%=sourceSystem%> || '::' || CAST(\"AGG_TR_REC\".\"CASH_RECEIPT_ID\" \n    || '::' || \"AGG_TR_REC\".\"ACTUAL_DATE_CLOSED\" AS VARCHAR(255))                                                            AS \"OperationID\",\n    CASE\n        WHEN \"AGG_TR_REC\".\"REQUEST_ID\" IS NULL\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                                      AS \"ExecutionType\"\nFROM \"CTE_AGG_TR_REC\" AS \"AGG_TR_REC\"\nWHERE \"AGG_TR_REC\".\"RN\" = 1"
                    },
                    {
                        "id": "ClearingNonReceipts",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_REC_ITEM_CLR\" AS (\n    SELECT \n        \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"        AS \"ID\",\n        \"AR_PAYMENT_SCHEDULES_ALL\".\"ACTUAL_DATE_CLOSED\"         AS \"ACTUAL_DATE_CLOSED\",\n        \"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_TRX_ID\"            AS \"CUSTOMER_TRX_ID\",\n        \"AR_PAYMENT_SCHEDULES_ALL\".\"LAST_UPDATED_BY\"            AS \"LAST_UPDATED_BY\",\n        \"AR_PAYMENT_SCHEDULES_ALL\".\"REQUEST_ID\"                 AS \"REQUEST_ID\"\n    FROM \"AR_PAYMENT_SCHEDULES_ALL\" AS \"AR_PAYMENT_SCHEDULES_ALL\"   \n    WHERE \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV', 'DM','CM')\n        AND \"AR_PAYMENT_SCHEDULES_ALL\".\"STATUS\" = 'CL' \n        AND (\"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_APPLIED\" IS NULL\n            OR \"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_APPLIED\" = 0)\n        AND NOT EXISTS (\n                SELECT 1\n                FROM \"AR_RECEIVABLE_APPLICATIONS_ALL\" AS \"AR_RECEIVABLE_APPLICATIONS_ALL\"\n                WHERE \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"APPLIED_PAYMENT_SCHEDULE_ID\" =  \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"\n                    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"STATUS\" = 'APP'\n                    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"APPLICATION_TYPE\" = 'CASH'\n                    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"DISPLAY\" = 'Y')\n)    \nSELECT \n    <%=sourceSystem%> || '::' || \"REC_ITEM_CLR\".\"ID\" || '::' || 'CLEARING' || '::' || \"REC_ITEM_CLR\".\"CUSTOMER_TRX_ID\"       AS \"ID\",        \n    <%=sourceSystem%> || '::' || \"REC_ITEM_CLR\".\"ID\"                                                                         AS \"ObjectID\",    \n    \"REC_ITEM_CLR\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND                                                            AS \"Time\",\n    'Clearing-NonReceipts'                                                                                                   AS \"Attribute\",\n    NULL                                                                                                                     AS \"OldValue\",\n    CAST(\"REC_ITEM_CLR\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND AS VARCHAR(255))                                      AS \"NewValue\",\n    <%=sourceSystem%> || '::' || CAST(\"REC_ITEM_CLR\".\"LAST_UPDATED_BY\"  AS VARCHAR(255))                                     AS \"ChangedBy\",\n    NULL                                                                                                                     AS \"OperationType\",\n    <%=sourceSystem%> || '::' || CAST(\"REC_ITEM_CLR\".\"CUSTOMER_TRX_ID\" \n        || '::' || \"REC_ITEM_CLR\".\"ACTUAL_DATE_CLOSED\" AS VARCHAR(255))                                                      AS \"OperationID\",\n    CASE\n        WHEN \"REC_ITEM_CLR\".\"REQUEST_ID\" IS NULL\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                                      AS \"ExecutionType\"\nFROM \"CTE_REC_ITEM_CLR\" AS \"REC_ITEM_CLR\""
                    },
                    {
                        "id": "Dunning",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT \n    <%=sourceSystem%>  || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" \n        || '::' || RANK() OVER (PARTITION BY \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"\n        ORDER BY \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\") AS \"ID\",\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"                                         AS \"ObjectID\",\n    \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\"                                                                               AS \"Time\",\n    'DunningLevel'                                                                                                        AS \"Attribute\",\n    CAST((RANK()\n             OVER (PARTITION BY \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" ORDER BY \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\")\n             - 1) AS VARCHAR(255))                                                                                        AS \"OldValue\",\n    CAST((RANK()\n             OVER (PARTITION BY \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" ORDER BY \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\"))\n           AS VARCHAR(255))                                                                                               AS \"NewValue\",\n    <%=sourceSystem%> || '::' || CAST(\"IEX_STRATEGY_WORK_ITEMS\".\"CREATED_BY\" AS VARCHAR(255))                             AS \"ChangedBy\",\n    NULL                                                                                                                  AS \"OperationType\",\n    CAST(\"IEX_STRATEGY_WORK_ITEMS\".\"WORK_ITEM_ID\"  AS VARCHAR(255))                                                       AS \"OperationID\",\n    NULL                                                                                                                  AS \"ExecutionType\"\nFROM \"IEX_STRATEGY_WORK_ITEMS\" AS \"IEX_STRATEGY_WORK_ITEMS\"\n    LEFT JOIN \"IEX_STRATEGIES\" AS \"IEX_STRATEGIES\"\n            ON \"IEX_STRATEGY_WORK_ITEMS\".\"STRATEGY_ID\" = \"IEX_STRATEGIES\".\"STRATEGY_ID\"\n    LEFT JOIN \"IEX_DELINQUENCIES_ALL\" AS \"IEX_DELINQUENCIES_ALL\"\n            ON (\"IEX_STRATEGIES\".\"OBJECT_ID\" = \"IEX_DELINQUENCIES_ALL\".\"PARTY_CUST_ID\"\n                    AND \"IEX_STRATEGIES\".\"OBJECT_TYPE\" = 'PARTY')\n                OR (\"IEX_STRATEGIES\".\"OBJECT_ID\" = \"IEX_DELINQUENCIES_ALL\".\"CUSTOMER_SITE_USE_ID\"\n                    AND \"IEX_STRATEGIES\".\"OBJECT_TYPE\" = 'BILL_TO')\n                OR (\"IEX_STRATEGIES\".\"OBJECT_ID\" = \"IEX_DELINQUENCIES_ALL\".\"CUST_ACCOUNT_ID\"\n                    AND \"IEX_STRATEGIES\".\"OBJECT_TYPE\" = 'ACCOUNT')\n                OR (\"IEX_STRATEGIES\".\"OBJECT_ID\" = \"IEX_DELINQUENCIES_ALL\".\"DELINQUENCY_ID\"\n                    AND \"IEX_STRATEGIES\".\"OBJECT_TYPE\" = 'DELINQUENT')\n    LEFT JOIN \"AR_PAYMENT_SCHEDULES_ALL\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n            ON \"IEX_DELINQUENCIES_ALL\".\"PAYMENT_SCHEDULE_ID\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"\n                AND \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\" >= \"AR_PAYMENT_SCHEDULES_ALL\".\"DUE_DATE\"\n                AND \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\" <= \"AR_PAYMENT_SCHEDULES_ALL\".\"ACTUAL_DATE_CLOSED\"\n    LEFT JOIN \"IEX_STRY_TEMP_WORK_ITEMS_B\" AS \"IEX_STRY_TEMP_WORK_ITEMS_B\"\n            ON \"IEX_STRATEGY_WORK_ITEMS\".\"WORK_ITEM_TEMPLATE_ID\" = \"IEX_STRY_TEMP_WORK_ITEMS_B\".\"WORK_ITEM_TEMP_ID\"\n    LEFT JOIN \"IEX_STRY_TEMP_WORK_ITEMS_TL\" AS \"IEX_STRY_TEMP_WORK_ITEMS_TL\"\n            ON \"IEX_STRY_TEMP_WORK_ITEMS_B\".\"WORK_ITEM_TEMP_ID\" = \"IEX_STRY_TEMP_WORK_ITEMS_TL\".\"WORK_ITEM_TEMP_ID\"\n                AND \"IEX_STRY_TEMP_WORK_ITEMS_TL\".\"LANGUAGE\" =  <%=languageKey%>\nWHERE \"IEX_STRATEGY_WORK_ITEMS\".\"EXECUTE_END\" IS NOT NULL\n    AND \"IEX_STRATEGIES\".\"STRATEGY_ID\" IS NOT NULL\n    AND \"IEX_DELINQUENCIES_ALL\".\"PARTY_CUST_ID\" IS NOT NULL\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" IS NOT NULL\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV', 'DM')\n    AND \"IEX_STRY_TEMP_WORK_ITEMS_B\".\"CATEGORY_TYPE\" = 'EMAIL'"
                    },
                    {
                        "id": "IncomingPayment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT \r\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" \r\n        || '::' || 'RECEIPT' || '::' || \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"RECEIVABLE_APPLICATION_ID\"                                                  AS \"ID\",     \r\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"                                                                     AS \"ObjectID\",       \r\n    \"AR_CASH_RECEIPTS_ALL\".\"RECEIPT_DATE\"                                                                                                             AS \"Time\",\r\n    'IncomingPayment'                                                                                                                                 AS \"Attribute\",\r\n    NULL                                                                                                                                              AS \"OldValue\",\r\n    CAST(\"AR_CASH_RECEIPTS_ALL\".\"RECEIPT_DATE\"  AS VARCHAR(255))                                                                                      AS \"NewValue\",\r\n    <%=sourceSystem%> || '::' || CAST(\"AR_CASH_RECEIPTS_ALL\".\"CREATED_BY\" AS VARCHAR(255))                                                            AS \"ChangedBy\",\r\n    NULL                                                                                                                                              AS \"OperationType\",\r\n    <%=sourceSystem%> || '::' || CAST(\"AR_CASH_RECEIPTS_ALL\".\"CASH_RECEIPT_ID\" \r\n    || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ACTUAL_DATE_CLOSED\" AS VARCHAR(255))                                                                       AS \"OperationID\",\r\n    CASE\r\n        WHEN \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"REQUEST_ID\" IS NULL\r\n            THEN 'Manual'\r\n        ELSE 'Automatic'\r\n    END                                                                                                                                               AS \"ExecutionType\"\r\nFROM \"AR_PAYMENT_SCHEDULES_ALL\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\r\n    LEFT JOIN \"AR_RECEIVABLE_APPLICATIONS_ALL\" AS \"AR_RECEIVABLE_APPLICATIONS_ALL\"\r\n            ON \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" = \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"APPLIED_PAYMENT_SCHEDULE_ID\"\r\n    LEFT JOIN \"AR_CASH_RECEIPTS_ALL\" AS \"AR_CASH_RECEIPTS_ALL\"\r\n            ON \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"CASH_RECEIPT_ID\"  = \"AR_CASH_RECEIPTS_ALL\".\"CASH_RECEIPT_ID\"       \r\nWHERE \"AR_CASH_RECEIPTS_ALL\".\"CASH_RECEIPT_ID\" IS NOT NULL\r\n    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"STATUS\" = 'APP'\r\n    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"APPLICATION_TYPE\" = 'CASH'\r\n    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"DISPLAY\" = 'Y'\r\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV', 'DM','CM')\r\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"STATUS\" = 'CL'\r\n"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Customer",
                    "CustomerInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "BaselineDate",
                    "BusinessUnit",
                    "CashDiscountDueDate1",
                    "CashDiscountDueDate2",
                    "CashDiscountEligibleAmount",
                    "CashDiscountPercentage1",
                    "CashDiscountPercentage2",
                    "CashDiscountTakenAmount",
                    "ClearingDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "DebitCreditIndicator",
                    "DocumentCategory",
                    "DocumentDate",
                    "DocumentNumber",
                    "DocumentType",
                    "FiscalYear",
                    "ID",
                    "IsBlockedForDunning",
                    "IsReversed",
                    "NetDueDate",
                    "PaymentTerm",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "ReceivableItemAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_INVPosted_Time\" AS (\n    SELECT \n        \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\"              AS \"CUSTOMER_TRX_ID\",\n        CAST(\"XLA_EVENTS\".\"CREATION_DATE\" AS TIMESTAMP)      AS \"POSTED_TIME\",\n        CAST(\"XLA_EVENTS\".\"CREATED_BY\" AS VARCHAR(255))      AS \"POSTED_BY\",\n        \"GL_PERIOD_STATUSES\".\"PERIOD_YEAR\"                   AS \"PERIOD_YEAR\",\n        ROW_NUMBER() OVER (PARTITION BY \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\"   \n        ORDER BY \"XLA_EVENTS\".\"CREATION_DATE\" ASC, \n        \"XLA_EVENTS\".\"EVENT_NUMBER\" DESC)                    AS \"rn\"\n    FROM \"RA_CUSTOMER_TRX_ALL\" AS \"RA_CUSTOMER_TRX_ALL\"\n        LEFT JOIN \"XLA_TRANSACTION_ENTITIES\" AS \"XLA_TRANSACTION_ENTITIES\"\n                ON \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\" = \"XLA_TRANSACTION_ENTITIES\".\"SOURCE_ID_INT_1\"\n        LEFT JOIN \"XLA_EVENTS\" AS \"XLA_EVENTS\"\n                ON \"XLA_TRANSACTION_ENTITIES\".\"APPLICATION_ID\" = \"XLA_EVENTS\".\"APPLICATION_ID\"\n                    AND \"XLA_TRANSACTION_ENTITIES\".\"ENTITY_ID\" = \"XLA_EVENTS\".\"ENTITY_ID\"\n        LEFT JOIN \"XLA_AE_HEADERS\" AS \"XLA_AE_HEADERS\"\n                ON \"XLA_EVENTS\".\"APPLICATION_ID\" = \"XLA_AE_HEADERS\".\"APPLICATION_ID\"\n                    AND \"XLA_EVENTS\".\"EVENT_ID\" = \"XLA_AE_HEADERS\".\"EVENT_ID\"\n        LEFT JOIN \"GL_PERIOD_STATUSES\" AS \"GL_PERIOD_STATUSES\"\n                ON \"XLA_AE_HEADERS\".\"PERIOD_NAME\" = \"GL_PERIOD_STATUSES\".\"PERIOD_NAME\"\n                    AND \"XLA_AE_HEADERS\".\"LEDGER_ID\" = \"GL_PERIOD_STATUSES\".\"LEDGER_ID\"\n                    AND \"XLA_AE_HEADERS\".\"APPLICATION_ID\" = \"GL_PERIOD_STATUSES\".\"APPLICATION_ID\"\n    WHERE \"XLA_TRANSACTION_ENTITIES\".\"ENTITY_CODE\" = 'TRANSACTIONS'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"APPLICATION_ID\" = 222\n        AND \"XLA_EVENTS\".\"EVENT_TYPE_CODE\" IN ('INV_CREATE', 'DM_CREATE','CM_CREATE')\n        AND \"XLA_EVENTS\".\"EVENT_STATUS_CODE\" = 'P'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"SOURCE_ID_INT_1\" IS NOT NULL\n),\n    \"CTE_INVPosted\" AS (\n    SELECT \n        \"INVPosted_Time\".\"CUSTOMER_TRX_ID\" AS \"CUSTOMER_TRX_ID\",\n        \"INVPosted_Time\".\"POSTED_TIME\"     AS \"POSTED_TIME\",\n        \"INVPosted_Time\".\"POSTED_BY\"       AS \"POSTED_BY\",\n        \"INVPosted_Time\".\"PERIOD_YEAR\"     AS \"PERIOD_YEAR\"\n    FROM \"CTE_INVPosted_Time\" AS \"INVPosted_Time\"\n    WHERE \"INVPosted_Time\".\"rn\" = 1\n),\n    \"CTE_TERMS\" AS (\n    SELECT \n        \"RA_TERMS_LINES\".\"TERM_ID\"            AS \"TERM_ID\",\n        \"RA_TERMS_LINES\".\"SEQUENCE_NUM\"       AS \"SEQUENCE_NUM\",\n        \"RA_TERMS_TL\".\"NAME\"                  AS \"TERM_NAME\", \n        \"S1\".\"DISCOUNT_DATE\"                  AS \"DISCOUNT_DATE1\",\n        \"S1\".\"DISCOUNT_DAY_OF_MONTH\"          AS \"DISCOUNT_DAY_OF_MONTH1\",\n        \"S1\".\"DISCOUNT_DAYS\"                  AS \"DISCOUNT_DAYS1\",\n        \"S1\".\"DISCOUNT_MONTHS_FORWARD\"        AS \"DISCOUNT_MONTHS_FORWARD1\",\n        \"S1\".\"DISCOUNT_PERCENT\"               AS \"DISCOUNT_PERCENT1\",\n        \"S2\".\"DISCOUNT_DATE\"                  AS \"DISCOUNT_DATE2\",\n        \"S2\".\"DISCOUNT_DAY_OF_MONTH\"          AS \"DISCOUNT_DAY_OF_MONTH2\",\n        \"S2\".\"DISCOUNT_DAYS\"                  AS \"DISCOUNT_DAYS2\",\n        \"S2\".\"DISCOUNT_MONTHS_FORWARD\"        AS \"DISCOUNT_MONTHS_FORWARD2\",\n        \"S2\".\"DISCOUNT_PERCENT\"               AS \"DISCOUNT_PERCENT2\",\n        \"RA_TERMS_LINES\".\"DUE_DATE\"           AS \"DUE_DATE\",\n        \"RA_TERMS_LINES\".\"DUE_DAY_OF_MONTH\"   AS \"DUE_DAY_OF_MONTH\",\n        \"RA_TERMS_LINES\".\"DUE_DAYS\"           AS \"DUE_DAYS\",\n        \"RA_TERMS_LINES\".\"DUE_MONTHS_FORWARD\" AS \"DUE_MONTHS_FORWARD\",\n        CASE\n            WHEN \"RA_TERMS_LINES\".\"DUE_DAYS\" IS NOT NULL\n                THEN 1\n            WHEN \"RA_TERMS_LINES\".\"DUE_DATE\" IS NOT NULL\n                THEN 2\n            WHEN \"RA_TERMS_LINES\".\"DUE_DAY_OF_MONTH\" IS NOT NULL\n                    AND \"RA_TERMS_LINES\".\"DUE_MONTHS_FORWARD\" IS NOT NULL\n                THEN 3\n            WHEN \"RA_TERMS_LINES\".\"DUE_DATE\" IS NULL\n                    AND \"RA_TERMS_LINES\".\"DUE_DAY_OF_MONTH\" IS NULL\n                    AND \"RA_TERMS_LINES\".\"DUE_DAYS\" IS NULL\n                    AND \"RA_TERMS_LINES\".\"DUE_MONTHS_FORWARD\" IS NULL\n            THEN 4\n            ELSE 5\n        END                                   AS \"DUEDATEMODE\",\n        CASE\n            WHEN \"S1\".\"DISCOUNT_DAYS\" IS NOT NULL\n                THEN 1\n            WHEN \"S1\".\"DISCOUNT_DATE\" IS NOT NULL\n                THEN 2\n            WHEN \"S1\".\"DISCOUNT_DAY_OF_MONTH\" IS NOT NULL\n                    AND \"S1\".\"DISCOUNT_MONTHS_FORWARD\" IS NOT NULL\n                THEN 3\n            WHEN \"S1\".\"DISCOUNT_DATE\" IS NULL\n                    AND \"S1\".\"DISCOUNT_DAY_OF_MONTH\" IS NULL\n                    AND \"S1\".\"DISCOUNT_DAYS\" IS NULL\n                    AND \"S1\".\"DISCOUNT_MONTHS_FORWARD\" IS NULL\n                THEN 4\n            ELSE 5\n        END                                   AS \"DISCOUNTDATEMODE1\",\n        CASE\n            WHEN \"S2\".\"DISCOUNT_DAYS\" IS NOT NULL\n                THEN 1\n            WHEN \"S2\".\"DISCOUNT_DATE\" IS NOT NULL\n                THEN 2\n            WHEN \"S2\".\"DISCOUNT_DAY_OF_MONTH\" IS NOT NULL\n                    AND \"S2\".\"DISCOUNT_MONTHS_FORWARD\" IS NOT NULL\n                THEN 3\n            WHEN \"S2\".\"DISCOUNT_DATE\" IS NULL\n                    AND \"S2\".\"DISCOUNT_DAY_OF_MONTH\" IS NULL\n                    AND \"S2\".\"DISCOUNT_DAYS\" IS NULL\n                    AND \"S2\".\"DISCOUNT_MONTHS_FORWARD\" IS NULL\n                THEN 4\n            ELSE 5\n        END                                   AS \"DISCOUNTDATEMODE2\",\n        CASE\n            WHEN \"RA_TERMS_B\".\"CALC_DISCOUNT_ON_LINES_FLAG\" = 'I'\n                THEN 1\n            WHEN \"RA_TERMS_B\".\"CALC_DISCOUNT_ON_LINES_FLAG\" = 'L'\n                THEN 2\n            WHEN \"RA_TERMS_B\".\"CALC_DISCOUNT_ON_LINES_FLAG\" = 'T'\n                THEN 3\n            WHEN \"RA_TERMS_B\".\"CALC_DISCOUNT_ON_LINES_FLAG\" = 'F'\n                THEN 4\n            ELSE 5\n                END                                   AS \"DISCOUNTBASIS\"\n    FROM \"RA_TERMS_LINES\" AS \"RA_TERMS_LINES\"\n        LEFT JOIN \"RA_TERMS_TL\" AS \"RA_TERMS_TL\"\n                ON \"RA_TERMS_LINES\".\"TERM_ID\" = \"RA_TERMS_TL\".\"TERM_ID\"\n                    AND \"RA_TERMS_TL\".\"LANGUAGE\" = <%=languageKey%> \n        LEFT JOIN \"RA_TERMS_B\" AS \"RA_TERMS_B\"\n                ON \"RA_TERMS_LINES\".\"TERM_ID\" = \"RA_TERMS_TL\".\"TERM_ID\"    \n                    AND \"RA_TERMS_TL\".\"TERM_ID\" = \"RA_TERMS_B\".\"TERM_ID\"            \n        LEFT JOIN \"RA_TERMS_LINES_DISCOUNTS\" AS \"S1\"\n                ON \"RA_TERMS_LINES\".\"TERM_ID\" = \"S1\".\"TERM_ID\"\n                    AND \"RA_TERMS_LINES\".\"SEQUENCE_NUM\" = \"S1\".\"SEQUENCE_NUM\"\n        LEFT JOIN \"RA_TERMS_LINES_DISCOUNTS\" AS \"S2\"\n                ON \"RA_TERMS_LINES\".\"TERM_ID\" = \"S2\".\"TERM_ID\"\n                    AND \"RA_TERMS_LINES\".\"SEQUENCE_NUM\" = \"S2\".\"SEQUENCE_NUM\"\n                    AND \"S1\".\"TERMS_LINES_DISCOUNT_ID\" <> \"S2\".\"TERMS_LINES_DISCOUNT_ID\"\n)\nSELECT \n    <%=sourceSystem%>  || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\"                                                  AS \"ID\",\n    <%=sourceSystem%>  || '::' || \"INVPosted\".\"POSTED_BY\"                                                                           AS \"CreatedBy\",\n    CASE\n        WHEN UPPER(\"RA_BATCH_SOURCES_ALL\".\"NAME\") LIKE 'MANUAL%'\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                                             AS \"CreationExecutionType\",\n    \"INVPosted\".\"POSTED_TIME\"                                                                                                       AS \"CreationTime\",\n    <%=sourceSystem%>  || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_TRX_ID\"                                                      AS \"CustomerInvoice\",\n    <%=sourceSystem%>  || '::' || CAST(\"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_ID\" AS VARCHAR(255))                                    AS \"Customer\",    \n    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_NUMBER\"                                                                                         AS \"DocumentNumber\",\n    \"InvPosted\".\"PERIOD_YEAR\"                                                                                                       AS \"FiscalYear\",\n    \"RA_CUST_TRX_TYPES_ALL\".\"TYPE\"                                                                                                  AS \"DocumentType\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" = 'INV' \n            THEN 'CustomerInvoice'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" = 'CM' \n            THEN 'CreditMemo'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" = 'DM' \n            THEN 'DebitMemo'\n    END                                                                                                                             AS \"DocumentCategory\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\"                                                                                           AS \"BaselineDate\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\"                                                                                           AS \"DocumentDate\",\n    CASE \n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"STATUS\" = 'OP' \n            THEN NULL \n        ELSE \"AR_PAYMENT_SCHEDULES_ALL\".\"ACTUAL_DATE_CLOSED\" \n    END                                                                                                                             AS \"ClearingDate\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_DUE_ORIGINAL\"                                                                                AS \"Amount\",\n    CASE\n        WHEN \"TERMS\".\"DISCOUNTDATEMODE1\" = 4 \n            THEN NULL\n\t\tWHEN \"TERMS\".\"DISCOUNTDATEMODE1\" = 1 \n\t\t    THEN TIMESTAMPADD(DAY, CAST(\"TERMS\".\"DISCOUNT_DAYS1\" AS INTEGER),\n                                         CAST(\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\" AS TIMESTAMP)) + INTERVAL '86399' SECOND \n\t\tWHEN \"TERMS\".\"DISCOUNTDATEMODE1\" = 2\t\t\n            THEN \"TERMS\".\"DISCOUNT_DATE1\" + INTERVAL '86399' SECOND \n\t\tWHEN \"TERMS\".\"DISCOUNTDATEMODE1\" = 3 \n\t\t    THEN CASE\n                    WHEN (CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD1\" AS INTEGER) = 0 \n                                          AND DAYOFMONTH(\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") >= CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH1\" AS INTEGER))\n                        THEN TIMESTAMPADD(MONTH, 1,\n                                               CAST(YEAR(\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' ||MONTH(\n                                                                    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") \n                                                                    || '-' || CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH1\" AS INTEGER) AS TIMESTAMP)) + INTERVAL '86399' SECOND \n                    WHEN DAYOFMONTH(TIMESTAMPADD(DAY, -1,\n                                                                   TIMESTAMPADD(MONTH,CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD1\" AS INTEGER) + 1,\n                                                                                      CAST(YEAR\n                                                                                           (\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' || MONTH (\n                                                                                           \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\")|| '-01' AS TIMESTAMP)))) <=  CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH1\" AS INTEGER)\n                        THEN TIMESTAMPADD(DAY, -1,\n                                               TIMESTAMPADD(MONTH,CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD1\" AS INTEGER) + 1,\n                                                                               CAST(YEAR\n                                                                                    (\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' || MONTH (\n                                                                                    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\")|| '-01' AS TIMESTAMP))) + INTERVAL '86399' SECOND \n                    ELSE\n                             TIMESTAMPADD(MONTH,CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD1\" AS INTEGER),\n                                                        CAST(YEAR (\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' || MONTH (\n                                                             \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\")\n                                                             || '-' || CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH1\" AS INTEGER) AS TIMESTAMP)) + INTERVAL '86399' SECOND \n                    END \n        ELSE NULL \n    END                                                                                                                            AS \"CashDiscountDueDate1\",\n    CASE\n        WHEN \"TERMS\".\"DISCOUNTDATEMODE2\" = 4 \n            THEN NULL\n\t\tWHEN \"TERMS\".\"DISCOUNTDATEMODE2\" = 1 \n\t\t    THEN TIMESTAMPADD(DAY, CAST(\"TERMS\".\"DISCOUNT_DAYS2\" AS INTEGER),\n                                         CAST(\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\" AS TIMESTAMP)) + INTERVAL '86399' SECOND \n\t\tWHEN \"TERMS\".\"DISCOUNTDATEMODE2\" = 2\t\t\n            THEN \"TERMS\".\"DISCOUNT_DATE2\" + INTERVAL '86399' SECOND \n\t\tWHEN \"TERMS\".\"DISCOUNTDATEMODE2\" = 3 \n\t\t    THEN CASE\n                    WHEN (CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD2\" AS INTEGER) = 0 \n                          AND  DAYOFMONTH(\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") >= CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH2\" AS INTEGER))\n                        THEN TIMESTAMPADD(MONTH, 1,\n                                                               CAST(YEAR(\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' ||MONTH(\n                                                                    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") \n                                                                    || '-' || CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH2\" AS INTEGER) AS TIMESTAMP)) + INTERVAL '86399' SECOND \n                    WHEN DAYOFMONTH(TIMESTAMPADD(DAY, -1,\n                                    TIMESTAMPADD(MONTH,CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD2\" AS INTEGER) + 1,\n                                                                                      CAST(YEAR\n                                                                                           (\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' || MONTH (\n                                                                                           \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\")|| '-01' AS TIMESTAMP)))) <= CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH2\" AS INTEGER)\n                        THEN TIMESTAMPADD(DAY, -1,\n                                                            TIMESTAMPADD(MONTH,CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD2\" AS INTEGER) + 1,\n                                                                               CAST(YEAR\n                                                                                    (\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' || MONTH (\n                                                                                    \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\")|| '-01' AS TIMESTAMP))) + INTERVAL '86399' SECOND \n                    ELSE\n                                     TIMESTAMPADD(MONTH,CAST(\"TERMS\".\"DISCOUNT_MONTHS_FORWARD2\" AS INTEGER),\n                                                        CAST(YEAR (\"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\") || '-' || MONTH (\n                                                             \"AR_PAYMENT_SCHEDULES_ALL\".\"TRX_DATE\")\n                                                            || '-'|| CAST(\"TERMS\".\"DISCOUNT_DAY_OF_MONTH2\" AS INTEGER) AS TIMESTAMP)) + INTERVAL '86399' SECOND \n                    END \n        ELSE NULL \n    END                                                                                                                            AS \"CashDiscountDueDate2\",\n    \"TERMS\".\"DISCOUNT_PERCENT1\"                                                                                                    AS \"CashDiscountPercentage1\",\n    \"TERMS\".\"DISCOUNT_PERCENT2\"                                                                                                    AS \"CashDiscountPercentage2\",\n    CASE\n        WHEN \"TERMS\".\"DISCOUNTBASIS\" = 1\n            THEN ROUND(\"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_DUE_ORIGINAL\" * \"TERMS\".\"DISCOUNT_PERCENT1\" / 100,2)\n        WHEN \"TERMS\".\"DISCOUNTBASIS\" = 2\n            THEN ROUND(\"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_LINE_ITEMS_ORIGINAL\" * \"TERMS\".\"DISCOUNT_PERCENT1\" / 100,2)\n        WHEN \"TERMS\".\"DISCOUNTBASIS\" = 3\n            THEN ROUND((\"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_LINE_ITEMS_ORIGINAL\" \n                + \"AR_PAYMENT_SCHEDULES_ALL\".\"FREIGHT_ORIGINAL\" + \"AR_PAYMENT_SCHEDULES_ALL\".\"TAX_ORIGINAL\")\n                * \"TERMS\".\"DISCOUNT_PERCENT1\" / 100,2)\n        WHEN \"TERMS\".\"DISCOUNTBASIS\" = 4\n            THEN ROUND((\"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_LINE_ITEMS_ORIGINAL\" \n                + \"AR_PAYMENT_SCHEDULES_ALL\".\"FREIGHT_ORIGINAL\")\n                * \"TERMS\".\"DISCOUNT_PERCENT1\" / 100,2)\n            ELSE NULL\n    END                                                                                                                            AS \"CashDiscountEligibleAmount\", \n    COALESCE(\"AR_PAYMENT_SCHEDULES_ALL\".\"DISCOUNT_TAKEN_EARNED\" + \"AR_PAYMENT_SCHEDULES_ALL\".\"DISCOUNT_TAKEN_UNEARNED\", 0)         AS \"CashDiscountTakenAmount\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"INVOICE_CURRENCY_CODE\"                                                                             AS \"Currency\",\n    \"TERMS\".\"TERM_NAME\"                                                                                                            AS \"PaymentTerm\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"DUE_DATE\" + INTERVAL '86399' SECOND                                                                AS \"NetDueDate\",\n    CASE \n\t\tWHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV','DM') \n            THEN 'Debit'\n\t\tWHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" = 'CM' \n            THEN 'Credit'\n\t\tELSE 'Other' \n    END                                                                                                                            AS \"DebitCreditIndicator\",\n    CASE \n       WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"AMOUNT_DUE_ORIGINAL\" = 0 \n       THEN TRUE \n       ELSE FALSE\n    END                                                                                                                            AS \"IsReversed\",\n    CASE \n       WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"EXCLUDE_FROM_DUNNING_FLAG\" = 'Y'\n       THEN TRUE \n       ELSE FALSE\n    END                                                                                                                            AS \"IsBlockedForDunning\",\n    \"HR_ALL_ORGANIZATION_UNITS\".\"NAME\"                                                                                             AS \"BusinessUnit\",\n    <%=sourceSystem%>                                                                                                              AS \"SourceSystemInstance\"\nFROM \"AR_PAYMENT_SCHEDULES_ALL\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n    LEFT JOIN \"CTE_TERMS\" AS \"TERMS\"\n            ON \"AR_PAYMENT_SCHEDULES_ALL\".\"TERM_ID\" = \"TERMS\".\"TERM_ID\"\n                AND \"AR_PAYMENT_SCHEDULES_ALL\".\"TERMS_SEQUENCE_NUMBER\" = \"TERMS\".\"SEQUENCE_NUM\"    \n    LEFT JOIN \"CTE_INVPosted\" AS \"INVPosted\"\n            ON \"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_TRX_ID\" = \"INVPosted\".\"CUSTOMER_TRX_ID\"\n    LEFT JOIN \"RA_CUSTOMER_TRX_ALL\" AS \"RA_CUSTOMER_TRX_ALL\"\n            ON \"AR_PAYMENT_SCHEDULES_ALL\".\"CUSTOMER_TRX_ID\" = \"RA_CUSTOMER_TRX_ALL\".\"CUSTOMER_TRX_ID\"\n    LEFT JOIN \"HR_ALL_ORGANIZATION_UNITS\" AS \"HR_ALL_ORGANIZATION_UNITS\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"ORG_ID\" = \"HR_ALL_ORGANIZATION_UNITS\".\"ORGANIZATION_ID\"\n    LEFT JOIN \"RA_BATCH_SOURCES_ALL\" AS \"RA_BATCH_SOURCES_ALL\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"BATCH_SOURCE_ID\" = \"RA_BATCH_SOURCES_ALL\".\"BATCH_SOURCE_ID\"\n                AND \"RA_CUSTOMER_TRX_ALL\".\"ORG_ID\" = \"RA_BATCH_SOURCES_ALL\".\"ORG_ID\"\n    LEFT JOIN \"RA_CUST_TRX_TYPES_ALL\" AS \"RA_CUST_TRX_TYPES_ALL\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"CUST_TRX_TYPE_ID\" = \"RA_CUST_TRX_TYPES_ALL\".\"CUST_TRX_TYPE_ID\"\n                AND \"RA_CUSTOMER_TRX_ALL\".\"ORG_ID\" = \"RA_CUST_TRX_TYPES_ALL\".\"ORG_ID\"\nWHERE \"AR_PAYMENT_SCHEDULES_ALL\".\"PAYMENT_SCHEDULE_ID\" IS NOT NULL\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"CLASS\" IN ('INV','DM','CM')\n    AND \"INVPosted\".\"CUSTOMER_TRX_ID\" IS NOT NULL"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    },
    {
        "change_date": 1760356194849.0,
        "changed_by": {
            "id": "83864e97-dd17-42f7-92e4-2c1d1b9c029d",
            "name": "Hema priya Sudhakar",
            "type_": "USER"
        },
        "created_by": {
            "id": "83864e97-dd17-42f7-92e4-2c1d1b9c029d",
            "name": "Hema priya Sudhakar",
            "type_": "USER"
        },
        "creation_date": 1752512585383.0,
        "data_connection_id": "03736e95-3931-4eda-8dfe-fc16e11388bc",
        "description": null,
        "disabled": null,
        "display_name": "ReceivableItem - OracleFusion",
        "draft": null,
        "factory_id": "5c8244e1-086c-49e5-859e-bd8f17801d4a",
        "factory_validation_status": "VALID",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "languageKey",
                "value": "'US'"
            },
            {
                "name": "sourceSystem",
                "value": "'Oracle_Fusion'"
            }
        ],
        "namespace": "custom",
        "target": {
            "entity_ref": {
                "name": "ReceivableItem",
                "namespace": "custom"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "Changelog",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_INVPosted\" AS (\n    SELECT \n        \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\"              AS \"CUSTOMER_TRX_ID\",\n        MAX(CAST(\"XLA_EVENTS\".\"EventPEOCreationDate\" AS TIMESTAMP))     AS \"PostedTime\",\n        MIN(\"GL_PERIOD_STATUSES\".\"GlPeriodStatusesPeriodYear\")          AS \"PERIOD_YEAR\"\n    FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionHeaderExtractPVO\" AS \"RA_CUSTOMER_TRX_ALL\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_XlaBiccExtractAM_SubledgerJournalTransactionEntityExtractPVO\" AS \"XLA_TRANSACTION_ENTITIES\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\" = \"XLA_TRANSACTION_ENTITIES\".\"TransactionSourceIdInt1\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_XlaBiccExtractAM_SubledgerJournalEventExtractPVO\" AS \"XLA_EVENTS\"\n            ON \"XLA_TRANSACTION_ENTITIES\".\"TransactionApplicationId\" = \"XLA_EVENTS\".\"EventPEOApplicationId\"\n                AND \"XLA_TRANSACTION_ENTITIES\".\"TransactionEntityId\" = \"XLA_EVENTS\".\"EventPEOEntityId\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_XlaBiccExtractAM_SubledgerJournalHeaderExtractPVO\" AS \"XLA_AE_HEADERS\"\n            ON \"XLA_EVENTS\".\"EventPEOApplicationId\" = \"XLA_AE_HEADERS\".\"JournalEntryHeaderApplicationId\"\n                AND \"XLA_EVENTS\".\"EventPEOEventId\" = \"XLA_AE_HEADERS\".\"JournalEntryHeaderEventId\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_GlBiccExtractAM_PeriodStatusExtractPVO\" AS \"GL_PERIOD_STATUSES\"\n            ON \"XLA_AE_HEADERS\".\"JournalEntryHeaderPeriodName\" = \"GL_PERIOD_STATUSES\".\"GlPeriodStatusesPeriodName\"\n                AND \"XLA_AE_HEADERS\".\"JournalEntryHeaderLedgerId\" = \"GL_PERIOD_STATUSES\".\"GlPeriodStatusesLedgerId\"\n    WHERE \"XLA_TRANSACTION_ENTITIES\".\"TransactionEntityCode\" = 'TRANSACTIONS'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"TransactionApplicationId\" = 222\n        AND \"XLA_EVENTS\".\"EventPEOEventTypeCode\" IN ('INV_CREATE', 'DM_CREATE', 'CM_CREATE')\n        AND \"XLA_EVENTS\".\"EventPEOEventStatusCode\" = 'P'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"TransactionSourceIdInt1\" IS NOT NULL\n    GROUP BY \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\"\n),\n\"CTE_TRX_SOURCE\" AS (\n    SELECT \"RA_BATCH_SOURCES_ALL\".\"RaBatchSourceName\"                              AS \"SOURCE\",\n            \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\"                     AS \"CUSTOMER_TRX_ID\"\n    FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionHeaderExtractPVO\" AS \"RA_CUSTOMER_TRX_ALL\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionBatchSourceExtractPVO\" AS \"RA_BATCH_SOURCES_ALL\"\n        ON \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxBatchSourceSeqId\" = \"RA_BATCH_SOURCES_ALL\".\"RaBatchSourceBatchSourceSeqId\")\nSELECT \n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\" \n    || '::' || \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" \n    || '::' || \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                                  AS \"ID\",\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"                    AS \"ObjectID\",\n    \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"DATE\"                                                             AS \"Time\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TERM_ID' \n            THEN 'PaymentTerms'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TRX_DATE' \n            THEN 'BaselineDate'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'EXCLUDE_FROM_DUNNING_FLAG' \n            THEN 'DunningBlock'\n    END                                                                                                             AS \"Attribute\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TERM_ID' \n            THEN \"RA_TERMS_TL_O\".\"RaTermTLName\"\n        ELSE \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" \n    END                                                                                                             AS \"OldValue\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" = 'TERM_ID' \n            THEN \"RA_TERMS_TL_N\".\"RaTermTLName\"\n        ELSE \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" \n    END                                                                                                             AS \"NewValue\",\n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"USER\"                                AS \"ChangedBy\",\n    \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"TYPE\"                                                             AS \"OperationType\",\n    NULL                                                                                                            AS \"OperationID\",\n    CASE\n        WHEN UPPER(\"TRX_SOURCE\".\"SOURCE\") LIKE 'MANUAL%'\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                             AS \"ExecutionType\"\nFROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentScheduleExtractPVO_CELONIS_CHANGELOG\" AS \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentScheduleExtractPVO\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"ID\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"\n    LEFT JOIN \"CTE_TRX_SOURCE\" AS \"TRX_SOURCE\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerTrxId\" = \"TRX_SOURCE\".\"CUSTOMER_TRX_ID\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentTermTLExtractPVO\" AS \"RA_TERMS_TL_O\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"OLD_VALUE\" = \"RA_TERMS_TL_O\".\"RaTermTLTermId\"    \n            AND  \"RA_TERMS_TL_O\".\"RaTermTLLanguage\" = <%=languageKey%> \n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentTermTLExtractPVO\" AS \"RA_TERMS_TL_N\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"NEW_VALUE\" = \"RA_TERMS_TL_N\".\"RaTermTLTermId\"     \n            AND \"RA_TERMS_TL_N\".\"RaTermTLLanguage\" = <%=languageKey%> \nWHERE EXISTS (\n    SELECT 1 \n    FROM \"CTE_INVPosted\" AS \"INVPosted\"\n    WHERE \"INVPosted\".\"CUSTOMER_TRX_ID\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerTrxId\"\n        AND \"INVPosted\".\"CUSTOMER_TRX_ID\" IS NOT NULL\n)\nAND \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"COLUMN\" IN ('TERM_ID', 'TRX_DATE','EXCLUDE_FROM_DUNNING_FLAG')\nAND \"AR_PAYMENT_SCHEDULES_ALL_CELONIS_CHANGELOG\".\"TYPE\" = 'update'\nAND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\" IS NOT NULL\nAND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" IN ('INV', 'DM','CM')"
                    },
                    {
                        "id": "Clearing",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_AGG_TR_REC\" AS (\n    SELECT \n        \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"                                            AS \"ID\",\n        \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleActualDateClosed\"                                             AS \"ACTUAL_DATE_CLOSED\",\n        \"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCashReceiptId\"                                                        AS \"CASH_RECEIPT_ID\",\n        \"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCreatedBy\"                                                            AS \"CREATED_BY\",\n        \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationRequestId\"                                        AS \"REQUEST_ID\",\n        \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationReceivableApplicationId\"                          AS \"RECEIVABLE_APPLICATION_ID\",\n        ROW_NUMBER() OVER (PARTITION BY \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"\n            ORDER BY \"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCreationDate\" DESC)                                      AS \"RN\"\n    FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_ReceivableApplicationExtractPVO\" AS \"AR_RECEIVABLE_APPLICATIONS_ALL\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_ReceiptHeaderExtractPVO\" AS \"AR_CASH_RECEIPTS_ALL\"\n            ON \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationCashReceiptId\" = \"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCashReceiptId\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentScheduleExtractPVO\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n            ON \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationAppliedPaymentScheduleId\" = \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"\n    WHERE \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationStatus\" = 'APP'\n        AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationApplicationType\" = 'CASH'\n        AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationDisplay\" = 'Y'\n        AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" IN ('INV', 'DM','CM')\n        AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleStatus\" = 'CL'\n)\nSELECT \n    <%=sourceSystem%> || '::' || \"AGG_TR_REC\".\"ID\" || '::' || 'CLEARING' \n    || '::' || \"AGG_TR_REC\".\"RECEIVABLE_APPLICATION_ID\"                                  AS \"ID\",     \n    <%=sourceSystem%> || '::' || \"AGG_TR_REC\".\"ID\"                                       AS \"ObjectID\",       \n    \"AGG_TR_REC\".\"ACTUAL_DATE_CLOSED\"  + INTERVAL '86398' SECOND                         AS \"Time\",\n    'Clearing'                                                                           AS \"Attribute\",\n    NULL                                                                                 AS \"OldValue\",\n    CAST(\"AGG_TR_REC\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND AS VARCHAR(255))    AS \"NewValue\",\n    <%=sourceSystem%> || '::' || CAST(\"AGG_TR_REC\".\"CREATED_BY\"  AS VARCHAR(255))        AS \"ChangedBy\",\n    NULL                                                                                 AS \"OperationType\",\n    <%=sourceSystem%> || '::' || CAST(\"AGG_TR_REC\".\"CASH_RECEIPT_ID\" \n    || '::' || \"AGG_TR_REC\".\"ACTUAL_DATE_CLOSED\" AS VARCHAR(255))                        AS \"OperationID\",\n    CASE\n        WHEN \"AGG_TR_REC\".\"REQUEST_ID\" IS NULL\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                  AS \"ExecutionType\"\nFROM \"CTE_AGG_TR_REC\" AS \"AGG_TR_REC\"\nWHERE \"AGG_TR_REC\".\"RN\" = 1"
                    },
                    {
                        "id": "ClearingNonReceipts",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_REC_ITEM_CLR\" AS (\n    SELECT \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"         AS \"ID\",\n            \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleActualDateClosed\"         AS \"ACTUAL_DATE_CLOSED\",\n            \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerTrxId\"            AS \"CUSTOMER_TRX_ID\",\n            \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleLastUpdatedBy\"            AS \"LAST_UPDATED_BY\",\n            \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleRequestId\"                AS \"REQUEST_ID\"\n    FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentScheduleExtractPVO\" AS \"AR_PAYMENT_SCHEDULES_ALL\"   \n    WHERE \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" IN ('INV', 'DM','CM')\n        AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleStatus\" = 'CL' \n        AND (\"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleAmountApplied\" IS NULL OR \n            \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleAmountApplied\" = 0)\n        AND NOT EXISTS (\n                    SELECT 1\n                        FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_ReceivableApplicationExtractPVO\" AS \"AR_RECEIVABLE_APPLICATIONS_ALL\"\n                        WHERE \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationAppliedPaymentScheduleId\" =  \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"\n                            AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationStatus\" = 'APP'\n                            AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationApplicationType\" = 'CASH'\n                            AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationDisplay\" = 'Y'\n)\n)    \nSELECT \n    <%=sourceSystem%> || '::' || \"REC_ITEM_CLR\".\"ID\" || '::' || 'CLEARING' || '::' || \"REC_ITEM_CLR\".\"CUSTOMER_TRX_ID\"       AS \"ID\",        \n    <%=sourceSystem%> || '::' || \"REC_ITEM_CLR\".\"ID\"                                                                         AS \"ObjectID\",    \n    \"REC_ITEM_CLR\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND                                                            AS \"Time\",\n    'Clearing-NonReceipts'                                                                                                   AS \"Attribute\",\n    NULL                                                                                                                     AS \"OldValue\",\n    CAST(\"REC_ITEM_CLR\".\"ACTUAL_DATE_CLOSED\" + INTERVAL '86398' SECOND AS VARCHAR(255))                                      AS \"NewValue\",\n    <%=sourceSystem%> || '::' || CAST(\"REC_ITEM_CLR\".\"LAST_UPDATED_BY\"  AS VARCHAR(255))                                     AS \"ChangedBy\",\n    NULL                                                                                                                     AS \"OperationType\",\n    <%=sourceSystem%> || '::' || CAST(\"REC_ITEM_CLR\".\"CUSTOMER_TRX_ID\" \n    || '::' || \"REC_ITEM_CLR\".\"ACTUAL_DATE_CLOSED\" AS VARCHAR(255))                                                          AS \"OperationID\",\n    CASE\n        WHEN \"REC_ITEM_CLR\".\"REQUEST_ID\" IS NULL\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                                  AS \"ExecutionType\"\nFROM \"CTE_REC_ITEM_CLR\" AS \"REC_ITEM_CLR\""
                    },
                    {
                        "id": "IncomingPayment",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT \n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\" \n    || '::' || 'RECEIPT' || '::' || \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationReceivableApplicationId\"          AS \"ID\",     \n    <%=sourceSystem%> || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"                               AS \"ObjectID\",       \n    CAST(\"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptReceiptDate\"  AS TIMESTAMP)                                                      AS \"Time\",\n    'IncomingPayment'                                                                                                          AS \"Attribute\",\n    NULL                                                                                                                       AS \"OldValue\",\n    CAST(\"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptReceiptDate\"  AS VARCHAR(255))                                                   AS \"NewValue\",\n    <%=sourceSystem%> || '::' || CAST(\"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCreatedBy\" AS VARCHAR(255))                         AS \"ChangedBy\",\n    NULL                                                                                                                       AS \"OperationType\",\n    <%=sourceSystem%> || '::' || CAST(\"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCashReceiptId\" \n    || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleActualDateClosed\" AS VARCHAR(255))                                 AS \"OperationID\",\n    CASE\n        WHEN \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationRequestId\" IS NULL\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                                        AS \"ExecutionType\"\nFROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentScheduleExtractPVO\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_ReceivableApplicationExtractPVO\" AS \"AR_RECEIVABLE_APPLICATIONS_ALL\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\" = \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationAppliedPaymentScheduleId\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_ReceiptHeaderExtractPVO\" AS \"AR_CASH_RECEIPTS_ALL\"\n        ON \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationCashReceiptId\"  = \"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCashReceiptId\"       \nWHERE \"AR_CASH_RECEIPTS_ALL\".\"ArCashReceiptCashReceiptId\" IS NOT NULL\n    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationStatus\" = 'APP'\n    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationApplicationType\" = 'CASH'\n    AND \"AR_RECEIVABLE_APPLICATIONS_ALL\".\"ArReceivableApplicationDisplay\" = 'Y'\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" IN ('INV', 'DM','CM')\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleStatus\" = 'CL'"
                    }
                ],
                "foreign_key_names": [
                    "CreatedBy",
                    "Customer",
                    "CustomerInvoice"
                ],
                "namespace": "custom",
                "property_names": [
                    "Amount",
                    "BaselineDate",
                    "BusinessUnit",
                    "CashDiscountDueDate1",
                    "CashDiscountDueDate2",
                    "CashDiscountEligibleAmount",
                    "CashDiscountPercentage1",
                    "CashDiscountPercentage2",
                    "CashDiscountTakenAmount",
                    "ClearingDate",
                    "CreationExecutionType",
                    "CreationTime",
                    "Currency",
                    "DebitCreditIndicator",
                    "DocumentCategory",
                    "DocumentDate",
                    "DocumentNumber",
                    "DocumentType",
                    "FiscalYear",
                    "ID",
                    "IsBlockedForDunning",
                    "IsReversed",
                    "NetDueDate",
                    "PaymentTerm",
                    "SourceSystemInstance"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "ReceivableItemAttributes",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "WITH \"CTE_INVPosted_Time\" AS (\n    SELECT \n        \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\"                         AS \"CUSTOMER_TRX_ID\",\n        CAST(\"XLA_EVENTS\".\"EventPEOCreationDate\" AS TIMESTAMP)                     AS \"POSTED_TIME\",\n        CAST(\"XLA_EVENTS\".\"EventPEOEventPEOCreatedBy\" AS VARCHAR(255))             AS \"POSTED_BY\",\n        \"GL_PERIOD_STATUSES\".\"GlPeriodStatusesPeriodYear\"                          AS \"PERIOD_YEAR\",\n        ROW_NUMBER() \n            OVER (PARTITION BY \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\" \n            ORDER BY \"XLA_EVENTS\".\"EventPEOCreationDate\" ASC,\n        \"XLA_EVENTS\".\"EventPEOEventNumber\" DESC)                                   AS \"rn\"\n    FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionHeaderExtractPVO\" AS \"RA_CUSTOMER_TRX_ALL\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_XlaBiccExtractAM_SubledgerJournalTransactionEntityExtractPVO\" AS \"XLA_TRANSACTION_ENTITIES\"\n            ON \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\" = \"XLA_TRANSACTION_ENTITIES\".\"TransactionSourceIdInt1\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_XlaBiccExtractAM_SubledgerJournalEventExtractPVO\" AS \"XLA_EVENTS\"\n            ON \"XLA_TRANSACTION_ENTITIES\".\"TransactionApplicationId\" = \"XLA_EVENTS\".\"EventPEOApplicationId\"\n                AND \"XLA_TRANSACTION_ENTITIES\".\"TransactionEntityId\" = \"XLA_EVENTS\".\"EventPEOEntityId\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_XlaBiccExtractAM_SubledgerJournalHeaderExtractPVO\" AS \"XLA_AE_HEADERS\"\n            ON \"XLA_EVENTS\".\"EventPEOApplicationId\" = \"XLA_AE_HEADERS\".\"JournalEntryHeaderApplicationId\"\n                AND \"XLA_EVENTS\".\"EventPEOEventId\" = \"XLA_AE_HEADERS\".\"JournalEntryHeaderEventId\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_GlBiccExtractAM_PeriodStatusExtractPVO\" AS \"GL_PERIOD_STATUSES\"\n            ON \"XLA_AE_HEADERS\".\"JournalEntryHeaderPeriodName\" = \"GL_PERIOD_STATUSES\".\"GlPeriodStatusesPeriodName\"\n                AND \"XLA_AE_HEADERS\".\"JournalEntryHeaderLedgerId\" = \"GL_PERIOD_STATUSES\".\"GlPeriodStatusesLedgerId\"\n    WHERE \"XLA_TRANSACTION_ENTITIES\".\"TransactionEntityCode\" = 'TRANSACTIONS'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"TransactionApplicationId\" = 222\n        AND \"XLA_EVENTS\".\"EventPEOEventTypeCode\" IN ('INV_CREATE', 'DM_CREATE', 'CM_CREATE')\n        AND \"XLA_EVENTS\".\"EventPEOEventStatusCode\" = 'P'\n        AND \"XLA_TRANSACTION_ENTITIES\".\"TransactionSourceIdInt1\" IS NOT NULL\n),\n\"CTE_INVPosted\" AS (\n    SELECT \n        \"INVPosted_Time\".\"CUSTOMER_TRX_ID\"                              AS \"CUSTOMER_TRX_ID\",\n        \"INVPosted_Time\".\"POSTED_TIME\"                                  AS \"POSTED_TIME\",\n        \"INVPosted_Time\".\"POSTED_BY\"                                    AS \"POSTED_BY\",\n        \"INVPosted_Time\".\"PERIOD_YEAR\"                                  AS \"PERIOD_YEAR\"\n        FROM \"CTE_INVPosted_Time\" AS \"INVPosted_Time\"\n        WHERE \"INVPosted_Time\".\"rn\" = 1\n),\n\"CTE_TERMS\" AS (\n    SELECT \n        \"RA_TERMS_LINES\".\"RaTermsLineTermId\"                            AS \"TERM_ID\",\n        \"RA_TERMS_LINES\".\"RaTermsLineSequenceNum\"                       AS \"SEQUENCE_NUM\",\n        \"RA_TERMS_TL\".\"RaTermTLName\"                                    AS \"TERM_NAME\", \n        \"RA_TERMS_LINES\".\"RaTermsLineDueDate\"                           AS \"DUE_DATE\",\n        \"RA_TERMS_LINES\".\"RaTermsLineDueDayOfMonth\"                     AS \"DUE_DAY_OF_MONTH\",\n        \"RA_TERMS_LINES\".\"RaTermsLineDueDays\"                           AS \"DUE_DAYS\",\n        \"RA_TERMS_LINES\".\"RaTermsLineDueMonthsForward\"                  AS \"DUE_MONTHS_FORWARD\",\n        CASE\n            WHEN \"RA_TERMS_LINES\".\"RaTermsLineDueDays\" IS NOT NULL\n                THEN 1\n            WHEN \"RA_TERMS_LINES\".\"RaTermsLineDueDate\" IS NOT NULL\n                THEN 2\n            WHEN \"RA_TERMS_LINES\".\"RaTermsLineDueDayOfMonth\" IS NOT NULL\n                    AND \"RA_TERMS_LINES\".\"RaTermsLineDueMonthsForward\" IS NOT NULL\n                THEN 3\n            WHEN \"RA_TERMS_LINES\".\"RaTermsLineDueDate\" IS NULL\n                    AND \"RA_TERMS_LINES\".\"RaTermsLineDueDayOfMonth\" IS NULL\n                    AND \"RA_TERMS_LINES\".\"RaTermsLineDueDays\" IS NULL\n                    AND \"RA_TERMS_LINES\".\"RaTermsLineDueMonthsForward\" IS NULL\n                THEN 4\n            ELSE 5\n        END                                                               AS \"DUEDATEMODE\",\n        NULL                                                              AS \"DISCOUNTDATEMODE1\",\n        NULL                                                              AS \"DISCOUNTDATEMODE2\",\n        CASE\n            WHEN \"RA_TERMS_B\".\"RaTermBCalcDiscountOnLinesFlag\" = 'I'\n                THEN 1\n            WHEN \"RA_TERMS_B\".\"RaTermBCalcDiscountOnLinesFlag\" = 'L'\n                THEN 2\n            WHEN \"RA_TERMS_B\".\"RaTermBCalcDiscountOnLinesFlag\" = 'T'\n                THEN 3\n            WHEN \"RA_TERMS_B\".\"RaTermBCalcDiscountOnLinesFlag\" = 'F'\n                THEN 4\n            ELSE 5\n        END                                                                AS \"DISCOUNTBASIS\"\n    FROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentTermLineExtractPVO\" AS \"RA_TERMS_LINES\"\n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentTermTLExtractPVO\" AS \"RA_TERMS_TL\"\n            ON \"RA_TERMS_LINES\".\"RaTermsLineTermId\" = \"RA_TERMS_TL\".\"RaTermTLTermId\"\n                AND \"RA_TERMS_TL\".\"RaTermTLLanguage\" = <%=languageKey%> \n        LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentTermExtractPVO\" AS \"RA_TERMS_B\"\n            ON \"RA_TERMS_LINES\".\"RaTermsLineTermId\" = \"RA_TERMS_TL\".\"RaTermTLTermId\"    \n                AND \"RA_TERMS_TL\".\"RaTermTLTermId\" = \"RA_TERMS_B\".\"RaTermTLTermId\"\n)            \nSELECT \n    <%=sourceSystem%>  || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\"                                                    AS \"ID\",\n    <%=sourceSystem%>  || '::' || \"INVPosted\".\"POSTED_BY\"                                                                                            AS \"CreatedBy\",\n    CASE\n        WHEN UPPER(\"RA_BATCH_SOURCES_ALL\".\"RaBatchSourceName\") LIKE 'MANUAL%'\n            THEN 'Manual'\n        ELSE 'Automatic'\n    END                                                                                                                                              AS \"CreationExecutionType\",\n    \"INVPosted\".\"POSTED_TIME\"                                                                                                                        AS \"CreationTime\",\n    <%=sourceSystem%>  || '::' || \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerTrxId\"                                                        AS \"CustomerInvoice\",\n    <%=sourceSystem%>  || '::' || CAST(\"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerId\" AS VARCHAR(255))                                     AS \"Customer\",    \n    \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleTrxNumber\"                                                                                          AS \"DocumentNumber\",\n    \"InvPosted\".\"PERIOD_YEAR\"                                                                                                                        AS \"FiscalYear\",\n    \"RA_CUST_TRX_TYPES_ALL\".\"RaCustTrxTypeType\"                                                                                                      AS \"DocumentType\",\n    CASE\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" = 'INV' \n            THEN 'CustomerInvoice'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" = 'CM' \n            THEN 'CreditMemo'\n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" = 'DM' \n            THEN 'DebitMemo'\n    END                                                                                                                                              AS \"DocumentCategory\",\n    CAST(\"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleTrxDate\" AS TIMESTAMP)                                                                         AS \"BaselineDate\",\n    CAST(\"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleTrxDate\" AS TIMESTAMP)                                                                         AS \"DocumentDate\",\n    CAST(CASE \n            WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleStatus\" = 'OP'\n                THEN NULL \n            ELSE \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleActualDateClosed\" \n        END AS TIMESTAMP)                                                                                                                            AS \"ClearingDate\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleAmountDueOriginal\"                                                                                  AS \"Amount\",\n    NULL                                                                                                                                             AS \"CashDiscountDueDate1\",\n    NULL                                                                                                                                             AS \"CashDiscountDueDate2\",\n    NULL                                                                                                                                             AS \"CashDiscountPercentage1\",\n    NULL                                                                                                                                             AS \"CashDiscountPercentage2\",\n    NULL                                                                                                                                             AS \"CashDiscountEligibleAmount\",\n    COALESCE(\"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleDiscountTakenEarned\" \n    + \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleDiscountTakenUnearned\", 0)                                                                        AS \"CashDiscountTakenAmount\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleInvoiceCurrencyCode\"                                                                                AS \"Currency\",\n    \"TERMS\".\"TERM_NAME\"                                                                                                                              AS \"PaymentTerm\",\n    \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleDueDate\" + INTERVAL '86399' SECOND                                                                  AS \"NetDueDate\",\n    CASE \n\t\tWHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" IN ('INV','DM') \n            THEN 'Debit'\n\t\tWHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" = 'CM' \n            THEN 'Credit'\n\t    ELSE 'Other' \n    END                                                                                                                                              AS \"DebitCreditIndicator\",\n    CASE \n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleAmountDueOriginal\" = 0 \n            THEN TRUE \n        ELSE FALSE\n    END                                                                                                                                              AS \"IsReversed\",\n    CASE \n        WHEN \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleExcludeFromDunningFlag\" = 'Y'\n            THEN TRUE \n        ELSE FALSE\n    END                                                                                                                                              AS \"IsBlockedForDunning\",\n    \"HR_ALL_ORGANIZATION_UNITS\".\"FunBuPerfPEOName\"                                                                                                   AS \"BusinessUnit\",\n    <%=sourceSystem%>                                                                                                                                AS \"SourceSystemInstance\"\nFROM \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_PaymentScheduleExtractPVO\" AS \"AR_PAYMENT_SCHEDULES_ALL\"\n    LEFT JOIN \"CTE_TERMS\" AS \"TERMS\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleTermId\" = \"TERMS\".\"TERM_ID\"\n            AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleTermsSequenceNumber\" = \"TERMS\".\"SEQUENCE_NUM\"\n\tLEFT JOIN \"CTE_INVPosted\" AS \"INVPosted\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerTrxId\" = \"INVPosted\".\"CUSTOMER_TRX_ID\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionHeaderExtractPVO\" AS \"RA_CUSTOMER_TRX_ALL\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleCustomerTrxId\" = \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustomerTrxId\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionBatchSourceExtractPVO\" AS \"RA_BATCH_SOURCES_ALL\"\n        ON \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxBatchSourceSeqId\" = \"RA_BATCH_SOURCES_ALL\".\"RaBatchSourceBatchSourceSeqId\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_ArBiccExtractAM_TransactionTypeExtractPVO\" AS \"RA_CUST_TRX_TYPES_ALL\"\n        ON \"RA_CUSTOMER_TRX_ALL\".\"RaCustomerTrxCustTrxTypeSeqId\" = \"RA_CUST_TRX_TYPES_ALL\".\"RaCustTrxTypeCustTrxTypeSeqId\"\n    LEFT JOIN \"FscmTopModelAM_FinExtractAM_FunBiccExtractAM_BusinessUnitExtractPVO\" AS \"HR_ALL_ORGANIZATION_UNITS\"\n        ON \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentScheduleOrgId\" = \"HR_ALL_ORGANIZATION_UNITS\".\"FunBuPerfPEOBusinessUnitId\"\nWHERE \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleId\" IS NOT NULL\n    AND \"AR_PAYMENT_SCHEDULES_ALL\".\"ArPaymentSchedulePaymentScheduleClass1\" IN ('INV','DM','CM')\n    AND \"INVPosted\".\"CUSTOMER_TRX_ID\" IS NOT NULL\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]