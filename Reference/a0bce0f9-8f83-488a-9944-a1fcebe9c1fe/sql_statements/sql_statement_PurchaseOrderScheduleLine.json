[
    {
        "change_date": 1770400809371.0,
        "changed_by": {
            "id": "cccccccc-cccc-cccc-cccc-cccccccccccc",
            "name": "Celonis",
            "type_": "APPLICATION"
        },
        "created_by": {
            "id": "cccccccc-cccc-cccc-cccc-cccccccccccc",
            "name": "Celonis",
            "type_": "APPLICATION"
        },
        "creation_date": 1770400809371.0,
        "data_connection_id": "b3c59e17-798d-49ea-b0b3-99d0bae2e011",
        "description": null,
        "disabled": null,
        "display_name": "PurchaseOrderScheduleLine",
        "draft": null,
        "factory_id": "e16588e7-f43e-4555-ad43-a024879c6fcb_b3c59e17-798d-49ea-b0b3-99d0bae2e011",
        "factory_validation_status": "NOT_VALIDATED",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "''"
            }
        ],
        "namespace": "celonis",
        "target": {
            "entity_ref": {
                "name": "PurchaseOrderScheduleLine",
                "namespace": "celonis"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [
                    {
                        "id": "CDPOS",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT <%=sourceSystem%>  || 'PurchaseOrderScheduleLine_' || \"CDPOS\".\"TABKEY\" AS \"ObjectID\",\n\t<%=sourceSystem%>  || \"CDPOS\".\"TABKEY\" || \"CDPOS\".\"TABNAME\" || \"CDPOS\".\"FNAME\"\n       || \"CDPOS\".\"CHANGENR\" || \"CDPOS\".\"CHNGIND\"                             AS \"ID\",\n       CAST(\"CDHDR\".\"UDATE\" AS DATE) + CAST(\"CDHDR\".\"UTIME\" AS TIME)          AS \"Time\",\n       CASE\n           WHEN \"CDPOS\".\"FNAME\" = 'EINDT' THEN 'ItemDeliveryDate'\n           END                                                                AS \"Attribute\",\n       CASE\n           WHEN \"CDPOS\".\"VALUE_OLD\" LIKE '%-' THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_OLD\"), '-', ''))\n           ELSE \"CDPOS\".\"VALUE_OLD\" END                                       AS \"OldValue\",\n       CASE\n           WHEN \"CDPOS\".\"VALUE_NEW\" LIKE '%-' THEN CONCAT('-', REPLACE(LTRIM(\"CDPOS\".\"VALUE_NEW\"), '-', ''))\n           ELSE \"CDPOS\".\"VALUE_NEW\" END                                       AS \"NewValue\",\n       'User_' || \"CDHDR\".\"MANDANT\" || \"CDHDR\".\"USERNAME\"                     AS \"ChangedBy\",\n       \"CDHDR\".\"TCODE\"                                                        AS \"OperationType\",\n       \"CDHDR\".\"CHANGENR\"                                                     AS \"OperationID\",\n       CASE\n           WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n           ELSE 'Manual' END                                                  AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n         LEFT JOIN \"EKET\" AS \"EKET\"\n                   ON \"EKET\".\"MANDT\" || \"EKET\".\"EBELN\" || \"EKET\".\"EBELP\" || \"EKET\".\"ETENR\" = \"CDPOS\".\"TABKEY\"\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDHDR\".\"UDATE\" IS NOT NULL\n  AND \"CDPOS\".\"OBJECTCLAS\" = 'EINKBELEG'\n  AND \"CDPOS\".\"TABNAME\" = 'EKET'\n  AND \"CDPOS\".\"FNAME\" IN ('EINDT')\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL\n  AND \"EKET\".\"MANDT\" IS NOT NULL\n"
                    },
                    {
                        "id": "CDPOS (1)",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT <%=sourceSystem%>  || 'PurchaseOrderScheduleLine_' || \"CDPOS\".\"TABKEY\"                   AS \"ObjectID\",\n\t<%=sourceSystem%>  || \"CDPOS\".\"TABKEY\" || \"CDPOS\".\"FNAME\"\n       || \"CDPOS\".\"TABKEY\" || \"CDPOS\".\"TABNAME\" || \"CDPOS\".\"FNAME\"\n       || \"CDPOS\".\"CHANGENR\" || \"CDPOS\".\"CHNGIND\"                                               AS \"ID\",\n       CAST(\"CDHDR\".\"UDATE\" AS DATE) + COALESCE(CAST(\"CDHDR\".\"UTIME\" AS TIME), TIME '23:59:59') AS \"Time\",\n       CASE\n           WHEN \"CDPOS\".\"CHNGIND\" = 'I' THEN 'CreationTime'\n           WHEN \"CDPOS\".\"CHNGIND\" = 'D' THEN 'DeletionTime'\n           END                                                                                  AS \"Attribute\",\n       NULL                                                                                     AS \"OldValue\",\n       NULL                                                                                     AS \"NewValue\",\n       'User_' || \"CDHDR\".\"MANDANT\" || \"CDHDR\".\"USERNAME\"                                       AS \"ChangedBy\",\n       \"CDHDR\".\"TCODE\"                                                                          AS \"OperationType\",\n       \"CDHDR\".\"CHANGENR\"                                                                       AS \"OperationID\",\n       CASE\n           WHEN \"USR02\".\"USTYP\" IN ('B', 'C') THEN 'Automatic'\n           ELSE 'Manual' END                                                                    AS \"ExecutionType\"\nFROM \"CDPOS\" AS \"CDPOS\"\n         LEFT JOIN \"CDHDR\" AS \"CDHDR\"\n                   ON \"CDPOS\".\"MANDANT\" = \"CDHDR\".\"MANDANT\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = \"CDHDR\".\"OBJECTCLAS\"\n                       AND \"CDPOS\".\"OBJECTID\" = \"CDHDR\".\"OBJECTID\"\n                       AND \"CDPOS\".\"CHANGENR\" = \"CDHDR\".\"CHANGENR\"\n                       AND \"CDPOS\".\"OBJECTCLAS\" = 'EINKBELEG'\n         LEFT JOIN \"USR02\" AS \"USR02\"\n                   ON \"CDHDR\".\"USERNAME\" = \"USR02\".\"BNAME\"\n                       AND \"CDHDR\".\"MANDANT\" = \"USR02\".\"MANDT\"\nWHERE \"CDPOS\".\"TABNAME\" = 'EKET'\n  AND \"CDPOS\".\"FNAME\" = 'KEY'\n  AND \"CDPOS\".\"MANDANT\" IS NOT NULL\n  AND \"CDHDR\".\"MANDANT\" IS NOT NULL\n"
                    }
                ],
                "foreign_key_names": [
                    "PurchaseOrderItem"
                ],
                "namespace": "celonis",
                "property_names": [
                    "CreationTime",
                    "DatabasePurchaseOrderItemNumber",
                    "DatabasePurchaseOrderNumber",
                    "DatabasePurchaseOrderScheduleLineNumber",
                    "GoodsReceivedQuantity",
                    "ID",
                    "ItemDeliveryDate",
                    "QuantityUnit",
                    "ScheduledQuantity",
                    "SourceSystemInstance",
                    "SourceSystemType",
                    "SystemPurchaseOrderItemNumber",
                    "SystemPurchaseOrderNumber",
                    "SystemPurchaseOrderScheduleLineNumber"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "EKET",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": false,
                        "overwrite": null,
                        "sql": "SELECT <%=sourceSystem%>  || 'PurchaseOrderScheduleLine_' || \"EKET\".\"MANDT\" || \"EKET\".\"EBELN\" || \"EKET\".\"EBELP\" || \"EKET\".\"ETENR\" AS \"ID\",\n    NULL                                                                                                                          AS \"CreationTime\",\n\t<%=sourceSystem%>  || 'PurchaseOrderItem_' || \"EKET\".\"MANDT\" || \"EKET\".\"EBELN\"\n    || \"EKET\".\"EBELP\"                                                                                                             AS \"PurchaseOrderItem\",\n    CAST(\"EKET\".\"EINDT\" AS TIMESTAMP)                                                                                             AS \"ItemDeliveryDate\",\n    \"EKET\".\"WEMNG\"                                                                                                                AS \"GoodsReceivedQuantity\",\n    \"EKET\".\"MENGE\"                                                                                                                AS \"ScheduledQuantity\",\n    \"EKPO\".\"MEINS\"                                                                                                                AS \"QuantityUnit\",\n    'SAP'                                                                                                                         AS \"SourceSystemType\",\n    \"EKET\".\"MANDT\"                                                                                                                AS \"SourceSystemInstance\",\n    \"EKET\".\"EBELN\"                                                                                                                AS \"SystemPurchaseOrderNumber\",\n    \"EKET\".\"EBELP\"                                                                                                                AS \"SystemPurchaseOrderItemNumber\",\n    \"EKET\".\"ETENR\"                                                                                                                AS \"SystemPurchaseOrderScheduleLineNumber\",\n    \"EKET\".\"EBELN\"                                                                                                                AS \"DatabasePurchaseOrderNumber\",\n    \"EKET\".\"EBELP\"                                                                                                                AS \"DatabasePurchaseOrderItemNumber\",\n    \"EKET\".\"ETENR\"                                                                                                                AS \"DatabasePurchaseOrderScheduleLineNumber\"\nFROM \"EKET\" AS \"EKET\"\n         LEFT JOIN \"EKPO\" AS \"EKPO\"\n                   ON \"EKET\".\"MANDT\" = \"EKPO\".\"MANDT\"\n                       AND \"EKET\".\"EBELN\" = \"EKPO\".\"EBELN\"\n                       AND \"EKET\".\"EBELP\" = \"EKPO\".\"EBELP\"\nWHERE \"EKET\".\"MANDT\" IS NOT NULL\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]