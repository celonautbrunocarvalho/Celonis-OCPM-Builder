[
    {
        "change_date": 1770400802177.0,
        "changed_by": {
            "id": "cccccccc-cccc-cccc-cccc-cccccccccccc",
            "name": "Celonis",
            "type_": "APPLICATION"
        },
        "created_by": {
            "id": "cccccccc-cccc-cccc-cccc-cccccccccccc",
            "name": "Celonis",
            "type_": "APPLICATION"
        },
        "creation_date": 1770400802177.0,
        "data_connection_id": "b3c59e17-798d-49ea-b0b3-99d0bae2e011",
        "description": null,
        "disabled": null,
        "display_name": "StockHistory",
        "draft": null,
        "factory_id": "aef0f5c1-3b9a-4f98-b316-b289f204b55e_b3c59e17-798d-49ea-b0b3-99d0bae2e011",
        "factory_validation_status": "NOT_VALIDATED",
        "has_user_template": null,
        "local_parameters": [
            {
                "name": "sourceSystem",
                "value": "''"
            },
            {
                "name": "stockHistoryYears",
                "value": "2"
            }
        ],
        "namespace": "celonis",
        "target": {
            "entity_ref": {
                "name": "StockHistory",
                "namespace": "celonis"
            },
            "kind": "OBJECT"
        },
        "transformations": [
            {
                "change_sql_factory_datasets": [],
                "foreign_key_names": [
                    "Material",
                    "MaterialMasterPlant",
                    "Plant"
                ],
                "namespace": "celonis",
                "property_names": [
                    "AddedPeriod",
                    "BaseCurrency",
                    "BaseTotalValuatedStockAmount",
                    "BaseTotalValuatedStockQuantity",
                    "ConsumptionQuantity",
                    "CurrentPeriod",
                    "ID",
                    "QuantityUnit",
                    "ReplenishmentQuantity",
                    "SourceSystemInstance",
                    "SourceSystemType",
                    "UnitPrice"
                ],
                "property_sql_factory_datasets": [
                    {
                        "id": "CTE_Calendar_Merge",
                        "type_": "SQL_FACTORY_DATA_SET",
                        "complete_overwrite": false,
                        "disabled": false,
                        "materialise_cte": true,
                        "overwrite": null,
                        "sql": "WITH \"CTE_Reduce_Calendar\" AS (SELECT \"CELONIS_CALENDAR\".\"LastDayOfMonth\",\n                                     \"CELONIS_CALENDAR\".\"Year\",\n                                     LPAD(CAST(\"CELONIS_CALENDAR\".\"Month\" AS VARCHAR(2)), 2, '0') AS \"Month\"\n                              FROM \"CELONIS_CALENDAR\"\n                              GROUP BY \"LastDayOfMonth\", \"Year\", \"Month\"),\n    \"CTE_Date_Range_MBEWH\" AS (SELECT \"MBEWH\".\"MANDT\"                                       AS \"MANDT\",\n                                      \"MBEWH\".\"MATNR\"                                       AS \"MATNR\",\n                                      \"MBEWH\".\"BWKEY\"                                       AS \"BWKEY\",\n                                      CAST(MIN(\"Reduce_Calendar\".\"LastDayOfMonth\") AS DATE) AS \"MinDate\"\n                               FROM \"MBEWH\" AS \"MBEWH\"\n                                        LEFT JOIN \"CTE_Reduce_Calendar\" AS \"Reduce_Calendar\"\n                                                  ON \"MBEWH\".\"LFGJA\" = \"Reduce_Calendar\".\"YEAR\"\n                                                      AND \"MBEWH\".\"LFMON\" = \"Reduce_Calendar\".\"Month\"\n                               WHERE \"MBEWH\".\"BWTAR\" IS NULL\n                               GROUP BY \"MBEWH\".\"MANDT\", \"MBEWH\".\"MATNR\", \"MBEWH\".\"BWKEY\"),\n    \"CTE_Calendar\" AS (SELECT \"Date_Range_MBEWH\".\"MANDT\"                            AS \"MANDT\",\n                              \"Date_Range_MBEWH\".\"MATNR\"                            AS \"MATNR\",\n                              \"Date_Range_MBEWH\".\"BWKEY\"                            AS \"BWKEY\",\n                              CAST(\"Reduce_Calendar\".\"LastDayOfMonth\" AS TIMESTAMP) AS \"DateRange\",\n                              \"Reduce_Calendar\".\"Year\"                              AS \"Year\",\n                              \"Reduce_Calendar\".\"Month\"                             AS \"Month\"\n                       FROM \"CTE_Date_Range_MBEWH\" AS \"Date_Range_MBEWH\"\n                                LEFT JOIN \"CTE_Reduce_Calendar\" AS \"Reduce_Calendar\"\n                                          ON \"Date_Range_MBEWH\".\"MinDate\"\n                                             <= CAST(\"Reduce_Calendar\".\"LastDayOfMonth\" AS DATE)\n                                              AND CAST(\"Reduce_Calendar\".\"LastDayOfMonth\" AS DATE) <= CAST(\n                                                      TIMESTAMPADD(DAY, -1, TIMESTAMPADD(MONTH, 1,\n                                                                                         CAST(CAST(YEAR(NOW()) AS VARCHAR)\n                                                                                              || '-'\n                                                                                              || CAST(MONTH(NOW()) AS VARCHAR)\n                                                                                              || '-01' AS DATE))) AS DATE)),\n    \"CTE_QuanitityConversion\" AS (SELECT \"MARA\".\"MANDT\",\n                                         \"MARA\".\"MATNR\",\n                                         \"MARA\".\"MEINS\" AS \"FromUnit\",\n                                         CASE\n                                             WHEN \"T006\".\"DIMID\" != 'AAAADL'\n                                                 THEN \"T006D\".\"MSSIE\"\n                                             WHEN \"T006\".\"DIMID\" = 'AAAADL'\n                                                 THEN \"MARM\".\"MEINH\"\n                                             END        AS \"ToUnit\",\n                                         CASE\n                                             WHEN \"T006\".\"DIMID\" != 'AAAADL'\n                                                 THEN \"T006\".\"ZAEHL\" / \"T006\".\"NENNR\" * POWER(10, \"T006\".\"EXP10\")\n                                             WHEN \"T006\".\"DIMID\" = 'AAAADL'\n                                                 THEN \"MARM\".\"UMREN\" / \"MARM\".\"UMREZ\"\n                                             END        AS \"Rate\"\n                                  FROM \"MARA\" AS \"MARA\"\n                                           LEFT JOIN \"T006\" AS \"T006\"\n                                                     ON \"MARA\".\"MANDT\" = \"T006\".\"MANDT\"\n                                                         AND \"MARA\".\"MEINS\" = \"T006\".\"MSEHI\"\n                                           LEFT JOIN \"T006D\" AS \"T006D\"\n                                                     ON \"T006\".\"MANDT\" = \"T006D\".\"MANDT\"\n                                                         AND \"T006\".\"DIMID\" = \"T006D\".\"DIMID\"\n                                           LEFT JOIN \"MARM\" AS \"MARM\"\n                                                     ON \"MARA\".\"MANDT\" = \"MARM\".\"MANDT\"\n                                                         AND \"MARA\".\"MATNR\" = \"MARM\".\"MATNR\"\n                                  WHERE \"T006\".\"MANDT\" IS NOT NULL\n                                    AND \"MARM\".\"MANDT\" IS NOT NULL),\n    \"CTE_TEMP_AGG\" AS (SELECT \"MSEG\".\"MANDT\",\n                              \"MSEG\".\"MATNR\",\n                              \"MSEG\".\"WERKS\",\n                              COALESCE(\"MSEG\".\"MEINS\", \"MARA\".\"MEINS\")                               AS \"MEINS\",\n                              \"MSEG\".\"WAERS\"                                                         AS \"WAERS\",\n                              CAST(TIMESTAMPADD(DAY, -1, TIMESTAMPADD(MONTH, 1,\n                                                                      CAST(YEAR(CAST(\"MSEG\".\"CPUDT_MKPF\" AS DATE))\n                                                                           || '-'\n                                                                          || MONTH(CAST(\"MSEG\".\"CPUDT_MKPF\" AS DATE))\n                                                                          ||\n                                                                           '-01' AS DATE))) AS DATE) AS \"MSEG_EndOfMonth\",\n                              CASE\n                                  WHEN \"MSEG\".\"SHKZG\" = 'H' AND \"T156\".\"SHKZG\" IS NOT NULL AND \"T156\".\"XSTBW\" IS NULL\n                                      THEN SUM(\"MSEG\".\"MENGE\")\n                                  WHEN \"MSEG\".\"SHKZG\" = 'S' AND \"T156\".\"SHKZG\" IS NOT NULL AND \"T156\".\"XSTBW\" = 'X'\n                                      THEN SUM(\"MSEG\".\"MENGE\") * -1.0\n                                  END                                                                AS \"Consupmtion_MENGE\",\n                              CASE\n                                  WHEN \"MSEG\".\"SHKZG\" = 'S' AND \"T156\".\"SHKZG\" IS NOT NULL AND \"T156\".\"XSTBW\" IS NULL\n                                      THEN SUM(\"MSEG\".\"MENGE\")\n                                  WHEN \"MSEG\".\"SHKZG\" = 'H' AND \"T156\".\"SHKZG\" IS NOT NULL AND \"T156\".\"XSTBW\" = 'X'\n                                      THEN SUM(\"MSEG\".\"MENGE\") * -1.0\n                                  END                                                                AS \"Replenishment_MENGE\"\n                       FROM \"MSEG\" AS \"MSEG\"\n                                LEFT JOIN \"T156\" AS \"T156\"\n                                          ON \"MSEG\".\"MANDT\" = \"T156\".\"MANDT\"\n                                              AND \"MSEG\".\"BWART\" = \"T156\".\"BWART\"\n                                              AND \"T156\".\"KZVBU\" IS NOT NULL\n                                LEFT JOIN \"MARA\" AS \"MARA\"\n                                          ON \"MSEG\".\"MANDT\" = \"MARA\".\"MANDT\"\n                                              AND \"MSEG\".\"MATNR\" = \"MARA\".\"MATNR\"\n                       WHERE \"MSEG\".\"BWTAR\" IS NULL\n                       GROUP BY \"MSEG\".\"MANDT\", \"MSEG\".\"MATNR\", \"MSEG\".\"WERKS\", \"MSEG\".\"SHKZG\",\n                                COALESCE(\"MSEG\".\"MEINS\", \"MARA\".\"MEINS\"), \"MSEG\".\"WAERS\",\n                                CAST(TIMESTAMPADD(DAY, -1, TIMESTAMPADD(MONTH, 1,\n                                                                        CAST(YEAR(CAST(\"MSEG\".\"CPUDT_MKPF\" AS DATE))\n                                                                             || '-'\n                                                                            || MONTH(CAST(\"MSEG\".\"CPUDT_MKPF\" AS DATE))\n                                                                            || '-01' AS DATE))) AS DATE),\n                                \"T156\".\"SHKZG\", \"T156\".\"XSTBW\"),\n    \"CTE_TEMP_AGG_Converting\" AS (SELECT \"CTE_TEMP_AGG\".\"MANDT\",\n                                         \"CTE_TEMP_AGG\".\"MATNR\",\n                                         \"CTE_TEMP_AGG\".\"WERKS\",\n                                         \"MARA\".\"MEINS\",\n                                         \"CTE_TEMP_AGG\".\"WAERS\",\n                                         \"CTE_TEMP_AGG\".\"MSEG_EndOfMonth\",\n                                         \"CTE_TEMP_AGG\".\"Consupmtion_MENGE\"\n                                             * COALESCE(\"CTE_QuanitityConversion\".\"Rate\", 1.0) AS \"Consupmtion_MENGE\",\n                                         \"CTE_TEMP_AGG\".\"Replenishment_MENGE\"\n                                             * COALESCE(\"CTE_QuanitityConversion\".\"Rate\", 1.0) AS \"Replenishment_MENGE\"\n                                  FROM \"CTE_TEMP_AGG\"\n                                           LEFT JOIN \"MARA\"\n                                                     ON \"CTE_TEMP_AGG\".\"MANDT\" = \"MARA\".\"MANDT\"\n                                                         AND \"CTE_TEMP_AGG\".\"MATNR\" = \"MARA\".\"MATNR\"\n                                           LEFT JOIN \"CTE_QuanitityConversion\"\n                                                     ON \"CTE_TEMP_AGG\".\"MANDT\" = \"CTE_QuanitityConversion\".\"MANDT\"\n                                                         AND \"CTE_TEMP_AGG\".\"MATNR\" = \"CTE_QuanitityConversion\".\"MATNR\"\n                                                         AND \"MARA\".\"MEINS\" = \"CTE_QuanitityConversion\".\"ToUnit\"),\n    \"CTE_MSEG_AGG\" AS (SELECT \"TEMP_AGG\".\"MANDT\",\n                              \"TEMP_AGG\".\"MATNR\",\n                              \"TEMP_AGG\".\"WERKS\",\n                              \"TEMP_AGG\".\"MEINS\",\n                              \"TEMP_AGG\".\"WAERS\",\n                              \"TEMP_AGG\".\"MSEG_EndOfMonth\",\n                              SUM(\"TEMP_AGG\".\"Consupmtion_MENGE\")   AS \"Consupmtion_MENGE\",\n                              SUM(\"TEMP_AGG\".\"Replenishment_MENGE\") AS \"Replenishment_MENGE\"\n                       FROM \"CTE_TEMP_AGG_Converting\" AS \"TEMP_AGG\"\n                       GROUP BY \"TEMP_AGG\".\"MANDT\", \"TEMP_AGG\".\"MATNR\", \"TEMP_AGG\".\"WERKS\",\n                                \"TEMP_AGG\".\"MEINS\", \"TEMP_AGG\".\"WAERS\", \"TEMP_AGG\".\"MSEG_EndOfMonth\"),\n    \"CTE_MBEW_AGG\" AS (SELECT \"MBEWH\".\"MANDT\",\n                              \"MBEWH\".\"MATNR\",\n                              \"MBEWH\".\"BWKEY\",\n                              \"MBEWH\".\"LFGJA\",\n                              \"MBEWH\".\"LFMON\",\n                              \"MBEWH\".\"LBKUM\",\n                              \"MBEWH\".\"SALK3\",\n                              \"MBEWH\".\"VERPR\",\n                              \"MBEWH\".\"STPRS\",\n                              \"MBEWH\".\"PEINH\",\n                              \"MBEWH\".\"VPRSV\"\n                       FROM \"MBEWH\" AS \"MBEWH\"\n                       WHERE \"MBEWH\".\"BWTAR\" IS NULL\n                       UNION ALL\n                       SELECT \"MBEW\".\"MANDT\",\n                              \"MBEW\".\"MATNR\",\n                              \"MBEW\".\"BWKEY\",\n                              \"MBEW\".\"LFGJA\",\n                              \"MBEW\".\"LFMON\",\n                              \"MBEW\".\"LBKUM\",\n                              \"MBEW\".\"SALK3\",\n                              \"MBEW\".\"VERPR\",\n                              \"MBEW\".\"STPRS\",\n                              \"MBEW\".\"PEINH\",\n                              \"MBEW\".\"VPRSV\"\n                       FROM \"MBEW\" AS \"MBEW\"\n                       WHERE \"MBEW\".\"BWTAR\" IS NULL),\n    \"CTE_Calendar_Merge_Temp\"\n        AS (SELECT \"Calendar\".\"MANDT\" || \"Calendar\".\"MATNR\" || \"Calendar\".\"BWKEY\"\n                       || \"Calendar\".\"Year\" || \"Calendar\".\"Month\" AS \"StockHistoryID\",\n                   \"Calendar\".\"DateRange\"                         AS \"CurrentPeriod\",\n                   CASE\n                       WHEN \"MBEW_AGG\".\"MATNR\" IS NULL THEN 'X'\n                       END                                        AS \"AddedPeriod\",\n                   \"MBEW_AGG\".\"MATNR\"                             AS \"MaterialNumber\",\n                   \"MBEW_AGG\".\"LBKUM\"                             AS \"BaseTotalValuatedStockQuantity\",\n                   \"MBEW_AGG\".\"SALK3\"                             AS \"BaseTotalValuatedStockAmount\",\n                   CASE\n                       WHEN \"MBEW_AGG\".\"VPRSV\" = 'V' THEN COALESCE(\n                               \"MBEW_AGG\".\"VERPR\" / NULLIF(\"MBEW_AGG\".\"PEINH\", 0),\n                               \"MBEW_AGG\".\"VERPR\")\n                       WHEN \"MBEW_AGG\".\"VPRSV\" = 'S' THEN COALESCE(\n                               \"MBEW_AGG\".\"STPRS\" / NULLIF(\"MBEW_AGG\".\"PEINH\", 0),\n                               \"MBEW_AGG\".\"STPRS\")\n                       ELSE \"MBEW_AGG\".\"SALK3\" / NULLIF(\"MBEW_AGG\".\"LBKUM\", 0)\n                       END                                        AS \"UnitPrice\",\n                   \"T001\".\"WAERS\"                                 AS \"BaseCurrency\",\n                   \"MSEG_AGG\".\"MEINS\"                             AS \"QuantityUnit\",\n                   \"MSEG_AGG\".\"Consupmtion_MENGE\"                 AS \"ConsumptionQuantity\",\n                   \"MSEG_AGG\".\"Replenishment_MENGE\"               AS \"ReplenishmentQuantity\",\n                   \"Calendar\".\"MANDT\" || \"Calendar\".\"BWKEY\"       AS \"Plant_ID\",\n                   \"Calendar\".\"MANDT\" || \"Calendar\".\"MATNR\"       AS \"Material_ID\",\n                   \"Calendar\".\"MANDT\" || \"Calendar\".\"MATNR\"\n                       || \"Calendar\".\"BWKEY\"                      AS \"MaterialMasterPlant_ID\",\n                   \"Calendar\".\"MANDT\"                             AS \"Client\"\n            FROM \"CTE_Calendar\" AS \"Calendar\"\n                     LEFT JOIN \"CTE_MBEW_AGG\" AS \"MBEW_AGG\"\n                               ON \"Calendar\".\"MANDT\" = \"MBEW_AGG\".\"MANDT\"\n                                   AND \"Calendar\".\"MATNR\" = \"MBEW_AGG\".\"MATNR\"\n                                   AND \"Calendar\".\"BWKEY\" = \"MBEW_AGG\".\"BWKEY\"\n                                   AND \"Calendar\".\"Year\" = \"MBEW_AGG\".\"LFGJA\"\n                                   AND \"Calendar\".\"Month\" = \"MBEW_AGG\".\"LFMON\"\n                     LEFT JOIN \"T001K\" AS \"T001K\"\n                               ON \"MBEW_AGG\".\"MANDT\" = \"T001K\".\"MANDT\"\n                                   AND \"MBEW_AGG\".\"BWKEY\" = \"T001K\".\"BWKEY\"\n                     LEFT JOIN \"T001\" AS \"T001\"\n                               ON \"T001K\".\"MANDT\" = \"T001\".\"MANDT\"\n                                   AND \"T001K\".\"BUKRS\" = \"T001\".\"BUKRS\"\n                     LEFT JOIN \"CTE_MSEG_AGG\" AS \"MSEG_AGG\"\n                               ON \"Calendar\".\"MANDT\" = \"MSEG_AGG\".\"MANDT\"\n                                   AND \"Calendar\".\"MATNR\" = \"MSEG_AGG\".\"MATNR\"\n                                   AND \"Calendar\".\"BWKEY\" = \"MSEG_AGG\".\"WERKS\"\n                                   AND \"Calendar\".\"DateRange\" = \"MSEG_AGG\".\"MSEG_EndOfMonth\"),\n    \"CTE_Calendar_Merge\" AS (SELECT \"Calendar_Merge\".\"StockHistoryID\"                     AS \"ID\",\n                                    \"Calendar_Merge\".\"CurrentPeriod\"                      AS \"CurrentPeriod\",\n                                    \"Calendar_Merge\".\"AddedPeriod\"                        AS \"AddedPeriod\",\n                                    COALESCE(CAST(\"BaseTotalValuatedStockQuantity\" AS FLOAT),\n                                             CAST(LAST_VALUE(\"BaseTotalValuatedStockQuantity\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS FLOAT),\n                                             CAST(FIRST_VALUE(\"BaseTotalValuatedStockQuantity\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS FLOAT)\n                                    )                                                     AS \"BaseTotalValuatedStockQuantity\",\n                                    COALESCE(CAST(\"BaseTotalValuatedStockAmount\" AS FLOAT),\n                                             CAST(LAST_VALUE(\"BaseTotalValuatedStockAmount\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS FLOAT),\n                                             CAST(FIRST_VALUE(\"BaseTotalValuatedStockAmount\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS FLOAT)\n                                    )                                                     AS \"BaseTotalValuatedStockAmount\",\n                                    COALESCE(CAST(\"UnitPrice\" AS FLOAT),\n                                             CAST(LAST_VALUE(\"UnitPrice\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS FLOAT),\n                                             CAST(FIRST_VALUE(\"UnitPrice\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS FLOAT)\n                                    )                                                     AS \"UnitPrice\",\n                                    COALESCE(\"BaseCurrency\",\n                                             CAST(LAST_VALUE(\"BaseCurrency\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS VARCHAR(255)),\n                                             CAST(FIRST_VALUE(\"BaseCurrency\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS VARCHAR(255))\n                                    )                                                     AS \"BaseCurrency\",\n                                    COALESCE(\"QuantityUnit\",\n                                             CAST(LAST_VALUE(\"QuantityUnit\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS VARCHAR(255)),\n                                             CAST(FIRST_VALUE(\"QuantityUnit\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS VARCHAR(255))\n                                    )                                                     AS \"QuantityUnit\",\n                                    COALESCE(\"Calendar_Merge\".\"ConsumptionQuantity\", 0)   AS \"ConsumptionQuantity\",\n                                    COALESCE(\"Calendar_Merge\".\"ReplenishmentQuantity\", 0) AS \"ReplenishmentQuantity\",\n                                    \"Calendar_Merge\".\"Plant_ID\"                           AS \"Plant_ID\",\n                                    \"Calendar_Merge\".\"Material_ID\"                        AS \"Material_ID\",\n                                    COALESCE(\"MaterialMasterPlant_ID\",\n                                             CAST(LAST_VALUE(\"MaterialMasterPlant_ID\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS VARCHAR(255)),\n                                             CAST(FIRST_VALUE(\"MaterialMasterPlant_ID\") IGNORE NULLS\n                                                  OVER (PARTITION BY \"MaterialMasterPlant_ID\" ORDER BY \"CurrentPeriod\" DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS VARCHAR(255))\n                                    )                                                     AS \"MaterialMasterPlant_ID\",\n                                    'SAP'                                                 AS \"SourceSystemType\",\n                                    \"Calendar_Merge\".\"Client\"                             AS \"SourceSystemInstance\"\n                             FROM \"CTE_Calendar_Merge_Temp\" AS \"Calendar_Merge\")\nSELECT <%=sourceSystem%>  || 'StockHistory_' || \"Calendar_Merge\".\"ID\"                      AS \"ID\",\n       \"Calendar_Merge\".\"CurrentPeriod\"                                                    AS \"CurrentPeriod\",\n       \"Calendar_Merge\".\"AddedPeriod\"                                                      AS \"AddedPeriod\",\n       \"Calendar_Merge\".\"BaseTotalValuatedStockQuantity\"                                   AS \"BaseTotalValuatedStockQuantity\",\n       \"Calendar_Merge\".\"BaseTotalValuatedStockAmount\"                                     AS \"BaseTotalValuatedStockAmount\",\n       \"Calendar_Merge\".\"UnitPrice\"                                                        AS \"UnitPrice\",\n       \"Calendar_Merge\".\"BaseCurrency\"                                                     AS \"BaseCurrency\",\n       \"Calendar_Merge\".\"QuantityUnit\"                                                     AS \"QuantityUnit\",\n       \"Calendar_Merge\".\"ConsumptionQuantity\"                                              AS \"ConsumptionQuantity\",\n       \"Calendar_Merge\".\"ReplenishmentQuantity\"                                            AS \"ReplenishmentQuantity\",\n\t<%=sourceSystem%>  || 'Plant_' || \"Calendar_Merge\".\"Plant_ID\"                             AS \"Plant\",\n\t<%=sourceSystem%>  || 'Material_' || \"Calendar_Merge\".\"Material_ID\"                       AS \"Material\",\n\t<%=sourceSystem%>  || 'MaterialMasterPlant_' || \"Calendar_Merge\".\"MaterialMasterPlant_ID\" AS \"MaterialMasterPlant\",\n       \"Calendar_Merge\".\"SourceSystemType\"                                                 AS \"SourceSystemType\",\n       \"Calendar_Merge\".\"SourceSystemInstance\"                                             AS \"SourceSystemInstance\"\nFROM \"CTE_Calendar_Merge\" AS \"Calendar_Merge\"\nWHERE \"CurrentPeriod\" >= TIMESTAMPADD(MONTH, (-12 * <%=stockHistoryYears%>  - 1), NOW())\n"
                    }
                ],
                "relationship_transformations": []
            }
        ]
    }
]